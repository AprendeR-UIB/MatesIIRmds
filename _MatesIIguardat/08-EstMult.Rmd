# Introducció  a l'estadística multidimensional

En general, les dades que es recullen en experiments són multidimensionals: mesuram diverses variables aleatòries sobre una mateixa mostra d'individus, i organitzam aquesta informació en taules de dades on les fileres representen els individus observats i cada columna correspon a una variable diferent. És a dir, el que fem és avaluar un vector de variables aleatòries (en direm un **vector aleatori**) sobre els individus d'una població. En aquesta lliçó introduïm alguns conceptes nous sobre vectors de variables aleatòries i les seves realitzacions.

## Poblacions: vectors aleatoris

Un **vector aleatori de dimensió $p$** és un vector format per $p$ variables aleatòries 
$$
\underline{X}=(X_1,X_2,\ldots,X_p).
$$
Com en el cas de les variables aleatòries unidimensionals, és important distingir entre un vectors aleatori i les **realitzacions** o  les **mostres** d'aquest vector, que corresponen a mesurar les variables del vector sobre un individu de la població o sobre un conjunt d'individus.

```{example}
Si diem $X_1$ a la variable aleatòria que dóna l'edat d'un individu (en anys), $X_2$ a la que dóna la seva alçada (arrodonida a cm) i $X_3$ a la que dóna el seu pes (arrodonida a kg amb una xifra decimal), llavors
$$
\underline{X}=(X_1,X_2,X_3)
$$
és un vector aleatori de dimensió 3. Cada cop que prenem un individu i n'anotam l'edat, l'alçada i el pes i organitzam aquestes mesures en aquest ordre en un vector, obtenim una **realització** de $\underline{X}$. 
Llavors,una **mostra** de $X$ serà un conjunt de vectors amb l'edat, l'alçada i el pes d'un grup d'individus de la població. Usualment, organitzarem una mostra de $X$ per mitjà d'una taula de dades amb fileres aquests vectors.
```

Sigui ara $\underline{X}=(X_1,X_2,\ldots,X_p)$ un vector aleatori i, per a cada $i=1,\ldots,p$, siguin $\mu_i$ i $\sigma_i$ la mitjana i la desviació típica, respectivament, de la seva component $X_i$. Aleshores:

* El **valor esperat**, o **vector de mitjanes**,  de  $\underline{X}$ és el vector format pels valors esperats, o mitjanes, de les seves components:
$$
E(\underline{X})=(E(X_1),\ldots,E(X_p))=(\mu_1,\ldots,\mu_p).
$$
Per  abreviar, de vegades indicarem aquest vector simplement amb $\boldsymbol\mu$.

* El **vector de variàncies**  de  $\underline{X}$ és el vector format per les variàncies de les seves components:
$$
Var(\underline{X})=(Var(X_1),\ldots,Var(X_p))=(\sigma_1^2,\ldots,\sigma_p^2).
$$

* El **vector de desviacions típiques**  de  $\underline{X}$ és el vector format per les desviacions típiques de les seves components:
$$
\sigma(\underline{X})=(\sigma(X_1),\ldots,\sigma(X_p))=(\sigma_1,\ldots,\sigma_p).
$$


### Covariància

Donades dues variables aleatòries $X_1$ i $X_2$ de mitjanes $\mu_1$ i $\mu_2$, respectivament, la seva **covariància** és 
$$
Cov(X_1,X_2)=E((X_1-\mu_1)\cdot ( X_2-\mu_2)).
$$
És fàcil comprovar que la covariància també es pot calcular mitjançant la identitat
$$
Cov(X_1,X_2)=E(X_1\cdot X_2) -\mu_1\cdot \mu_2.
$$

```{block2,type="rmdcorbes"}
En efecte,
$$
\begin{array}{rl}
Cov(X_1,X_2) & =E((X_1-\mu_1) ( X_2-\mu_2))=
E(X_1X_2-\mu_1X_2-\mu_2X_1+\mu_1\mu_2)\\ &
=E(X_1X_2)-\mu_1E(X_2)-\mu_2E(X_1)+\mu_1\mu_2\\ &=
E(X_1X_2)-\mu_1\mu_2-\mu_2\mu_1+\mu_1\mu_2
=E(X_1X_2)-\mu_1\mu_2
\end{array}
$$
```

La covariància de  $X_1$ i $X_2$ pot prendre qualsevol valor real, i mesura el grau de variació conjunta de les variables. Si valors grans d'una variable corresponen a valors grans de l'altra, la seva covariància és positiva. En el cas oposat, si valors grans d'una variable corresponen a valors petits de l'altra, la seva covariància és negativa. Per tant, el signe de la covariància  reflexa la tendència de la relació entre les variables. Emperò, la seva magnitud en valor absolut no té una interpretació senzilla. 

```{block2, type="rmdimportant"}
Si $X_1$ i $X_2$ són variables independents, la seva covariància es 0, perquè en aquest cas $E(X_1\cdot X_2) =\mu_1\mu_2$. El recíproc és fals: dues variables aleatòries poden tener covariància 0 i no ser independents.
```

```{example,nocorr} 
Suposem que tenim un dau tetraèdric no trucat amb les cares marcades amb els valors -2, -1, 1 i 2. Siguin $X$ la variable aleatòria que consisteix a llançar el dau i anotar el resultat, i $Y$ la variable aleatòria que consisteix a llançar el dau i anotar el *quadrat* del resultat obtingut. Com les quatre cares del dau són equiprobables, 
$$
\begin{array}{l}
\displaystyle P(X=-2)=P(X=-1)=P(X=1)=P(X=2)=\frac{1}{4}\\
\displaystyle P(Y=1)=P(Y=4)=\frac{1}{2}
\end{array}
$$
  
  
```
Com que $Y$ és funció de $X$, ja que $I=X^2$, costa creure que $X$ i $Y$ vagin a ser independents. Vegem que, en efecte, no ho són. Observau que  els únics possibles valors per al vector $(X,Y)$ en una tirada del dau són (-2,4), (-1,1), (1,1) i (2,4), cadascun amb probabilitat 1/4. Llavors, per exemple, la probabilitat d'obtenir en una tirada $X=-1$ i $Y=4$ és 0, perquè és impossible, mentre que
$$
P(X=-1)\cdot P(Y=4)=\frac{1}{4}\cdot\frac{1}{2}=\frac{1}{8}\neq 0.
$$

Vegem ara que la covariància de $X$ i $Y$ es 0. Per calcular-la, primer necessitam conéixer els valors esperats de les variables:
$$
\begin{array}{l}
\displaystyle E(X)=(-2)\cdot \frac{1}{4}+(-1)\cdot \frac{1}{4}+1\cdot \frac{1}{4}+2\cdot \frac{1}{4}=0\\
\displaystyle E(Y)=1\cdot \frac{1}{2}+4\cdot \frac{1}{2}=2.5
\end{array}
$$
Per tant
$$
\begin{array}{l}
Cov(X,Y)=E\big(X\cdot Y\big)-E(X)\cdot E(Y)=E\big(X\cdot Y\big)-0\cdot 2.5=E\big(X\cdot Y\big)\\
\qquad =P\big(X=-2,Y=4\big)\cdot (-2\cdot 4)+P\big(X=-1,Y=1\big)\cdot (-1\cdot 1)\\\qquad\qquad\qquad+P\big(X=1,Y=1\big)\cdot (1\cdot 1)+P\big(X=2,Y=4\big)\cdot (2\cdot 4)\\
\qquad =\displaystyle \frac{1}{4}\cdot (-8)+\frac{1}{4}\cdot (-1)+\frac{1}{4}\cdot 1+\frac{1}{4}\cdot 8=0.
\end{array}
$$
Així doncs, $X$ i $Y$ són variables dependents, però la seva covariància és 0. 

La covariància és simètrica, $Cov(X_1,X_2)=Cov(X_2,X_1)$, i la covariància d'una variable aleatòria amb ella mateixa és la seva variància: 
$$
Cov(X,X)=E((X-\mu)^2)=Var(X).
$$
Per simplificar la notació, se sol utilitzar $\sigma_{ij}$ per indicar la covariància de dues variables aleatòries $X_i$ i $X_j$ que formin part d'un vector aleatori. És a dir, escriurem
$$
\sigma_{i j}=Cov(X_i,X_j)\text{ i }
\sigma_{ii}=Cov(X_i,X_i)=\sigma_i^2.
$$

Com al cas unidimensional, un vector aleatori $\underline{X}=(X_1,\ldots,X_p)$
admet una mesura de la seva dispersió respecte del seu valor esperat $\boldsymbol\mu$. És la seva *matriu de covariàncies*, que es defineix com
$$
\begin{array}{l}
\displaystyle Cov(\underline{X})  =E((\underline{X}-\boldsymbol\mu)^t\cdot (\underline{X}-\boldsymbol\mu))=
E\left(\!\begin{pmatrix} X_1-\mu_1 \\ X_2-\mu_2 \\ \vdots \\ X_p-\mu_p\end{pmatrix}\!\cdot\!
(X_1-\mu_1, X_2-\mu_2,\ldots,X_p-\mu_p)\right)\\[3ex] 
\displaystyle \quad
=\begin{pmatrix} E((X_1-\mu_1)^2) & E((X_1-\mu_1)(X_2-\mu_2)) & \ldots  & E((X_1-\mu_1)(X_p-\mu_p))\\
E((X_2-\mu_2)(X_1-\mu_1)) & E((X_2-\mu_2)^2)  &  \ldots  &E((X_2-\mu_2)(X_p-\mu_p))\\
\vdots & \vdots & \ddots  & \vdots\\
E((X_p-\mu_p)(X_1-\mu_1)) & E((X_p-\mu_p)(X_2-\mu_2)) & \ldots  &  E((X_p-\mu_p)^2) 
 \end{pmatrix}
\\[3ex] \displaystyle\quad
=\begin{pmatrix} \sigma_{1 1} & \sigma_{1 2} & \ldots & \sigma_{1
p}\\
\sigma_{2 1} & \sigma_{2 2} & \ldots & \sigma_{2 p}\\
\vdots & \vdots &\ddots  & \vdots\\
\sigma_{p 1} & \sigma_{p 2} & \ldots & \sigma_{p p}\\
 \end{pmatrix}
\end{array}
$$
És a dir, la matriu de covariàncies de $\underline{X}$ té com a entrada $(i,j)$ la covariància $\sigma_{ij}$ de $X_i$ i $X_j$. Es pot comprovar fàcilment que aquesta matriu es pot calcular mitjançant la identitat
$$
Cov(\underline{X})=E(\underline{X}^t\cdot \underline{X})-\boldsymbol\mu^t\cdot \boldsymbol\mu.
$$

### Correlació de Pearson


Com que el valor concret de la covariància és difícil d'interpretar, per a mesurar la relació lineal entre dues variables aleatòries s'usa l'anomenat **coeficient de correlació lineal de Pearson** (o **correlació** a seques), que ve a ser una versió normalitzada de la covariància. En concret, la **correlació** de les variables $X_i$ i $X_j$ es defineix com el quocient
$$
Cor(X_i,X_j)=\frac{\sigma_{i j}}{\sigma_{i} \sigma_{j}},
$$
i és una mesura adimensional de la relació entre $X_i$ i $X_j$. Sovint denotarem $Cor(X_i,X_j)$ per mitjà de $\rho_{ij}$.

Les correlacions tenen les propietats següents:

1. $-1\leq \rho_{i j}\leq 1$.

2. $\rho_{i j}= \rho_{j i}$ i $\rho_{ii}=1$.

3. Si $a_i,a_j,b_i,b_j\in \mathbb{R}$ i $a_i,a_j\neq 0$, llavors
$$
Cor(a_iX_i+b_i,a_jX_j+b_j)=\pm Cor(X_i,X_j),
$$
on el signe que apareix és el del producte $a_i\cdot a_j$.

4. Si $\rho_{i j}=\pm 1$, les variables tenen una relació lineal perfecta, és a dir, existeixen $\alpha,\beta\in \mathbb{R}$ tals que $X_i=\alpha X_j+\beta$. La pendent $\alpha$ d'aquesta recta té el mateix signe que la correlació.

5. Si $\rho_{i j}=0$, diem que les variables $X_i$ i $X_j$ són **incorrelades**.
Notem que la correlació és 0 si, i només si, la covariància és 0. Per tant, dues variables aleatòries independents són incorrelades. El recíproc en general és fals, com mostra l'Exemple \@ref(exm:nocorr).




La *matriu de correlacions* d'un vector aleatori $\underline{X}=(X_1,\ldots,X_p)$ és
$$
Cor(\underline{X})
=\begin{pmatrix} 1 & \rho_{1 2} & \ldots & \rho_{1 p}\\
\rho_{2 1} & 1 & \ldots & \rho_{2 p}\\
\vdots & \vdots & \ddots & \vdots\\
\rho_{p 1} & \rho_{p 2} & \ldots & 1\\
 \end{pmatrix}.
$$




## Estadística descriptiva: Mostres

### Covariàncies

Siguin $x=(x_1,\ldots,x_n)$ i $y=(y_1,\ldots,y_n)$ dos vectors obtinguts mesurant dues variables aleatòries $X$ i $Y$ sobre una mateixa mostra d'individus de mida $n$ d'una població. Siguin $\overline{x}$ i $\overline{y}$ les seves mitjanes mostrals. Aleshores la seva **covariància mostral** és
$$
\widetilde{s}_{xy} =
\frac{1}{n-1} \sum_{i =1}^n\big((x_{i}-\overline{{x}})(y_i-\overline{y})\big)
$$
i la seva **covariància** (**a seques**) és
$$
{s}_{xy} =
\frac{1}{n} \sum_{i =1}^n\big((x_{i}-\overline{{x}})(y_i-\overline{y})\big)=\frac{n-1}{n}\widetilde{s}_{XY}.
$$
És a dir, com sempre, la diferència entre la versió "mostral" i la versió "a seques" rau en el denominador, $n-1$ i $n$ respectvament.

Com en el cas poblacional, la **covariància** entre dos vectors mesura la tendència que tenen les seves dades a variar conjuntament. Quan la covariància és positiva, si una $x_i$ és gran o petita, la corresponent $y_i$ tendeix a tenir el mateix comportament. Quan la covariància és negativa, aquesta tendència s'inverteix: si una $x_i$ és gran, la corresponent $y_i$ tendeix a ser petita, i viceversa. 

És immediat comprovar que les dues covariàncies són simètriques,
$$
\widetilde{s}_{xy}=\widetilde{s}_{yx}
$$
i que covariància generalitza la variància, en el sentit que la variància d'un vector és la seva covariància amb ell mateix
$$
\widetilde{s}_{xy}=\widetilde{s}^2_{x},\
{s}_{xy}={s}^2_{y}.
$$

L'estadístic $\widetilde{s}_{xy}$ sempre és un estimador no esbiaixat de la covariància poblacional $\sigma_{XY}$ de les variables aleatòries $X$ y $Y$ que ha produït els vectors $x$ i $y$, mentre que  $s_2,{xy}$ és el seu estimador màxim versemblant quan la distribució conjunta de les variables $X,Y$ és el que s'anomena [normal bivariant](http://es.wikipedia.org/wiki/Distribución_normal_multivariante}).


```{example,multex1}
Hem mesurat l'índex de massa corporal, BMI, i el nivell de colesterol en 5 individus sans. Guardam els resultats en un *data frame* i en calculam les mitjanes:


```

```{r}
BMI= c(18.3,24.4,24.6,24.4,22.2,19.5)
Chol=c(170,202,215,218,210,210)
DF=data.frame(BMI,Chol)
mean(BMI)
mean(Chol)
```

Aleshores la covariància mostral d'aquests dos vectors és 
$$
\frac{1}{5}\Big((18.3-22.23)(170-205.5)+(24.4-22.23)(202-205.5)+(24.6-22.23)(215-205.5)+(24.4-22.23)(218-205.5)+(22.2-22.23)(210-205.5)+(19.5-22.23)(210-205.5)\Big)=`r cov(BMI,Chol)`
$$

i la seva covariància a seques
$$
\frac{1}{6}\Big((18.3-22.23)(170-205.5)+(24.4-22.23)(202-205.5)+(24.6-22.23)(215-205.5)+(24.4-22.23)(218-205.5)+(22.2-22.23)(210-205.5)+(19.5-22.23)(210-205.5)\Big)=`r 4*cov(BMI,Chol)/5`
$$



La covariància *mostral* de dos vectors numèrics de la mateixa longitud $n$ es pot calcular amb R mitjançant la funció `cov`.
Per  obtenir la seva covariància *a seques*, cal multiplicar el resultat de `cov` per $(n-1)/n$.

```{r}
cov(BMI,Chol)
```

Si tenim una taula de dades de la forma
$$
\begin{pmatrix}
x_{1 1} & x_{1 2} &\ldots & x_{1 p}\\
x_{2 1} & x_{2 2} &\ldots & x_{2 p}\\
\vdots & \vdots   &   \ddots    &\vdots\\ 
x_{n 1} & x_{n 2} &\ldots & x_{n p}
\end{pmatrix}.
$$
on cada columna representa els valors d'una certa variable $X_i$ sobre una mateixa mostra de $n$ individus, la seva **matriu de covariàncies mostrals** és la matriu
$$
\widetilde{{S}}=
\begin{pmatrix}  
 \widetilde{s}_{1 1} & \widetilde{s}_{1 2} & \ldots & \widetilde{s}_{1 p}\\
 \widetilde{s}_{2 1} & \widetilde{s}_{2 2} & \ldots & \widetilde{s}_{2 p}\\
  \vdots & \vdots  &  \ddots      & \vdots\\
\widetilde{s}_{p 1} & \widetilde{s}_{p 2} & \ldots & \widetilde{s}_{p p}
\end{pmatrix}
$$
on cada $\widetilde{s}_{i j}$ representa la covariància mostral de les columnes $i$-èssima i $j$-èssima. La **matriu de covaiàncies** a seques es defineix de manera similar, però amb les covariàncies a seques:
$$
{S}=
\begin{pmatrix}  
 s_{1 1} & s_{1 2} & \ldots & s_{1 p}\\
 s_{2 1} & s_{2 2} & \ldots & s_{2 p}\\
  \vdots & \vdots  &   \ddots     & \vdots\\
 s_{p 1} & s_{p 2} & \ldots & s_{p p}
\end{pmatrix}
$$

La matriu de covariàncies mostrals es calcula amb la funció `cov` aplicada a la matriu o el *data frame* de variables numèriques que emmagatzema la taula de dades. Per calcular la matriu de covaiàncies a seques, es multiplica el resultat de `cov` per $(n-1)/n$, on $n$ és el nombre de fileres de la taula.

```{example,multex2}
Anem a afegir a la taula de dades de l'Exemple \@ref(exm:multex1) una tercera variable amb les edats dels 5 individus representats en ella. 


````

```{r}
DF$Edats=c(49,39,50,44,40,36)
DF
```

La matriu de covariàncies mostrals d'aquesta taula és
```{r}
cov(DF)
```

Podreu observar que a la diagonal hi obtenim les variàncies mostrals de les variables de la taula:
```{r}
apply(DF,MARGIN=2,FUN=var)
```

i que, per exemple, l'entrada (2,1) coincideix amb la covariància de `BMI` i `Chol` que hem calculat abans. La matriu és simètrica, perquè les covariàncies són simètriques.

### Correlació de Pearson


La **correlació de Pearson** de  dos vectors $x=(x_1,\ldots,x_n)$ i $y=(y_1,\ldots,y_n)$ (obtinguts mesurant dues variables aleatòries $X$ i $Y$ sobre una mateixa mostra d'individus de mida $n$ d'una població)  és la seva covariància mostral dividida pel producte de els seves desviacions típiques mostrals:
$$
r_{xy}=\frac{\widetilde{s}_{xy}}{\widetilde{s}_x\cdot \widetilde{s}_y}.
$$

També és igual a la seva covariància dividida pel producte de les seves desviacions típiques, perquè els canvis de denominador se cancel·len:
$$
r_{xy}\frac{\widetilde{s}_{xy}}{\widetilde{s}_x\cdot \widetilde{s}_y}=
\frac{\frac{n}{n-1}\cdot {s}_{xy}}{\sqrt{\frac{n}{n-1}}\cdot {s}_x \cdot\sqrt{\frac{n}{n-1}}\cdot{s}_y}=
\frac{s_{xy}}{s_x \cdot s_y}=r_{xy},
$$


L'estadístic $r_{ij}$ és un estimador màxim versemblant de la correlació de Pearson  $\rho_{XY}$ de less variables aleatòries poblacionals $X$ i $Y$ quan la seva distribució conjunta és normal bivariant i n'és un estimador esbiaixat, amb biaix que tendeix a 0. Altres propietats importants:

* La correlació de Pearson és simètrica: $r_{xy}=r_{yx}$.

* $-1\leq r_{xy}\leq 1$.

* $r_{xx}=1$.

* $r_{x}$ tiene el mismo signo que $s_{xy}$.

* $r_{xy}=\pm 1$ si, i només si, existeixen  $a, b\in \mathbb{R}$ tals que $y=ax+b$, és a dir,  $y_i=ax_i+b$ per a tots els $i=1,\ldots,n$. El pendent $a$ d'aquesta relación lineal té el mateix signe que $r_{xy}$.


* El coeficient de determinació $R^2$ de la regressió lineal per mínims quadrats de $y$ respecte de $x$  és igual al quadrat de la seva correlació de Pearson, $r_{xy}^2$. Per tant, com més s'acosta $|r_{xy}|$ a 1, més s'acosten el vector $x,y$ a dependre linealment ll'un de l'altre.


Amb R, la correlació de Pearson de dos vectors es pot calcular amb la funció `cor`.

```{example,multex1rev}
Tornem a la situació de l'Exemple \@ref(exm:multex1). La covariància mostral i les desviacions típiques mostrals dels vectors `BMI` i `Chol` són

```

```{r}
sd(BMI)
sd(Chol)
cov(BMI,Chol)
```
i per tant la seva correlació de Pearson és
$$
r_{BMI,Chol}=\frac{`r round(cov(BMI,Chol),3)`}{`r round(sd(BMI),3)`\cdot `r round(sd(Chol),3)`}= `r round(round(cov(BMI,Chol),3)/(round(sd(BMI),3)* round(sd(Chol),3)),3)`
$$
Amb R, s'obté directament amb
```{r}
cor(BMI,Chol)
```

Vegem que el seu quadrat és igual al $R^2$ de la regressió lineal de `Chol` en funció de `BMI`:
```{r}
cor(BMI,Chol)^2
summary(lm(Chol~BMI))$r.squared
```

Si tenim una taula de dades de la forma
$$
\begin{pmatrix}
x_{1 1} & x_{1 2} &\ldots & x_{1 p}\\
x_{2 1} & x_{2 2} &\ldots & x_{2 p}\\
\vdots & \vdots   &   \ddots    &\vdots\\ 
x_{n 1} & x_{n 2} &\ldots & x_{n p}
\end{pmatrix}.
$$
on cada columna representa els valors d'una certa variable $X_i$ sobre una mateixa mostra de $n$ individus, la seva **matriu de correlacions de Pearson** és la matriu
$$
\widetilde{R}=
\begin{pmatrix}  
 1 & r_{1 2} & \ldots & r_{1 p}\\
 r_{2 1} & 1 & \ldots & r_{2 p}\\
  \vdots & \vdots  &  \ddots      & \vdots\\
r_{p 1} & r_{p 2} & \ldots & 1
\end{pmatrix}
$$
on cada $r_{i j}$ és la correlació de les columnes $i$-èssima i $j$-èssima. 

Aquesta matriu de correlacions es calcula amb la funció `cor` aplicada a la matriu o el *data frame* de variables numèriques que emmagatzema la taula de dades. 



```{example}
La matriu de correlacions de Pearson de la taula de dades `DF` de l'Exemple \@ref(exm:multex2) és


```

```{r}
cor(DF)
```


## Correlació de Spearman


La correlació de Pearson mesura específicament la tendència de dues variables quantitatives contínues a dependre linealment l'una de l'altra. En circumstàncies en les quals no esperem aquesta dependència lineal, o en les quals les nostres variables siguin quantitatives discretes o simplement qualitatives, emprar la correlació de Pearson per a analitzar la relació entre dues variables no és el més adequat. Entre les propostes alternatives, la més popular és la **correlació de Spearman**. 

Aquest índex assigna a cada valor de cada vector el seu **rang** (la seva posició en el vector ordenat de menor a major, i en cas d'empats la mitjana de les posicions que ocuparien tots els empats) i calcula la correlació de Pearson d'aquests rangs. Amb R, la correlació de Spearman es calcula directament amb la funció `cor` entrant-li el paràmetre `method="spearman"`. (El valor per defecte del paràmetre `method` és `"pearson"` i per això no l'indicam quan calculam la correlació de Pearson.)


```{example} 
Calculem a mà la correlació de Spearman dels vectors `BMI` i `Chol`. El primer que farem serà calcular els rangs dels valors
  
  
```

$$
\begin{array}{|c|c||c|c|}
\hline
\mathit{BMI} & \mathit{Rang} & \mathit{Chol}&  \mathit{Rang}
\\\hline\hline
`r DF[1,1]`& `r rank(DF$BMI)[1]` & `r DF[1,2]`& `r rank(DF$Chol)[1]` \\
`r DF[2,1]`&`r rank(DF$BMI)[2]` & `r DF[2,2]` & `r rank(DF$Chol)[2]`\\
`r DF[3,1]`&`r rank(DF$BMI)[3]` & `r DF[3,2]`& `r rank(DF$Chol)[3]` \\
`r DF[4,1]`&`r rank(DF$BMI)[4]` & `r DF[4,2]`&  `r rank(DF$Chol)[4]`\\ 
`r DF[5,1]`&`r rank(DF$BMI)[5]` & `r DF[5,2]`&  `r rank(DF$Chol)[5]`\\
`r DF[6,1]`&`r rank(DF$BMI)[6]` & `r DF[6,2]`&  `r rank(DF$Chol)[6]`\\\hline
\end{array}
$$




Per tant, la correlación de Spearman de 
$$
\mathit{BMI}=(`r BMI`)\mbox{ i }\mathit{Chol}=(`r Chol`)
$$
és la correlació de Pearson de
$$
(`r rank(BMI)`)\mbox{ y }(`r rank(Chol)`)
$$

Veámoslo:

```{r}
cor(BMI,Chol,method="spearman")
cor(c(1,4.5,6,4.5,3,2),c(1,2,4,5.5,3,5.5))
```


## Contrastos de correlació

En un **contrast de correlació** de dues variables poblacionals $X$ i $Y$, la hipòtesi nul·la és que no hi ha correlació entre les dues variables, la qual cosa tradueix que no hi ha relació entre elles:
$$
\left\{
\begin{array}{ll}
H_0: & \rho_{XY}=0\\
H_1: & \rho_{XY}> 0\text{ o }\rho_{XY}< 0\text{ o }\rho_{XY}\neq 0
\end{array}\right.
$$

Fixau-vos que si en un contrast d'aquests rebutjau la hipòtesi nul·la, en particular arribau a la conclusió que les variables $X$ i $Y$ no són independents (perquè si fossin independents, la seva correlació seria 0).


Amb R es pot efectuar amb la funció `cor.test`.

```{example}
Volem contrastar si hi ha correlació positiva entre el BMI i el nivell de colesterol d'un adult sa, amb un nivell de significació del 5%.


```

*Variables poblacionals d'interès*:

* $\mathit{BMI}$: "Prenem un adult sa i mesuram el seu BMI"
* $\mathit{Chol}$: "Prenem un adult sa i mesuram el nivell de colesterol"

*Contrast*:
$$
\left\{
\begin{array}{ll}
H_0: & \rho_{\textit{BMI,Chol}}=0\\
H_1: & \rho_{\textit{BMI,Chol}}>0
\end{array}\right.
$$

Emprarem les mostres `BMI` i `Chol` de l'Exemple\@ref(exm:multex1).

```{r}
cor.test(BMI,Chol,alternative="greater")
```

*Conclusió*: No hem obtingut evidència estadísticament significativa que el BMI i el nivell de colesterol d'un adult sa tenguin correlació positiva   (test de correlació, p-valor 0.1134, IC 95% per a la correlació de $-0.278$ a 1).


