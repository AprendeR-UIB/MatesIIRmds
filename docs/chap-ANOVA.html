<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Tema 10 ANOVA | Matemàtiques II v.2021</title>
  <meta name="description" content="Apunts Matemàtiques II bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Tema 10 ANOVA | Matemàtiques II v.2021" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Apunts Matemàtiques II bookdown::gitbook." />
  <meta name="github-repo" content="cescrossello/MatesII" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Tema 10 ANOVA | Matemàtiques II v.2021" />
  
  <meta name="twitter:description" content="Apunts Matemàtiques II bookdown::gitbook." />
  



<meta name="date" content="2021-05-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chap-ED.html"/>
<link rel="next" href="regressió-lineal.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Bioestadística II</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Presentació</a></li>
<li class="chapter" data-level="1" data-path="chap-conceptes.html"><a href="chap-conceptes.html"><i class="fa fa-check"></i><b>1</b> Alguns conceptes bàsics</a>
<ul>
<li class="chapter" data-level="1.1" data-path="chap-conceptes.html"><a href="chap-conceptes.html#tipus-de-dades"><i class="fa fa-check"></i><b>1.1</b> Tipus de dades</a></li>
<li class="chapter" data-level="1.2" data-path="chap-conceptes.html"><a href="chap-conceptes.html#població"><i class="fa fa-check"></i><b>1.2</b> Població</a></li>
<li class="chapter" data-level="1.3" data-path="chap-conceptes.html"><a href="chap-conceptes.html#variable-aleatòria"><i class="fa fa-check"></i><b>1.3</b> Variable aleatòria</a></li>
<li class="chapter" data-level="1.4" data-path="chap-conceptes.html"><a href="chap-conceptes.html#mostra"><i class="fa fa-check"></i><b>1.4</b> Mostra</a></li>
<li class="chapter" data-level="1.5" data-path="chap-conceptes.html"><a href="chap-conceptes.html#sec:mostreig"><i class="fa fa-check"></i><b>1.5</b> Mostreig aleatori</a></li>
<li class="chapter" data-level="1.6" data-path="chap-conceptes.html"><a href="chap-conceptes.html#mostres-de-conveniència"><i class="fa fa-check"></i><b>1.6</b> Mostres de conveniència</a></li>
<li class="chapter" data-level="1.7" data-path="chap-conceptes.html"><a href="chap-conceptes.html#test-de-la-lliçó-1"><i class="fa fa-check"></i><b>1.7</b> Test de la lliçó 1</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chap-varal.html"><a href="chap-varal.html"><i class="fa fa-check"></i><b>2</b> Variables aleatòries</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chap-varal.html"><a href="chap-varal.html#generalitats-sobre-variables-aleatòries"><i class="fa fa-check"></i><b>2.1</b> Generalitats sobre variables aleatòries</a></li>
<li class="chapter" data-level="2.2" data-path="chap-varal.html"><a href="chap-varal.html#variables-aleatòries-discretes"><i class="fa fa-check"></i><b>2.2</b> Variables aleatòries discretes</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="chap-varal.html"><a href="chap-varal.html#densitat-i-distribució"><i class="fa fa-check"></i><b>2.2.1</b> Densitat i distribució</a></li>
<li class="chapter" data-level="2.2.2" data-path="chap-varal.html"><a href="chap-varal.html#esperança"><i class="fa fa-check"></i><b>2.2.2</b> Esperança</a></li>
<li class="chapter" data-level="2.2.3" data-path="chap-varal.html"><a href="chap-varal.html#variància-i-desviació-típica"><i class="fa fa-check"></i><b>2.2.3</b> Variància i desviació típica</a></li>
<li class="chapter" data-level="2.2.4" data-path="chap-varal.html"><a href="chap-varal.html#quantils"><i class="fa fa-check"></i><b>2.2.4</b> Quantils</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="chap-varal.html"><a href="chap-varal.html#famílies-importants-de-variables-aleatòries-discretes"><i class="fa fa-check"></i><b>2.3</b> Famílies importants de variables aleatòries discretes</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="chap-varal.html"><a href="chap-varal.html#variables-aleatòries-binomials"><i class="fa fa-check"></i><b>2.3.1</b> Variables aleatòries binomials</a></li>
<li class="chapter" data-level="2.3.2" data-path="chap-varal.html"><a href="chap-varal.html#variables-aleatòries-hipergeomètriques"><i class="fa fa-check"></i><b>2.3.2</b> Variables aleatòries hipergeomètriques</a></li>
<li class="chapter" data-level="2.3.3" data-path="chap-varal.html"><a href="chap-varal.html#variables-aleatòries-de-poisson"><i class="fa fa-check"></i><b>2.3.3</b> Variables aleatòries de Poisson</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="chap-varal.html"><a href="chap-varal.html#variables-aleatòries-contínues"><i class="fa fa-check"></i><b>2.4</b> Variables aleatòries contínues</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="chap-varal.html"><a href="chap-varal.html#densitat-i-distribució-1"><i class="fa fa-check"></i><b>2.4.1</b> Densitat i distribució</a></li>
<li class="chapter" data-level="2.4.2" data-path="chap-varal.html"><a href="chap-varal.html#esperança-variància-quantils"><i class="fa fa-check"></i><b>2.4.2</b> Esperança, variància, quantils…</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="chap-varal.html"><a href="chap-varal.html#sec:normal"><i class="fa fa-check"></i><b>2.5</b> Variables aleatòries normals</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="chap-varal.html"><a href="chap-varal.html#amb-r"><i class="fa fa-check"></i><b>2.5.1</b> Amb R</a></li>
<li class="chapter" data-level="2.5.2" data-path="chap-varal.html"><a href="chap-varal.html#propietats-bàsiques"><i class="fa fa-check"></i><b>2.5.2</b> Propietats bàsiques</a></li>
<li class="chapter" data-level="2.5.3" data-path="chap-varal.html"><a href="chap-varal.html#intervals-de-referència"><i class="fa fa-check"></i><b>2.5.3</b> Intervals de referència</a></li>
<li class="chapter" data-level="2.5.4" data-path="chap-varal.html"><a href="chap-varal.html#sec:lognormal"><i class="fa fa-check"></i><b>2.5.4</b> Variables log-normals</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="chap-varal.html"><a href="chap-varal.html#test-de-la-lliçó-2"><i class="fa fa-check"></i><b>2.6</b> Test de la lliçó 2</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chap-estim.html"><a href="chap-estim.html"><i class="fa fa-check"></i><b>3</b> Estimació puntual</a>
<ul>
<li class="chapter" data-level="3.1" data-path="chap-estim.html"><a href="chap-estim.html#estimadors"><i class="fa fa-check"></i><b>3.1</b> Estimadors</a></li>
<li class="chapter" data-level="3.2" data-path="chap-estim.html"><a href="chap-estim.html#mitjana-mostral"><i class="fa fa-check"></i><b>3.2</b> Mitjana mostral</a></li>
<li class="chapter" data-level="3.3" data-path="chap-estim.html"><a href="chap-estim.html#proporció-mostral"><i class="fa fa-check"></i><b>3.3</b> Proporció mostral</a></li>
<li class="chapter" data-level="3.4" data-path="chap-estim.html"><a href="chap-estim.html#variància-mostral"><i class="fa fa-check"></i><b>3.4</b> Variància mostral</a></li>
<li class="chapter" data-level="3.5" data-path="chap-estim.html"><a href="chap-estim.html#la-distribució-t-de-student"><i class="fa fa-check"></i><b>3.5</b> La distribució t de Student</a></li>
<li class="chapter" data-level="3.6" data-path="chap-estim.html"><a href="chap-estim.html#biaix-i-precisió"><i class="fa fa-check"></i><b>3.6</b> Biaix i precisió</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="chap-estim.html"><a href="chap-estim.html#estimadors-no-esbiaixats"><i class="fa fa-check"></i><b>3.6.1</b> Estimadors no esbiaixats</a></li>
<li class="chapter" data-level="3.6.2" data-path="chap-estim.html"><a href="chap-estim.html#sec:precis"><i class="fa fa-check"></i><b>3.6.2</b> Estimadors precisos</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="chap-estim.html"><a href="chap-estim.html#estimadors-màxim-versemblants"><i class="fa fa-check"></i><b>3.7</b> Estimadors màxim versemblants</a></li>
<li class="chapter" data-level="3.8" data-path="chap-estim.html"><a href="chap-estim.html#sec:pobl"><i class="fa fa-check"></i><b>3.8</b> Estimació de poblacions</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="chap-estim.html"><a href="chap-estim.html#estimació-de-poblacions-numerades"><i class="fa fa-check"></i><b>3.8.1</b> Estimació de poblacions numerades</a></li>
<li class="chapter" data-level="3.8.2" data-path="chap-estim.html"><a href="chap-estim.html#marca-recaptura"><i class="fa fa-check"></i><b>3.8.2</b> Marca-recaptura</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="chap-estim.html"><a href="chap-estim.html#test-de-la-lliçó-3"><i class="fa fa-check"></i><b>3.9</b> Test de la lliçó 3</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chap-IC.html"><a href="chap-IC.html"><i class="fa fa-check"></i><b>4</b> Intervals de confiança</a>
<ul>
<li class="chapter" data-level="4.1" data-path="chap-IC.html"><a href="chap-IC.html#definició-dinterval-de-confiança"><i class="fa fa-check"></i><b>4.1</b> Definició d’interval de confiança</a></li>
<li class="chapter" data-level="4.2" data-path="chap-IC.html"><a href="chap-IC.html#exemple-interval-de-confiança-del-95-per-a-la-mitjana-duna-variable-aleatòria-normal"><i class="fa fa-check"></i><b>4.2</b> Exemple: Interval de confiança del 95% per a la mitjana d’una variable aleatòria normal</a></li>
<li class="chapter" data-level="4.3" data-path="chap-IC.html"><a href="chap-IC.html#interval-de-confiança-per-a-la-mitjana-basat-en-la-t-de-student"><i class="fa fa-check"></i><b>4.3</b> Interval de confiança per a la mitjana basat en la t de Student</a>
<ul>
<li class="chapter" data-level="" data-path="chap-IC.html"><a href="chap-IC.html#la-fórmula"><i class="fa fa-check"></i>La fórmula</a></li>
<li class="chapter" data-level="" data-path="chap-IC.html"><a href="chap-IC.html#algunes-consideracions"><i class="fa fa-check"></i>Algunes consideracions</a></li>
<li class="chapter" data-level="" data-path="chap-varal.html"><a href="chap-varal.html#amb-r"><i class="fa fa-check"></i>Amb R</a></li>
<li class="chapter" data-level="" data-path="chap-IC.html"><a href="chap-IC.html#càlcul-de-la-mida-de-la-mostra-per-fixar-lerror"><i class="fa fa-check"></i>Càlcul de la mida de la mostra per fixar l’error</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="chap-IC.html"><a href="chap-IC.html#intervals-de-confiança-per-a-proporcions"><i class="fa fa-check"></i><b>4.4</b> Intervals de confiança per a proporcions</a>
<ul>
<li class="chapter" data-level="" data-path="chap-IC.html"><a href="chap-IC.html#mètode-exacte-de-clopper-pearson"><i class="fa fa-check"></i>Mètode “exacte” de Clopper-Pearson</a></li>
<li class="chapter" data-level="" data-path="chap-IC.html"><a href="chap-IC.html#mètode-de-wilson"><i class="fa fa-check"></i>Mètode de Wilson</a></li>
<li class="chapter" data-level="" data-path="chap-IC.html"><a href="chap-IC.html#mètode-de-laplace"><i class="fa fa-check"></i>Mètode de Laplace</a></li>
<li><a href="chap-IC.html#quan-podem-calcular-més-dun-interval-per-a-p_x-quin-calculam">Quan podem calcular més d’un interval per a <span class="math inline">\(p_X\)</span>, quin calculam?</a></li>
<li class="chapter" data-level="" data-path="chap-IC.html"><a href="chap-IC.html#càlcul-de-la-mida-de-la-mostra-per-a-fixar-lerror"><i class="fa fa-check"></i>Càlcul de la mida de la mostra per a fixar l’error</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="chap-IC.html"><a href="chap-IC.html#intervals-de-confiança-per-a-la-variància-i-la-desviació-típica-duna-variable-normal"><i class="fa fa-check"></i><b>4.5</b> Intervals de confiança per a la variància i la desviació típica d’una variable normal</a></li>
<li class="chapter" data-level="4.6" data-path="chap-IC.html"><a href="chap-IC.html#poblacions-finites"><i class="fa fa-check"></i><b>4.6</b> “Poblacions finites”</a></li>
<li class="chapter" data-level="4.7" data-path="chap-IC.html"><a href="chap-IC.html#test-de-la-lliçó-4"><i class="fa fa-check"></i><b>4.7</b> Test de la lliçó 4</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chap-chgen.html"><a href="chap-chgen.html"><i class="fa fa-check"></i><b>5</b> Contrastos d’hipòtesis: Generalitats</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chap-chgen.html"><a href="chap-chgen.html#les-hipòtesis-nulla-i-alternativa"><i class="fa fa-check"></i><b>5.1</b> Les hipòtesis nul·la i alternativa</a></li>
<li class="chapter" data-level="5.2" data-path="chap-chgen.html"><a href="chap-chgen.html#sec:moneda"><i class="fa fa-check"></i><b>5.2</b> Un exemple</a></li>
<li class="chapter" data-level="5.3" data-path="chap-chgen.html"><a href="chap-chgen.html#sec:pval"><i class="fa fa-check"></i><b>5.3</b> El p-valor</a></li>
<li class="chapter" data-level="5.4" data-path="chap-chgen.html"><a href="chap-chgen.html#tipus-derrors"><i class="fa fa-check"></i><b>5.4</b> Tipus d’errors</a></li>
<li class="chapter" data-level="5.5" data-path="chap-chgen.html"><a href="chap-chgen.html#sec:exttest"><i class="fa fa-check"></i><b>5.5</b> Exemple: El test t</a></li>
<li class="chapter" data-level="5.6" data-path="chap-chgen.html"><a href="chap-chgen.html#recapitulació"><i class="fa fa-check"></i><b>5.6</b> Recapitulació</a>
<ul>
<li class="chapter" data-level="" data-path="chap-chgen.html"><a href="chap-chgen.html#interval-de-confiança-dun-contrast"><i class="fa fa-check"></i>Interval de confiança d’un contrast</a></li>
<li class="chapter" data-level="" data-path="chap-chgen.html"><a href="chap-chgen.html#la-potència"><i class="fa fa-check"></i>La potència</a></li>
<li class="chapter" data-level="" data-path="chap-chgen.html"><a href="chap-chgen.html#el-risc-de-positiu-fals-opcional"><i class="fa fa-check"></i>El risc de positiu fals (Opcional)</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="chap-chgen.html"><a href="chap-chgen.html#test-de-la-lliçó-5"><i class="fa fa-check"></i><b>5.7</b> Test de la lliçó 5</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="contrastos-dhipòtesis-dun-i-dos-paràmetres.html"><a href="contrastos-dhipòtesis-dun-i-dos-paràmetres.html"><i class="fa fa-check"></i><b>6</b> Contrastos d’hipòtesis d’un i dos paràmetres</a>
<ul>
<li class="chapter" data-level="6.1" data-path="contrastos-dhipòtesis-dun-i-dos-paràmetres.html"><a href="contrastos-dhipòtesis-dun-i-dos-paràmetres.html#contrastos-de-mitjanes"><i class="fa fa-check"></i><b>6.1</b> Contrastos de mitjanes</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="contrastos-dhipòtesis-dun-i-dos-paràmetres.html"><a href="contrastos-dhipòtesis-dun-i-dos-paràmetres.html#test-t-per-a-una-mitjana"><i class="fa fa-check"></i><b>6.1.1</b> Test t per a una mitjana</a></li>
<li class="chapter" data-level="6.1.2" data-path="contrastos-dhipòtesis-dun-i-dos-paràmetres.html"><a href="contrastos-dhipòtesis-dun-i-dos-paràmetres.html#test-t-per-a-dues-mitjanes"><i class="fa fa-check"></i><b>6.1.2</b> Test t per a dues mitjanes</a></li>
<li class="chapter" data-level="6.1.3" data-path="contrastos-dhipòtesis-dun-i-dos-paràmetres.html"><a href="contrastos-dhipòtesis-dun-i-dos-paràmetres.html#tests-t-amb-r"><i class="fa fa-check"></i><b>6.1.3</b> Tests t amb R</a></li>
<li class="chapter" data-level="6.1.4" data-path="contrastos-dhipòtesis-dun-i-dos-paràmetres.html"><a href="contrastos-dhipòtesis-dun-i-dos-paràmetres.html#exemples"><i class="fa fa-check"></i><b>6.1.4</b> Exemples</a></li>
<li class="chapter" data-level="6.1.5" data-path="contrastos-dhipòtesis-dun-i-dos-paràmetres.html"><a href="contrastos-dhipòtesis-dun-i-dos-paràmetres.html#tests-no-paramètrics"><i class="fa fa-check"></i><b>6.1.5</b> Tests no paramètrics</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="contrastos-dhipòtesis-dun-i-dos-paràmetres.html"><a href="contrastos-dhipòtesis-dun-i-dos-paràmetres.html#sec:contrvar"><i class="fa fa-check"></i><b>6.2</b> Contrastos de variàncies</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="contrastos-dhipòtesis-dun-i-dos-paràmetres.html"><a href="contrastos-dhipòtesis-dun-i-dos-paràmetres.html#test-chi2-duna-variància"><i class="fa fa-check"></i><b>6.2.1</b> Test <span class="math inline">\(\chi^2\)</span> d’una variància</a></li>
<li class="chapter" data-level="6.2.2" data-path="contrastos-dhipòtesis-dun-i-dos-paràmetres.html"><a href="contrastos-dhipòtesis-dun-i-dos-paràmetres.html#test-f-per-a-dues-variàncies"><i class="fa fa-check"></i><b>6.2.2</b> Test F per a dues variàncies</a></li>
<li class="chapter" data-level="6.2.3" data-path="contrastos-dhipòtesis-dun-i-dos-paràmetres.html"><a href="contrastos-dhipòtesis-dun-i-dos-paràmetres.html#tests-no-paramètrics-1"><i class="fa fa-check"></i><b>6.2.3</b> Tests no paramètrics</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="contrastos-dhipòtesis-dun-i-dos-paràmetres.html"><a href="contrastos-dhipòtesis-dun-i-dos-paràmetres.html#contrastos-per-a-proporcions"><i class="fa fa-check"></i><b>6.3</b> Contrastos per a proporcions</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="contrastos-dhipòtesis-dun-i-dos-paràmetres.html"><a href="contrastos-dhipòtesis-dun-i-dos-paràmetres.html#contrastos-per-a-una-proporció"><i class="fa fa-check"></i><b>6.3.1</b> Contrastos per a una proporció</a></li>
<li class="chapter" data-level="6.3.2" data-path="contrastos-dhipòtesis-dun-i-dos-paràmetres.html"><a href="contrastos-dhipòtesis-dun-i-dos-paràmetres.html#contrastos-per-a-2-proporcions-emprant-mostres-independents"><i class="fa fa-check"></i><b>6.3.2</b> Contrastos per a 2 proporcions emprant mostres independents</a></li>
<li class="chapter" data-level="6.3.3" data-path="contrastos-dhipòtesis-dun-i-dos-paràmetres.html"><a href="contrastos-dhipòtesis-dun-i-dos-paràmetres.html#contrastos-per-a-2-proporcions-emprant-mostres-aparellades"><i class="fa fa-check"></i><b>6.3.3</b> Contrastos per a 2 proporcions emprant mostres aparellades</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="contrastos-dhipòtesis-dun-i-dos-paràmetres.html"><a href="contrastos-dhipòtesis-dun-i-dos-paràmetres.html#test-de-la-lliçó-6"><i class="fa fa-check"></i><b>6.4</b> Test de la lliçó 6</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chap-bondat.html"><a href="chap-bondat.html"><i class="fa fa-check"></i><b>7</b> Contrastos de bondat d’ajust</a>
<ul>
<li class="chapter" data-level="7.1" data-path="chap-bondat.html"><a href="chap-bondat.html#bondat-dajust"><i class="fa fa-check"></i><b>7.1</b> Bondat d’ajust</a></li>
<li class="chapter" data-level="7.2" data-path="chap-bondat.html"><a href="chap-bondat.html#test-chi2-de-pearson"><i class="fa fa-check"></i><b>7.2</b> Test <span class="math inline">\(\chi^2\)</span> de Pearson</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="chap-bondat.html"><a href="chap-bondat.html#el-test-bàsic"><i class="fa fa-check"></i><b>7.2.1</b> El test bàsic</a></li>
<li class="chapter" data-level="7.2.2" data-path="chap-bondat.html"><a href="chap-bondat.html#mètode-de-montecarlo"><i class="fa fa-check"></i><b>7.2.2</b> Mètode de Montecarlo</a></li>
<li class="chapter" data-level="7.2.3" data-path="chap-bondat.html"><a href="chap-bondat.html#test-chi2-amb-paràmetres-poblacionals-desconeguts"><i class="fa fa-check"></i><b>7.2.3</b> Test <span class="math inline">\(\chi^2\)</span> amb paràmetres poblacionals desconeguts</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="chap-bondat.html"><a href="chap-bondat.html#test-de-kolmogorov-smirnov"><i class="fa fa-check"></i><b>7.3</b> Test de Kolmogorov-Smirnov</a></li>
<li class="chapter" data-level="7.4" data-path="chap-bondat.html"><a href="chap-bondat.html#test-de-kolmogorov-smirnov-lilliefors"><i class="fa fa-check"></i><b>7.4</b> Test de Kolmogorov-Smirnov-Lilliefors</a></li>
<li class="chapter" data-level="7.5" data-path="chap-bondat.html"><a href="chap-bondat.html#test-de-la-lliçó-7"><i class="fa fa-check"></i><b>7.5</b> Test de la lliçó 7</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="contrastos-dindependència-i-homogeneïtat.html"><a href="contrastos-dindependència-i-homogeneïtat.html"><i class="fa fa-check"></i><b>8</b> Contrastos d’independència i homogeneïtat</a>
<ul>
<li class="chapter" data-level="8.1" data-path="contrastos-dindependència-i-homogeneïtat.html"><a href="contrastos-dindependència-i-homogeneïtat.html#test-chi2-dindependència"><i class="fa fa-check"></i><b>8.1</b> Test <span class="math inline">\(\chi^2\)</span> d’independència</a></li>
<li class="chapter" data-level="8.2" data-path="contrastos-dindependència-i-homogeneïtat.html"><a href="contrastos-dindependència-i-homogeneïtat.html#test-chi2-dhomogeneïtat"><i class="fa fa-check"></i><b>8.2</b> Test <span class="math inline">\(\chi^2\)</span> d’homogeneïtat</a></li>
<li class="chapter" data-level="8.3" data-path="contrastos-dindependència-i-homogeneïtat.html"><a href="contrastos-dindependència-i-homogeneïtat.html#test-chi2-de-tendència-opcional"><i class="fa fa-check"></i><b>8.3</b> Test <span class="math inline">\(\chi^2\)</span> de tendència (Opcional)</a></li>
<li class="chapter" data-level="8.4" data-path="contrastos-dindependència-i-homogeneïtat.html"><a href="contrastos-dindependència-i-homogeneïtat.html#test-de-la-lliçó-8"><i class="fa fa-check"></i><b>8.4</b> Test de la lliçó 8</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chap-ED.html"><a href="chap-ED.html"><i class="fa fa-check"></i><b>9</b> Introducció a l’estadística multidimensional</a>
<ul>
<li class="chapter" data-level="9.1" data-path="chap-ED.html"><a href="chap-ED.html#poblacions-vectors-aleatoris"><i class="fa fa-check"></i><b>9.1</b> Poblacions: vectors aleatoris</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="chap-ED.html"><a href="chap-ED.html#covariància"><i class="fa fa-check"></i><b>9.1.1</b> Covariància</a></li>
<li class="chapter" data-level="9.1.2" data-path="chap-ED.html"><a href="chap-ED.html#correlació"><i class="fa fa-check"></i><b>9.1.2</b> Correlació</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="chap-ED.html"><a href="chap-ED.html#estadística-descriptiva-mostres"><i class="fa fa-check"></i><b>9.2</b> Estadística descriptiva: Mostres</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="chap-ED.html"><a href="chap-ED.html#covariàncies"><i class="fa fa-check"></i><b>9.2.1</b> Covariàncies</a></li>
<li class="chapter" data-level="9.2.2" data-path="chap-ED.html"><a href="chap-ED.html#correlació-de-pearson"><i class="fa fa-check"></i><b>9.2.2</b> Correlació de Pearson</a></li>
<li class="chapter" data-level="9.2.3" data-path="chap-ED.html"><a href="chap-ED.html#estimació"><i class="fa fa-check"></i><b>9.2.3</b> Estimació</a></li>
<li class="chapter" data-level="9.2.4" data-path="chap-ED.html"><a href="chap-ED.html#correlació-de-spearman"><i class="fa fa-check"></i><b>9.2.4</b> Correlació de Spearman</a></li>
<li class="chapter" data-level="9.2.5" data-path="chap-ED.html"><a href="chap-ED.html#contrastos-de-correlació"><i class="fa fa-check"></i><b>9.2.5</b> Contrastos de correlació</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="chap-ED.html"><a href="chap-ED.html#test-de-la-lliçó-9"><i class="fa fa-check"></i><b>9.3</b> Test de la lliçó 9</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chap-ANOVA.html"><a href="chap-ANOVA.html"><i class="fa fa-check"></i><b>10</b> ANOVA</a>
<ul>
<li class="chapter" data-level="10.1" data-path="chap-ANOVA.html"><a href="chap-ANOVA.html#nocions-bàsiques"><i class="fa fa-check"></i><b>10.1</b> Nocions bàsiques</a></li>
<li class="chapter" data-level="10.2" data-path="chap-ANOVA.html"><a href="chap-ANOVA.html#anova-d1-via"><i class="fa fa-check"></i><b>10.2</b> ANOVA d’1 via</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="chap-ANOVA.html"><a href="chap-ANOVA.html#contrast-bàsic"><i class="fa fa-check"></i><b>10.2.1</b> Contrast bàsic</a></li>
<li class="chapter" data-level="10.2.2" data-path="chap-varal.html"><a href="chap-varal.html#amb-r"><i class="fa fa-check"></i><b>10.2.2</b> Amb R</a></li>
<li class="chapter" data-level="10.2.3" data-path="chap-ANOVA.html"><a href="chap-ANOVA.html#comparacions-posteriors-per-parelles"><i class="fa fa-check"></i><b>10.2.3</b> Comparacions posteriors per parelles</a></li>
<li class="chapter" data-level="10.2.4" data-path="chap-ANOVA.html"><a href="chap-ANOVA.html#comprovació-de-les-condicions"><i class="fa fa-check"></i><b>10.2.4</b> Comprovació de les condicions</a></li>
<li class="chapter" data-level="10.2.5" data-path="chap-ANOVA.html"><a href="chap-ANOVA.html#test-no-paramètric"><i class="fa fa-check"></i><b>10.2.5</b> Test no paramètric</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="chap-ANOVA.html"><a href="chap-ANOVA.html#anova-de-blocs"><i class="fa fa-check"></i><b>10.3</b> ANOVA de blocs</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="chap-ANOVA.html"><a href="chap-ANOVA.html#contrast-bàsic-1"><i class="fa fa-check"></i><b>10.3.1</b> Contrast bàsic</a></li>
<li class="chapter" data-level="10.3.2" data-path="chap-ANOVA.html"><a href="chap-ANOVA.html#amb-r-1"><i class="fa fa-check"></i><b>10.3.2</b> Amb R</a></li>
<li class="chapter" data-level="10.3.3" data-path="chap-ANOVA.html"><a href="chap-ANOVA.html#comparacions-posteriors-per-parelles-1"><i class="fa fa-check"></i><b>10.3.3</b> Comparacions posteriors per parelles</a></li>
<li class="chapter" data-level="10.3.4" data-path="chap-ANOVA.html"><a href="chap-ANOVA.html#contrast-no-paramètric"><i class="fa fa-check"></i><b>10.3.4</b> Contrast no paramètric</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="chap-ANOVA.html"><a href="chap-ANOVA.html#anova-de-2-vies"><i class="fa fa-check"></i><b>10.4</b> ANOVA de 2 vies</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="chap-ANOVA.html"><a href="chap-ANOVA.html#contrast-bàsic-2"><i class="fa fa-check"></i><b>10.4.1</b> Contrast bàsic</a></li>
<li class="chapter" data-level="10.4.2" data-path="chap-ANOVA.html"><a href="chap-ANOVA.html#amb-r-2"><i class="fa fa-check"></i><b>10.4.2</b> Amb R</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="chap-ANOVA.html"><a href="chap-ANOVA.html#test-de-la-lliçó-10"><i class="fa fa-check"></i><b>10.5</b> Test de la lliçó 10</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="regressió-lineal.html"><a href="regressió-lineal.html"><i class="fa fa-check"></i><b>11</b> Regressió lineal</a>
<ul>
<li class="chapter" data-level="11.1" data-path="regressió-lineal.html"><a href="regressió-lineal.html#regressió-lineal-simple"><i class="fa fa-check"></i><b>11.1</b> Regressió lineal simple</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="regressió-lineal.html"><a href="regressió-lineal.html#el-model"><i class="fa fa-check"></i><b>11.1.1</b> El model</a></li>
<li class="chapter" data-level="11.1.2" data-path="regressió-lineal.html"><a href="regressió-lineal.html#mínims-quadrats"><i class="fa fa-check"></i><b>11.1.2</b> Mínims quadrats</a></li>
<li class="chapter" data-level="11.1.3" data-path="regressió-lineal.html"><a href="regressió-lineal.html#coeficient-de-determinació"><i class="fa fa-check"></i><b>11.1.3</b> Coeficient de determinació</a></li>
<li class="chapter" data-level="11.1.4" data-path="regressió-lineal.html"><a href="regressió-lineal.html#intervals-de-confiança-dels-coeficients"><i class="fa fa-check"></i><b>11.1.4</b> Intervals de confiança dels coeficients</a></li>
<li class="chapter" data-level="11.1.5" data-path="regressió-lineal.html"><a href="regressió-lineal.html#intervals-de-confiança-per-a-les-estimacions-de-la-variable-dependent"><i class="fa fa-check"></i><b>11.1.5</b> Intervals de confiança per a les estimacions de la variable dependent</a></li>
<li class="chapter" data-level="11.1.6" data-path="regressió-lineal.html"><a href="regressió-lineal.html#té-sentit-una-regressió-lineal"><i class="fa fa-check"></i><b>11.1.6</b> Té sentit una regressió lineal?</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="regressió-lineal.html"><a href="regressió-lineal.html#regressió-lineal-múltiple"><i class="fa fa-check"></i><b>11.2</b> Regressió lineal múltiple</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="regressió-lineal.html"><a href="regressió-lineal.html#mínims-quadrats-1"><i class="fa fa-check"></i><b>11.2.1</b> Mínims quadrats</a></li>
<li class="chapter" data-level="11.2.2" data-path="regressió-lineal.html"><a href="regressió-lineal.html#coeficient-de-determinació-múltiple"><i class="fa fa-check"></i><b>11.2.2</b> Coeficient de determinació múltiple</a></li>
<li class="chapter" data-level="11.2.3" data-path="regressió-lineal.html"><a href="regressió-lineal.html#coeficient-de-determinació-ajustat"><i class="fa fa-check"></i><b>11.2.3</b> Coeficient de determinació ajustat</a></li>
<li class="chapter" data-level="11.2.4" data-path="regressió-lineal.html"><a href="regressió-lineal.html#intervals-de-confiança-per-als-coeficients"><i class="fa fa-check"></i><b>11.2.4</b> Intervals de confiança per als coeficients</a></li>
<li class="chapter" data-level="11.2.5" data-path="regressió-lineal.html"><a href="regressió-lineal.html#intervals-de-confiança-per-a-les-estimacions-de-la-variable-resposta"><i class="fa fa-check"></i><b>11.2.5</b> Intervals de confiança per a les estimacions de la variable resposta</a></li>
<li class="chapter" data-level="11.2.6" data-path="regressió-lineal.html"><a href="regressió-lineal.html#lanova-de-la-regressió-lineal-múltiple"><i class="fa fa-check"></i><b>11.2.6</b> L’ANOVA de la regressió lineal múltiple</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="regressió-lineal.html"><a href="regressió-lineal.html#test-de-la-lliçó-11"><i class="fa fa-check"></i><b>11.3</b> Test de la lliçó 11</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Matemàtiques II v.2021</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chap:ANOVA" class="section level1" number="10">
<h1><span class="header-section-number">Tema 10</span> ANOVA</h1>
<p>L’objectiu d’aquest tema és generalitzar el contrast bilateral de dues mitjanes emprant un test t a més de dues mitjanes, de tal manera que amb un sol test poguem decidir si hi ha evidència que alguna parella d’aquestes mitjanes siguin diferents o si pel contrari podem acceptar que totes les mitjanes són iguals.</p>
<div id="nocions-bàsiques" class="section level2" number="10.1">
<h2><span class="header-section-number">10.1</span> Nocions bàsiques</h2>
<p>Comencem considerant un problema concret.</p>

<div class="example">
<p><span id="exm:CO2" class="example"><strong>Exemple 10.1  </strong></span>Es realitzà un estudi per investigar l’efecte del CO<sub>2</sub> sobre la taxa de creixement de <em>Pseudomonas fragi</em>, un corruptor d’aliments.
Per contrastar si el seu creixement es veu afectat per la quantitat de CO<sub>2</sub> en l’aire, s’administrà CO<sub>2</sub> a 5 pressions atmosfèriques diferents a 10 cultius diferents per cada nivell de pressió de CO<sub>2</sub> i s’anotà el percentatge d’increment de la massa cel·lular de cada cultiu al cap d’una hora.</p>
</div>
<p>Les dades obtingudes varen ser:
<span class="math display">\[
\begin{array}{c}
\text{Pressió de CO${}_2$ (en atmosferes)}\\
\begin{array}{rrrrr}
 0.0 &amp; 0.08 &amp; 0.29 &amp; 0.50 &amp; 0.86 \\\hline
 62.6 &amp; 50.9 &amp; 45.5 &amp; 29.5 &amp; 24.9 \\
 59.6 &amp; 44.3 &amp; 41.1 &amp; 22.8 &amp; 17.2 \\
 64.5 &amp; 47.5 &amp; 29.8 &amp; 19.2 &amp; 7.8 \\
 59.3 &amp; 49.5 &amp; 38.3 &amp; 20.6 &amp; 10.5 \\
 58.6 &amp; 48.5 &amp; 40.2 &amp; 29.2 &amp; 17.8 \\
 64.6 &amp; 50.4 &amp; 38.5 &amp; 24.1 &amp; 22.1 \\
 50.9 &amp; 35.2 &amp; 30.2 &amp; 22.6 &amp; 22.6 \\
 56.2 &amp; 49.9 &amp; 27.0 &amp; 32.7 &amp; 16.8 \\
 52.3 &amp; 42.6 &amp; 40.0 &amp; 24.4 &amp; 15.9 \\
 62.8 &amp; 41.6 &amp; 33.9 &amp; 29.6 &amp; 8.8 
\end{array}
\end{array}
\]</span></p>
<p>El contrast que es volia realitzar era:</p>
<ul>
<li><p><span class="math inline">\(H_0\)</span>: El percentatge mitjà d’increment del volum cel·lular d’un cultiu de <em>P. fragi</em> al cap d’una hora és el mateix per a totes les pressions de CO<sub>2</sub> considerades.</p></li>
<li><p><span class="math inline">\(H_1\)</span>: El percentatge mitjà d’increment del volum cel·lular d’un cultiu de <em>P. fragi</em> al cap d’una hora depèn de la pressió de CO<sub>2</sub>.</p>
<p>que en el nostre experiment traduïm en:</p>
<p><span class="math inline">\(H_1\)</span>: No és veritat que el percentatge mitjà d’increment del volum cel·lular d’un cultiu de <em>P. fragi</em> al cap d’una hora sigui el mateix per a totes les pressions de CO<sub>2</sub> considerades.</p>
<p>És a dir:</p>
<p><span class="math inline">\(H_1\)</span>: Hi ha almenys dues d’aquestes pressions de CO<sub>2</sub> sota les quals els percentatges mitjans d’increment del volum cel·lular d’un cultiu de <em>P. fragi</em> al cap d’una hora són diferents.</p></li>
</ul>

<div class="rmdimportant">
Recordau que el contrari de “totes les mitjanes són iguals” és <strong>hi ha almenys dues mitjanes que són diferents</strong>.
</div>
<p>Aquest experiment és un cas particular del problema següent:</p>
<blockquote>
<p>Tenim <span class="math inline">\(k&gt;2\)</span> poblacions. Volem decidir si la mitjana d’una certa variable aleatòria és la mateixa a totes aquestes poblacions, o no.</p>
</blockquote>

<div class="rmdcaution">
<p>Usualment, aquestes <span class="math inline">\(k\)</span> poblacions seran subpoblacions d’una única població, definides pels nivells d’un o diversos factors. Per exemple, a l’estudi del creixement del <em>P. fragi</em>, les poblacions que consideram estan totes formades per cultius d’aquest bacteri, i es diferencien en la pressió de CO<sub>2</sub>.</p>
En el context d’aquest tipus d’estudis, a aquests nivells els anomenam <strong>tractaments</strong>. És a dir, tornant a l’exemple anterior, els nivells de pressió de CO<sub>2</sub> serien els tractaments que analitzam en aquest estudi.
</div>
<p>Per simplificar el llenguatge, sovint cometrem l’abús d’identificar una subpoblació d’aquestes amb el nivell, o tractament, que la defineix. D’aquesta manera, parlarem per exemple de</p>
<blockquote>
<p><em>la mitjana poblacional del tractament “0.29 atmosferes”</em></p>
</blockquote>
<p>per referir-nos a la mitjana de la població definida pel tractament “0.29 atmosferes”, és a dir, al percentatge mitjà d’increment del volum cel·lular en una hora d’un cultiu de <em>P. fragi</em> a 0.29 atmosferes de pressió de CO<sub>2</sub>. I parlarem de</p>
<blockquote>
<p><em>la mitjana mostral del tractament “0.29 atmosferes”</em></p>
</blockquote>
<p>per referir-nos a la mitjana de la nostra mostra de la població definida pel tractament “0.29 atmosferes”, és a dir, a la mitjana mostral dels percentatges d’increment del volum cel·lular dels cultius de <em>P. fragi</em> a 0.29 atmosferes obtinguts en aquest experiment.</p>
<p>Si diem <span class="math inline">\(\mu_1,\ldots,\mu_k\)</span> a les mitjanes d’aquesta variable en aquestes <span class="math inline">\(k\)</span> poblacions, la pregunta que ens plantejam correspon al contrast:
<span class="math display">\[
\left\{
\begin{array}{l}
H_0 : \mu_1 =\mu_2 =\cdots =\mu_k \\
H_1 : \text{Hi ha  }i,j\text{ tals que }  \mu_i \neq\mu_j
\end{array}
\right.
\]</span></p>
<p>Aleshores, prendrem una mostra aleatòria de cada població (una mostra <strong>estratificada</strong> de la població total, recordau?), i a partir d’aquestes mostres decidirem aquest contrast.</p>

<div class="example">
<p><span id="exm:C02seq" class="example"><strong>Exemple 10.2  </strong></span>Continuem amb el nostre Exemple <a href="chap-ANOVA.html#exm:CO2">10.1</a>. Per a cada <span class="math inline">\(\ell=0,0.08,0.29,0.50,0.86\)</span>, consideram la variable aleatòria</p>
</div>
<ul>
<li><span class="math inline">\(X_\ell\)</span>: “Prenc un cultiu de <em>P. fragi</em> a <span class="math inline">\(\ell\)</span> atmosferes de CO<sub>2</sub> i mesur el percentatge de creixement del seu volum cel·lular en una hora”.</li>
</ul>
<p>Volem realitzar el contrast
<span class="math display">\[
\left\{
\begin{array}{l}
H_0 : \mu_0=\mu_{0.08}=\mu_{0.29}=\mu_{0.50}=\mu_{0.86} \\
H_1 : \text{No totes aquestes mitjanes són iguals}
\end{array}
\right.
\]</span></p>
<p>En temes anteriors, per comparar les mitjanes d’una variable sobre dues poblacions, calculàvem les mitjanes de dues mostres i les comparàvem. Per comparar les mitjanes de <span class="math inline">\(k\geqslant 3\)</span> poblacions, podríem fer-ho per parelles, però hauríem de fer <span class="math inline">\(\binom{k}{2}\)</span> contrastos i això augmenta la probabilitat d’error. A més, les hem de comparar totes amb totes, perquè podria passar que no poguéssim rebutjar que <span class="math inline">\(\mu_1= \mu_2\)</span> ni que <span class="math inline">\(\mu_2= \mu_3\)</span> però en canvi sí que poguéssim rebutjar que <span class="math inline">\(\mu_1= \mu_3\)</span>.</p>
<p>El que volem és un test que ens digui en un sol pas si totes les mitjanes són iguals o no; si concloem que no, després ja cercarem quines mitjanes són diferents si volem saber-ho.</p>
<p>La tècnica més usual per efectuar aquest tipus de contrast és l’<strong>Anàlisi de la Variància</strong> o <strong>ANOVA</strong> (de l’anglès <em>ANalysis Of VAriance</em>; en llibres en castellà o català de vegades hi trobareu el terme <em>ANDEVA</em>, d’<em>ANàlisi DE la VAriància</em>, però no el farem servir, perquè trobam que sona més a marca de producte d’higiene íntima femenina que a tècnica estadística seriosa). L’ANOVA és tot un món, i té moltes variants segons el disseny de l’experiment que ha produït les dades:</p>
<ul>
<li><p>Segons quants factors emprem per separar la població en subpoblacions</p></li>
<li><p>Segons com triem els nivells dels factors</p></li>
<li><p>Segons com prenguem les mostres</p></li>
</ul>
<p>En aquest curs veurem els tres dissenys més bàsics:</p>
<ul>
<li><p>L’<strong>ANOVA d’1 via</strong>, que generalitza el test t de dues mitjanes a partir de dues mostres independents a <span class="math inline">\(k\)</span> mitjanes de poblacions definides pels nivells d’<strong>un únic factor</strong>, a partir de <span class="math inline">\(k\)</span> mostres <strong>independents</strong>.</p></li>
<li><p>L’<strong>ANOVA de blocs</strong>, que generalitza el test t de dues mitjanes a partir de dues mostres aparellades a <span class="math inline">\(k\)</span> mitjanes de poblacions definides pels nivells d’un <strong>únic factor</strong>, a partir de <span class="math inline">\(k\)</span> mostres <strong>aparellades</strong>.</p></li>
<li><p>L’<strong>ANOVA de 2 vies</strong>, que generalitza el test t de dues mitjanes a partir de dues mostres independents a més de dues mitjanes de poblacions definides per les combinacions de nivells de <strong>dos factors</strong>, a partir de mostres <strong>independents</strong>.</p></li>
</ul>

<div class="rmdnote">
Recordau que en català “Anàlisi” és femení, mentre que en castellà “Análisis” és masculí. Per tant en català diem “una ANOVA” i en castellà “un ANOVA”.
</div>

<div class="rmdromans">
<strong>ANO…VA?</strong> Que no volíem comparar mitjanes? Idò com és que analitzam variàncies?
</div>
<p>L’estratègia per comparar les mitjanes de 3 o més poblacions serà fixar-nos en tres fonts de variabilitat, o dispersió, de les dades:</p>
<ul>
<li><p>La <em>variabilitat total de les dades</em></p></li>
<li><p>La <em>variabilitat dins cada mostra</em></p></li>
<li><p>La <em>variabilitat de les mitjanes mostrals</em></p></li>
</ul>
<p>La idea és que si les mitjanes mostrals tenen molta variabilitat, ho prendrem com a senyal que les mitjanes poblacionals no poden ser totes iguals. Com ho mesurarem?</p>
<p>Amb definicions adients de les “variabilitats”, resultarà que</p>
<blockquote>
<p>La <em>variabilitat total de les dades</em> és igual a la suma de la <em>variabilitat de les mitjanes mostrals</em> més la <em>suma de les variabilitats dins les mostres</em>.</p>
</blockquote>
<p>Aleshores, la idea bàsica anterior es tradueix en:</p>

<div class="rmdrecordau">
Si la variabilitat total de les dades és molt més gran que la suma de les variabilitats dins les mostres, hi haurà una gran variabilitat de les mitjanes mostrals, i ho prendrem com a senyal que les mitjanes poblacionals no són iguals.
</div>
<p>Per exemple, si teniu molta variabilitat global</p>
<p><img src="Bioestadistica-II_files/figure-html/FD11.png" width="60%" style="display: block; margin: auto;" /></p>
<p>i molt poca dins cada tractament</p>
<p><img src="Bioestadistica-II_files/figure-html/FD12.png" width="60%" style="display: block; margin: auto;" /></p>
<p>serà evidència que les mitjanes poblacionals no són iguals.</p>
<p>Si en canvi teniu molta variabilitat global</p>
<p><img src="Bioestadistica-II_files/figure-html/FD21.png" width="60%" style="display: block; margin: auto;" /></p>
<p>però també molta dins cada tractament</p>
<p><img src="Bioestadistica-II_files/figure-html/FD22.png" width="60%" style="display: block; margin: auto;" /></p>
<p>no obtendrem evidència per rebutjar que les mitjanes poblacionals siguin totes tres iguals.</p>
<p>La pregunta és ara com quantificam aquestes variabilitats i com definim què significa “molt més gran”. Es tractarà de trobar un estadístic de contrast del qual en coneguem la distribució mostral si la hipòtesi nul·la és vertadera i que esperem que prengui un valor petit si la hipòtesi nul·la és vertadera.</p>
</div>
<div id="anova-d1-via" class="section level2" number="10.2">
<h2><span class="header-section-number">10.2</span> ANOVA d’1 via</h2>
<div id="contrast-bàsic" class="section level3" number="10.2.1">
<h3><span class="header-section-number">10.2.1</span> Contrast bàsic</h3>
<p>La situació és la següent. Tenim una variable aleatòria <span class="math inline">\(X\)</span> i un (únic) factor amb <span class="math inline">\(k\geqslant 3\)</span> nivells (o <strong>tractaments</strong>). Aquests nivells classifiquen la població en <span class="math inline">\(k\)</span> subpoblacions. Diguem <span class="math inline">\(\mu_i\)</span> a la mitjana de <span class="math inline">\(X\)</span> en els individus del nivell <span class="math inline">\(i\)</span>-èsim. Volem comparar aquestes mitjanes <span class="math inline">\(\mu_1\)</span>,…,<span class="math inline">\(\mu_k\)</span> i més en concret decidir si són totes iguals o no.</p>
<p>En un <strong>experiment de disseny d’ANOVA d’1 via</strong> (en anglès, <em>1 way</em>; el motiu d’aquest nom és que empram una única “manera” de classificar la població, en anglès <em>one way</em> que també es tradueix per “una via”, i així ha quedat el nom en les nostres llengües):</p>
<ul>
<li><p>S’empra un factor amb <span class="math inline">\(k&gt;2\)</span> nivells per classificar una població en subpoblacions.</p></li>
<li><p>Es pren una m.a.s. de cada subpoblació, de manera independent les unes de les altres, i es mesura la variable d’interès <span class="math inline">\(X\)</span> sobre tots els subjectes de les mostres.</p></li>
</ul>
<p>Per exemple, l’experiment del nostre Exemple <a href="chap-ANOVA.html#exm:CO2">10.1</a> té disseny d’ANOVA d’1 via:</p>
<ul>
<li><p>La variable <span class="math inline">\(X\)</span> assigna a cada cultiu de <em>P. fragi</em> el seu percentatge d’increment cel·lular en una hora.</p></li>
<li><p>El factor emprat per classificar la població és la pressió de CO<sub>2</sub>: es consideren 5 nivells diferents, sota els quals es realitzen els cultius.</p></li>
<li><p>Cada <span class="math inline">\(X_\ell\)</span> de l’Exemple <a href="chap-ANOVA.html#exm:C02seq">10.2</a> és la restricció de <span class="math inline">\(X\)</span> a la subpoblació definida pel nivell <span class="math inline">\(\ell\)</span>: els cultius realitzats a <span class="math inline">\(\ell\)</span> atmosferes de CO<sub>2</sub>.</p></li>
<li><p>S’hi ha pres una m.a.s. per a cada nivell de pressió <span class="math inline">\(\ell\)</span>, i de manera independent les unes de les altres.</p></li>
</ul>
<p>Ja que hi som, anam a organitzar les dades d’aquest experiment de manera adient. Les emmagatzemarem en un <em>dataframe</em> que anomenarem <code>CO2</code> amb dues variables:</p>
<ul>
<li><strong>Inc</strong>: Percentatge d’increment de la massa cel·lular (al cap d’una hora); una variable numèrica</li>
<li><strong>Pre</strong>: Nivell de pressió, com a <strong>factor</strong></li>
</ul>

<div class="rmdimportant">
De cara a fer-ho amb R, és important que tengueu present que la variable que defineix les subpoblacions, en aquest cas la que dóna el nivell de pressió de CO<sub>2</sub>, ha de ser un factor o, almenys, una vector de paraules. <strong>No pot ser un vector numéric.</strong>
</div>
<p>Les dades eren:</p>
<p><span class="math display">\[
\begin{array}{c}
\text{Pressió de CO${}_2$ (en atmosferes)}\\
\begin{array}{rrrrr}
 0.0 &amp; 0.08 &amp; 0.29 &amp; 0.50 &amp; 0.86 \\\hline
 62.6 &amp; 50.9 &amp; 45.5 &amp; 29.5 &amp; 24.9 \\
 59.6 &amp; 44.3 &amp; 41.1 &amp; 22.8 &amp; 17.2 \\
 64.5 &amp; 47.5 &amp; 29.8 &amp; 19.2 &amp; 7.8 \\
 59.3 &amp; 49.5 &amp; 38.3 &amp; 20.6 &amp; 10.5 \\
 58.6 &amp; 48.5 &amp; 40.2 &amp; 29.2 &amp; 17.8 \\
 64.6 &amp; 50.4 &amp; 38.5 &amp; 24.1 &amp; 22.1 \\
 50.9 &amp; 35.2 &amp; 30.2 &amp; 22.6 &amp; 22.6 \\
 56.2 &amp; 49.9 &amp; 27.0 &amp; 32.7 &amp; 16.8 \\
 52.3 &amp; 42.6 &amp; 40.0 &amp; 24.4 &amp; 15.9 \\
 62.8 &amp; 41.6 &amp; 33.9 &amp; 29.6 &amp; 8.8 
\end{array}
\end{array}
\]</span></p>
<p>Entrarem els increments per fileres (és com és més fàcil copiar-los i aferrar-los), per tant el factor <strong>Pre</strong> ha d’estar format per 10 còpies consecutives del vector (0.0,0.08,0.29,0.50,0.86).</p>
<div class="sourceCode" id="cb500"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb500-1"><a href="chap-ANOVA.html#cb500-1" aria-hidden="true" tabindex="-1"></a>Inc<span class="ot">=</span><span class="fu">c</span>(<span class="fl">62.6</span>,<span class="fl">50.9</span>,<span class="fl">45.5</span>,<span class="fl">29.5</span>,<span class="fl">24.9</span>,<span class="fl">59.6</span>,<span class="fl">44.3</span>,<span class="fl">41.1</span>,<span class="fl">22.8</span>,<span class="fl">17.2</span>,<span class="fl">64.5</span>,</span>
<span id="cb500-2"><a href="chap-ANOVA.html#cb500-2" aria-hidden="true" tabindex="-1"></a>      <span class="fl">47.5</span>,<span class="fl">29.8</span>,<span class="fl">19.2</span>,<span class="fl">7.8</span>,<span class="fl">59.3</span>,<span class="fl">49.5</span>,<span class="fl">38.3</span>,<span class="fl">20.6</span>,<span class="fl">10.5</span>,<span class="fl">58.6</span>,<span class="fl">48.5</span>,</span>
<span id="cb500-3"><a href="chap-ANOVA.html#cb500-3" aria-hidden="true" tabindex="-1"></a>      <span class="fl">40.2</span>,<span class="fl">29.2</span>,<span class="fl">17.8</span>,<span class="fl">64.6</span>,<span class="fl">50.4</span>,<span class="fl">38.5</span>,<span class="fl">24.1</span>,<span class="fl">22.1</span>,<span class="fl">50.9</span>,<span class="fl">35.2</span>,<span class="fl">30.2</span>,</span>
<span id="cb500-4"><a href="chap-ANOVA.html#cb500-4" aria-hidden="true" tabindex="-1"></a>      <span class="fl">22.6</span>,<span class="fl">22.6</span>,<span class="fl">56.2</span>,<span class="fl">49.9</span>,<span class="fl">27.0</span>,<span class="fl">32.7</span>,<span class="fl">16.8</span>,<span class="fl">52.3</span>,<span class="fl">42.6</span>,<span class="fl">40.0</span>,<span class="fl">24.4</span>,</span>
<span id="cb500-5"><a href="chap-ANOVA.html#cb500-5" aria-hidden="true" tabindex="-1"></a>      <span class="fl">15.9</span>,<span class="fl">62.8</span>,<span class="fl">41.6</span>,<span class="fl">33.9</span>,<span class="fl">29.6</span>,<span class="fl">8.8</span>)</span>
<span id="cb500-6"><a href="chap-ANOVA.html#cb500-6" aria-hidden="true" tabindex="-1"></a>Pre<span class="ot">=</span><span class="fu">as.factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;0.0&quot;</span>,<span class="st">&quot;0.08&quot;</span>,<span class="st">&quot;0.29&quot;</span>,<span class="st">&quot;0.50&quot;</span>,<span class="st">&quot;0.86&quot;</span>), <span class="at">times=</span><span class="dv">10</span>))</span>
<span id="cb500-7"><a href="chap-ANOVA.html#cb500-7" aria-hidden="true" tabindex="-1"></a>CO2<span class="ot">=</span><span class="fu">data.frame</span>(Inc,Pre)</span>
<span id="cb500-8"><a href="chap-ANOVA.html#cb500-8" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(CO2)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:	50 obs. of  2 variables:
##  $ Inc: num  62.6 50.9 45.5 29.5 24.9 59.6 44.3 41.1 22.8 17.2 ...
##  $ Pre: Factor w/ 5 levels &quot;0.0&quot;,&quot;0.08&quot;,&quot;0.29&quot;,..: 1 2 3 4 5 1 2 3 4 5 ...</code></pre>
<div class="sourceCode" id="cb502"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb502-1"><a href="chap-ANOVA.html#cb502-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(CO2,<span class="dv">7</span>)</span></code></pre></div>
<pre><code>##    Inc  Pre
## 1 62.6  0.0
## 2 50.9 0.08
## 3 45.5 0.29
## 4 29.5 0.50
## 5 24.9 0.86
## 6 59.6  0.0
## 7 44.3 0.08</code></pre>
<p>Veiem que hem definit del <em>dataframe</em> com toca. Donem ara una ullada a les dades. Primer un diagrama de punts de cada nivell de CO<sub>2</sub> (amb només 10 valors per nivell, és més adient dibuixar-los tots que resumir-los en diagrames de caixes):</p>
<div class="sourceCode" id="cb504"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb504-1"><a href="chap-ANOVA.html#cb504-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stripchart</span>(Inc<span class="sc">~</span>Pre,<span class="at">data=</span>CO2,<span class="at">xlab=</span><span class="st">&quot;Pressions&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Increment&quot;</span>,<span class="at">method=</span><span class="st">&quot;stack&quot;</span>,</span>
<span id="cb504-2"><a href="chap-ANOVA.html#cb504-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">vertical=</span><span class="cn">TRUE</span>,<span class="at">pch=</span><span class="dv">20</span>,<span class="at">cex=</span><span class="fl">0.75</span>)</span></code></pre></div>
<p><img src="Bioestadistica-II_files/figure-html/unnamed-chunk-633-1.png" width="50%" style="display: block; margin: auto;" /></p>
<p>I ara un que mostri la variabilitat de les dades i les mitjanes com els del final de la secció anterior. Aquest gràfic normalment no el dibuixarem, simplement és per comparar-lo amb aquells gràfics. De totes formes, donam el codi per si qualque dia voleu produir un gràfic d’aquest estil.</p>
<div class="sourceCode" id="cb505"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb505-1"><a href="chap-ANOVA.html#cb505-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Els paràmetres generals</span></span>
<span id="cb505-2"><a href="chap-ANOVA.html#cb505-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>,<span class="fu">c</span>(CO2<span class="sc">$</span>Inc[CO2<span class="sc">$</span>Pre<span class="sc">==</span><span class="st">&quot;0.0&quot;</span>],CO2<span class="sc">$</span>Inc[CO2<span class="sc">$</span>Pre<span class="sc">==</span><span class="st">&quot;0.08&quot;</span>],CO2<span class="sc">$</span>Inc[CO2<span class="sc">$</span>Pre<span class="sc">==</span><span class="st">&quot;0.29&quot;</span>],CO2<span class="sc">$</span>Inc[CO2<span class="sc">$</span>Pre<span class="sc">==</span><span class="st">&quot;0.50&quot;</span>],CO2<span class="sc">$</span>Inc[CO2<span class="sc">$</span>Pre<span class="sc">==</span><span class="st">&quot;0.86&quot;</span>]),<span class="at">type=</span><span class="st">&quot;n&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Número del cultiu&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Increment&quot;</span>)</span>
<span id="cb505-3"><a href="chap-ANOVA.html#cb505-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Els punts</span></span>
<span id="cb505-4"><a href="chap-ANOVA.html#cb505-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,CO2<span class="sc">$</span>Inc[CO2<span class="sc">$</span>Pre<span class="sc">==</span><span class="st">&quot;0.0&quot;</span>],<span class="at">pch=</span><span class="dv">16</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb505-5"><a href="chap-ANOVA.html#cb505-5" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="dv">11</span><span class="sc">:</span><span class="dv">20</span>,CO2<span class="sc">$</span>Inc[CO2<span class="sc">$</span>Pre<span class="sc">==</span><span class="st">&quot;0.08&quot;</span>],<span class="at">pch=</span><span class="dv">15</span>,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb505-6"><a href="chap-ANOVA.html#cb505-6" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="dv">21</span><span class="sc">:</span><span class="dv">30</span>,CO2<span class="sc">$</span>Inc[CO2<span class="sc">$</span>Pre<span class="sc">==</span><span class="st">&quot;0.29&quot;</span>],<span class="at">pch=</span><span class="dv">17</span>,<span class="at">col=</span><span class="st">&quot;green&quot;</span>)</span>
<span id="cb505-7"><a href="chap-ANOVA.html#cb505-7" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="dv">31</span><span class="sc">:</span><span class="dv">40</span>,CO2<span class="sc">$</span>Inc[CO2<span class="sc">$</span>Pre<span class="sc">==</span><span class="st">&quot;0.50&quot;</span>],<span class="at">pch=</span><span class="dv">19</span>,<span class="at">col=</span><span class="st">&quot;brown2&quot;</span>)</span>
<span id="cb505-8"><a href="chap-ANOVA.html#cb505-8" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="dv">41</span><span class="sc">:</span><span class="dv">50</span>,CO2<span class="sc">$</span>Inc[CO2<span class="sc">$</span>Pre<span class="sc">==</span><span class="st">&quot;0.86&quot;</span>],<span class="at">pch=</span><span class="dv">18</span>,<span class="at">col=</span><span class="st">&quot;brown&quot;</span>)</span>
<span id="cb505-9"><a href="chap-ANOVA.html#cb505-9" aria-hidden="true" tabindex="-1"></a><span class="co"># La mitjana mostral global</span></span>
<span id="cb505-10"><a href="chap-ANOVA.html#cb505-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">50</span>),<span class="fu">c</span>(<span class="fu">mean</span>(CO2<span class="sc">$</span>Inc),<span class="fu">mean</span>(CO2<span class="sc">$</span>Inc)),<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb505-11"><a href="chap-ANOVA.html#cb505-11" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">5</span>,<span class="dv">34</span>,<span class="st">&quot;Mitjana global&quot;</span>,<span class="at">cex=</span><span class="fl">0.75</span>)</span>
<span id="cb505-12"><a href="chap-ANOVA.html#cb505-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Les mitjanes mostrals de les mostres</span></span>
<span id="cb505-13"><a href="chap-ANOVA.html#cb505-13" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>),<span class="fu">c</span>(<span class="fu">mean</span>(CO2<span class="sc">$</span>Inc[CO2<span class="sc">$</span>Pre<span class="sc">==</span><span class="st">&quot;0.0&quot;</span>]),<span class="fu">mean</span>(CO2<span class="sc">$</span>Inc[CO2<span class="sc">$</span>Pre<span class="sc">==</span><span class="st">&quot;0.0&quot;</span>])),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb505-14"><a href="chap-ANOVA.html#cb505-14" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">20</span>),<span class="fu">c</span>(<span class="fu">mean</span>(CO2<span class="sc">$</span>Inc[CO2<span class="sc">$</span>Pre<span class="sc">==</span><span class="st">&quot;0.08&quot;</span>]),<span class="fu">mean</span>(CO2<span class="sc">$</span>Inc[CO2<span class="sc">$</span>Pre<span class="sc">==</span><span class="st">&quot;0.08&quot;</span>])),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb505-15"><a href="chap-ANOVA.html#cb505-15" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">30</span>),<span class="fu">c</span>(<span class="fu">mean</span>(CO2<span class="sc">$</span>Inc[CO2<span class="sc">$</span>Pre<span class="sc">==</span><span class="st">&quot;0.29&quot;</span>]),<span class="fu">mean</span>(CO2<span class="sc">$</span>Inc[CO2<span class="sc">$</span>Pre<span class="sc">==</span><span class="st">&quot;0.29&quot;</span>])),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;green&quot;</span>)</span>
<span id="cb505-16"><a href="chap-ANOVA.html#cb505-16" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(<span class="dv">30</span>,<span class="dv">40</span>),<span class="fu">c</span>(<span class="fu">mean</span>(CO2<span class="sc">$</span>Inc[CO2<span class="sc">$</span>Pre<span class="sc">==</span><span class="st">&quot;0.50&quot;</span>]),<span class="fu">mean</span>(CO2<span class="sc">$</span>Inc[CO2<span class="sc">$</span>Pre<span class="sc">==</span><span class="st">&quot;0.50&quot;</span>])),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;brown2&quot;</span>)</span>
<span id="cb505-17"><a href="chap-ANOVA.html#cb505-17" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(<span class="dv">40</span>,<span class="dv">50</span>),<span class="fu">c</span>(<span class="fu">mean</span>(CO2<span class="sc">$</span>Inc[CO2<span class="sc">$</span>Pre<span class="sc">==</span><span class="st">&quot;0.86&quot;</span>]),<span class="fu">mean</span>(CO2<span class="sc">$</span>Inc[CO2<span class="sc">$</span>Pre<span class="sc">==</span><span class="st">&quot;0.86&quot;</span>])),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;brown&quot;</span>)</span>
<span id="cb505-18"><a href="chap-ANOVA.html#cb505-18" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">20</span>,<span class="fu">mean</span>(CO2<span class="sc">$</span>Inc[CO2<span class="sc">$</span>Pre<span class="sc">==</span><span class="st">&quot;0.0&quot;</span>]),<span class="st">&quot;Mitjana del nivell 0.0&quot;</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">cex=</span><span class="fl">0.75</span>)</span>
<span id="cb505-19"><a href="chap-ANOVA.html#cb505-19" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">30</span>,<span class="fu">mean</span>(CO2<span class="sc">$</span>Inc[CO2<span class="sc">$</span>Pre<span class="sc">==</span><span class="st">&quot;0.08&quot;</span>]),<span class="st">&quot;Mitjana del nivell 0.083&quot;</span>,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>,<span class="at">cex=</span><span class="fl">0.75</span>)</span>
<span id="cb505-20"><a href="chap-ANOVA.html#cb505-20" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">40</span>,<span class="fu">mean</span>(CO2<span class="sc">$</span>Inc[CO2<span class="sc">$</span>Pre<span class="sc">==</span><span class="st">&quot;0.29&quot;</span>]<span class="sc">+</span><span class="dv">2</span>),<span class="st">&quot;Mitjana del nivell 0.29&quot;</span>,<span class="at">col=</span><span class="st">&quot;green&quot;</span>,<span class="at">cex=</span><span class="fl">0.75</span>)</span>
<span id="cb505-21"><a href="chap-ANOVA.html#cb505-21" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">20</span>,<span class="fu">mean</span>(CO2<span class="sc">$</span>Inc[CO2<span class="sc">$</span>Pre<span class="sc">==</span><span class="st">&quot;0.50&quot;</span>]),<span class="st">&quot;Mitjana del nivell 0.50&quot;</span>,<span class="at">col=</span><span class="st">&quot;brown2&quot;</span>,<span class="at">cex=</span><span class="fl">0.75</span>)</span>
<span id="cb505-22"><a href="chap-ANOVA.html#cb505-22" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">30</span>,<span class="fu">mean</span>(CO2<span class="sc">$</span>Inc[CO2<span class="sc">$</span>Pre<span class="sc">==</span><span class="st">&quot;0.86&quot;</span>]),<span class="st">&quot;Mitjana del nivell 0.86&quot;</span>,<span class="at">col=</span><span class="st">&quot;brown&quot;</span>,<span class="at">cex=</span><span class="fl">0.75</span>)</span></code></pre></div>
<p><img src="Bioestadistica-II_files/figure-html/unnamed-chunk-634-1.png" width="50%" style="display: block; margin: auto;" /></p>
<p>Veiem que hi ha una gran dispersió dins la mostra completa, no massa dispersió dins cada mostra per nivell, i les mitjanes mostrals per nivells són bastant diferents. Naturalment, fins que no fem una anàlisi estadística no sabrem si aquestes variabilitats i diferències són estadísticament significatives o no.</p>
<p>En un experiment amb disseny d’ANOVA d’1 via, disposarem les dades en una taula com la de l’Exemple anterior, amb les columnes representant els tractaments:
<span class="math display">\[
\begin{array}{c}
\text{Tractaments}\\
\begin{array}{cccc}
 1 &amp; 2 &amp;\ldots &amp; k \\\hline
 X_{11} &amp; X_{21} &amp; \cdots &amp; X_{k1} \\
 X_{12} &amp; X_{22} &amp; \cdots &amp; X_{k2} \\
 \vdots &amp; \vdots &amp; \vdots &amp; \vdots \\
\vdots &amp; \vdots &amp; \vdots &amp; X_{kn_k} \\
X_{1n_1}  &amp; \vdots &amp; \vdots &amp;  \\
 &amp; X_{2n_2} &amp;  &amp;  \\\hline
\end{array}
\end{array}
\]</span></p>
<p>on</p>
<ul>
<li><p>Cada <span class="math inline">\(n_i\)</span> és la mida de la mostra del tractament <span class="math inline">\(i\)</span>; com hem intentat representar a la taula, aquestes <span class="math inline">\(n_i\)</span> <strong>no tenen perquè ser totes iguals</strong> (però és convenient que ho siguin, perquè la potència d’un contrast ANOVA depèn del mínim d’aquestes <span class="math inline">\(n_i\)</span>).</p></li>
<li><p><span class="math inline">\(X_{ij}\)</span> és el valor de la variable sota estudi al subjecte <span class="math inline">\(j\)</span> del tractament <span class="math inline">\(i\)</span>.</p></li>
<li><p><span class="math inline">\(N=n_1+\cdots+n_k\)</span> és la mida total de la mostra.</p></li>
</ul>

<div class="rmdcaution">
<p><strong>ALERTA!</strong> Aquestes notacions no són les usuals a les matrius o a les taules de dades. Aquí, a <span class="math inline">\(X_{ij}\)</span>, <span class="math inline">\(i\)</span> hi indica la columna i <span class="math inline">\(j\)</span> la filera.</p>
<p>Observau també que a la taula de dades anterior no és veritat que cada filera representi un individu: en realitat cada columna pot tenir una alçada diferent. En aquesta taula cada <span class="math inline">\(X_{ij}\)</span> representa un individu diferent.</p>
</div>
<p>Perquè es pugui realitzar un contrast ANOVA d’1 via, <strong>s’han de satisfer les condicions següents</strong>:</p>
<ul>
<li><p>Les <span class="math inline">\(k\)</span> mostres han de ser m.a.s. independents extretes de <span class="math inline">\(k\)</span> poblacions específiques, amb mitjanes <span class="math inline">\(\mu_1,\ldots,\mu_k\)</span></p></li>
<li><p><span class="math inline">\(N\geqslant k+1\)</span> (alguna mostra ha de tenir més d’un subjecte)</p></li>
<li><p>Cadascuna de les <span class="math inline">\(k\)</span> poblacions ha de seguir una llei normal</p></li>
<li><p><strong>Homogeneïtat de les variàncies</strong>, o <strong>homocedasticitat</strong>: Totes aquestes poblacions han de tenir la mateixa variància, que indicarem amb <span class="math inline">\(\sigma^2\)</span></p></li>
</ul>

<div class="rmdrecordau">
<strong>No basten mostres grans</strong>. Aquí no hi juga cap paper el Teorema Central del Límit. Però, per sort, les conclusions d’una ANOVA són bastant robustes encara que falli la condició de normalitat de les subpoblacions. En canvi són molt sensibles a l’<strong>heterocedasticitat</strong> (el contrari d’homocedasticitat; “hetero” indica el contrari de “homo”).
</div>
<p>Donades diverses variables, hi tenim <strong>homocedasticitat</strong> quan totes tenen la mateixa variància, i <strong>heterocedasticitat</strong> quan no totes tenen la mateixa variància. Fixau-vos que ens referim a les variàncies de les poblacions, no de les mostres. Per exemple, les tres mostres del gràfic de l’esquerra següent provenen de variables normals amb la mateixa variància, representades al gràfic de la dreta: hi ha homocedasticitat:</p>
<p><img src="Bioestadistica-II_files/figure-html/unnamed-chunk-637-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>En canvi, dues de les mostres del gràfic següent provenen de variables normals amb la mateixa variància, mentre que la tercera prové d’una normal amb una variància molt més gran: hi ha heterocedasticitat:</p>
<p><img src="Bioestadistica-II_files/figure-html/unnamed-chunk-638-1.png" width="90%" style="display: block; margin: auto;" /></p>

<div class="rmdimportant">
L’homocedasticitat <strong>no és que les mostres dels tractaments tenguin la mateixa variància</strong>, sinó que <strong>els tractaments tenguin la mateixa variància poblacional</strong>.
</div>
<p>Diguem <span class="math inline">\(\mu\)</span> a la mitjana poblacional de la població global (sense tenir en compte la classificació donada pels tractaments).
Recordau que la hipòtesi nul·la del contrast que volem realitzar és
<span class="math display">\[
H_0: \mu_1=\cdots=\mu_k
\]</span>
Si és vertadera, aleshores en realitat passarà que
<span class="math display">\[
\mu_1=\cdots=\mu_k=\mu
\]</span>
perquè si totes les subpoblacions tenen la mateixa mitjana, aquesta mitjana comuna serà la mitjana de tota la població.</p>
<p>En aquest tema és el primer cop que tenim ocasió de parlar de <strong>models estadístics</strong>. Informalment, un <strong>model</strong> no és res més que una descripció matemàtica del comportament d’una o vàries variables aleatòries sobre una població. Aquests models inclouen assumpcions sobre la població que poden ser veritat o no, i que si no ho són aleshores les conclusions de l’anàlisi estadística que fem basant-nos en aquest model no tendran cap sentit.</p>
<p>En concret, l’ANOVA d’1 via es basa en el <strong>model</strong> següent: per a cada <span class="math inline">\(i=1,\ldots,k\)</span>,
<span class="math display">\[
X_i=\mu+(\mu_i-\mu)+(X_i-\mu_i)
\]</span>
on:</p>
<ul>
<li><p><span class="math inline">\(X_i\)</span> representa el valor de la variable <span class="math inline">\(X\)</span> sobre un individu del nivell <span class="math inline">\(i\)</span>-èsim.</p></li>
<li><p><span class="math inline">\(\mu_i-\mu\)</span> representa la desviació de la mitjana de <span class="math inline">\(X\)</span> en el nivell <span class="math inline">\(i\)</span>-èsim respecte de la mitjana global <span class="math inline">\(\mu\)</span>; en direm l’<strong>efecte del tractament <span class="math inline">\(i\)</span>-èsim</strong> i representa la contribució al valor de <span class="math inline">\(X\)</span> sobre un individu del nivell <span class="math inline">\(i\)</span>-èsim del fet de pertànyer a aquest nivell.</p></li>
<li><p><span class="math inline">\(X_i-\mu_i\)</span>, la desviació de la variable <span class="math inline">\(X\)</span> sobre un individu del nivell <span class="math inline">\(i\)</span>-èsim respecte de la mitjana d’aquest nivell, <span class="math inline">\(\mu_i\)</span>, representa el component aleatori en una medició concreta de <span class="math inline">\(X\)</span> sobre un individu del nivell <span class="math inline">\(i\)</span>-èsim, és a dir, “la part de la diferència entre <span class="math inline">\(X_{i}\)</span> i <span class="math inline">\(\mu\)</span> que no explica el tractament”; en diem l’<strong>error aleatori</strong>, o el <strong>residu</strong>.</p></li>
</ul>
<p>Fixau-vos que, formalment, la fórmula que descriu aquest model és sempre vertadera: podeu simplificar les <span class="math inline">\(\mu_i\)</span> i les <span class="math inline">\(\mu\)</span> de la dreta. Però el que diu aquest model és que el valor de <span class="math inline">\(X\)</span> sobre un individu és la suma de tres components:</p>
<ul>
<li>La mitjana global</li>
<li>L’efecte del tractament</li>
<li>L’error aleatori</li>
</ul>
<p>i en particular que res més no influeix en el valor de <span class="math inline">\(X\)</span> sobre un individu. Per tant, si això no és cert, és a dir, si aquest valor pot dependre d’altres efectes que no tinguem en compte, el model no és vàlid, i les conclusions de l’ANOVA tampoc.</p>
<p>Passem ara a la mostra amb què volem realitzar el contrast. Siguin:</p>
<ul>
<li><p><span class="math inline">\(\overline{X}_{i}\)</span>: La mitjana mostral de la mostra del tractament <span class="math inline">\(i\)</span>-èsim:
<span class="math display">\[
\overline{X}_{i} =
\frac{\sum_{j=1}^{n_i} X_{ij}}{n_i}
\]</span>
Estima la mitjana <span class="math inline">\(\mu_i\)</span> de la subpoblació definida pel tractament <span class="math inline">\(i\)</span>-èsim.</p></li>
<li><p><span class="math inline">\(\overline{X}\)</span>: La mitjana mostral de tota la mostra:
<span class="math display">\[
\overline{X}=\frac{\sum_{i=1}^k \sum_{j=1}^{n_i} X_{ij}}{N}
\]</span>
Estima la mitjana <span class="math inline">\(\mu\)</span> de la població global.</p></li>
</ul>
<p>Es té la identitat següent:</p>

<div class="theorem">
<p><span id="thm:SS1via" class="theorem"><strong>Teorema 10.1  (Identitat de les sumes de quadrats)  </strong></span><span class="math display">\[
SS_{Total}=SS_{Tr}+SS_E
\]</span>
on</p>
<ul>
<li><p><span class="math inline">\(SS_{Total}=\displaystyle\sum_{i=1}^k\sum_{j=1}^{n_i} (X_{ij}-\overline{X})^2\)</span>; és la <strong>Suma Total de Quadrats</strong>.</p></li>
<li><p><span class="math inline">\(SS_{Tr}=\displaystyle\sum_{i=1}^k n_i(\overline{X}_{i}-\overline{X})^2\)</span>; és la <strong>Suma de Quadrats dels Tractaments</strong>.</p></li>
<li><p><span class="math inline">\(SS_E=\displaystyle\sum_{i=1}^k\sum_{j=1}^{n_i} (X_{ij}-\overline{X}_{i})^2\)</span>; és la <strong>Suma de Quadrats dels Residus</strong> o <strong>dels Errors</strong>.</p></li>
</ul>
</div>
<p>Fixau-vos que</p>
<ul>
<li><p><span class="math inline">\(SS_{Total}\)</span> representa la variabilitat total de les dades: de fet, és el numerador de la variància de la mostra total.</p></li>
<li><p><span class="math inline">\(SS_{Tr}\)</span> representa la variabilitat de les mitjanes mostrals: és el numerador de la variància d’un vector format per <span class="math inline">\(n_1\)</span> còpies de <span class="math inline">\(\overline{X}_1\)</span>, <span class="math inline">\(n_2\)</span> còpies de <span class="math inline">\(\overline{X}_2\)</span>, … i <span class="math inline">\(n_k\)</span> còpies de <span class="math inline">\(\overline{X}_k\)</span>.</p></li>
<li><p><span class="math inline">\(SS_E\)</span> representa la suma de les variabilitats de les dades de la mostra de cada tractament: és la suma dels numeradors de les variàncies de les <span class="math inline">\(k\)</span> mostres dels diferents tractaments.</p></li>
<li><p><span class="math inline">\(SS_{Total}=SS_{Tr}+SS_E\)</span> diu que la variabilitat total de la mostra descompon en la suma de la variabilitat de les mitjanes i la suma de les variabilitats de les mostres de cada tractament.</p></li>
</ul>

<div class="rmdnote">
Amb la terminologia introduïda quan explicàvem el model de l’ANOVA d’1 via, cada <span class="math inline">\(X_{ij}-\overline{X}_i\)</span> estima el <strong>residu</strong>, o <strong>error</strong>, sobre l’individu <span class="math inline">\(j\)</span>-èsim del nivell <span class="math inline">\(i\)</span>-èsim <span class="math inline">\(X_{ij}-\mu_i\)</span>. Per això a <span class="math inline">\(\displaystyle\sum_{i=1}^k\sum_{j=1}^{n_i} (X_{ij}-\overline{X}_{i})^2\)</span> li diem la <em>Suma de Quadrats dels Residus</em> o <em>dels Errors</em>.
</div>

<div class="example">
<span id="exm:unnamed-chunk-641" class="example"><strong>Exemple 10.3  </strong></span>Tornem al nostre Exemple <a href="chap-ANOVA.html#exm:CO2">10.1</a>. Tenim les dades guardades en el <em>dataframe</em> <code>CO2</code>
</div>
<div class="sourceCode" id="cb506"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb506-1"><a href="chap-ANOVA.html#cb506-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(CO2)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:	50 obs. of  2 variables:
##  $ Inc: num  62.6 50.9 45.5 29.5 24.9 59.6 44.3 41.1 22.8 17.2 ...
##  $ Pre: Factor w/ 5 levels &quot;0.0&quot;,&quot;0.08&quot;,&quot;0.29&quot;,..: 1 2 3 4 5 1 2 3 4 5 ...</code></pre>
<p>Aleshores:</p>
<ul>
<li>Les mitjanes mostrals dels tractaments, <span class="math inline">\(\overline{X}_{i}\)</span>, es calculen amb</li>
</ul>
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb508-1"><a href="chap-ANOVA.html#cb508-1" aria-hidden="true" tabindex="-1"></a>mitjanes.tracts<span class="ot">=</span><span class="fu">aggregate</span>(Inc<span class="sc">~</span>Pre,<span class="at">data=</span>CO2,mean)</span>
<span id="cb508-2"><a href="chap-ANOVA.html#cb508-2" aria-hidden="true" tabindex="-1"></a>mitjanes.tracts</span></code></pre></div>
<pre><code>##    Pre   Inc
## 1  0.0 59.14
## 2 0.08 46.04
## 3 0.29 36.45
## 4 0.50 25.47
## 5 0.86 16.44</code></pre>
<ul>
<li>La mitjana mostral global, <span class="math inline">\(\overline{X}\)</span>, és:</li>
</ul>
<div class="sourceCode" id="cb510"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb510-1"><a href="chap-ANOVA.html#cb510-1" aria-hidden="true" tabindex="-1"></a>mitjana.total<span class="ot">=</span><span class="fu">mean</span>(CO2<span class="sc">$</span>Inc)</span>
<span id="cb510-2"><a href="chap-ANOVA.html#cb510-2" aria-hidden="true" tabindex="-1"></a>mitjana.total</span></code></pre></div>
<pre><code>## [1] 36.708</code></pre>
<ul>
<li>La <span class="math inline">\(SS_{Total}=\displaystyle\sum_{i=1}^k\sum_{j=1}^{n_i} (X_{ij}-\overline{X})^2\)</span> és</li>
</ul>
<div class="sourceCode" id="cb512"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb512-1"><a href="chap-ANOVA.html#cb512-1" aria-hidden="true" tabindex="-1"></a>SSTotal<span class="ot">=</span><span class="fu">sum</span>((CO2<span class="sc">$</span>Inc<span class="sc">-</span>mitjana.total)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb512-2"><a href="chap-ANOVA.html#cb512-2" aria-hidden="true" tabindex="-1"></a>SSTotal</span></code></pre></div>
<pre><code>## [1] 12522.36</code></pre>
<ul>
<li>Per calcular
<span class="math display">\[
SS_{Tr}=\displaystyle\sum_{i=1}^k n_i(\overline{X}_{i}-\overline{X})^2
\]</span>
hem d’observar que les mitjanes <span class="math inline">\(\overline{X}_{i}\)</span> formen la variable <strong>Inc</strong> del <em>dataframe</em> <code>mitjanes.tracts</code></li>
</ul>
<div class="sourceCode" id="cb514"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb514-1"><a href="chap-ANOVA.html#cb514-1" aria-hidden="true" tabindex="-1"></a>mitjanes.tracts<span class="sc">$</span>Inc</span></code></pre></div>
<pre><code>## [1] 59.14 46.04 36.45 25.47 16.44</code></pre>
<p>i els <span class="math inline">\(n_i\)</span> són les freqüències absolutes de cada nivell dins la variable <code>CO2$Pre</code></p>
<div class="sourceCode" id="cb516"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb516-1"><a href="chap-ANOVA.html#cb516-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(CO2<span class="sc">$</span>Pre)</span></code></pre></div>
<pre><code>## 
##  0.0 0.08 0.29 0.50 0.86 
##   10   10   10   10   10</code></pre>
<p>Per tant la fórmula que defineix <span class="math inline">\(SS_{Tr}\)</span> se tradueix en</p>
<div class="sourceCode" id="cb518"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb518-1"><a href="chap-ANOVA.html#cb518-1" aria-hidden="true" tabindex="-1"></a>SSTr<span class="ot">=</span><span class="fu">sum</span>(<span class="fu">table</span>(CO2<span class="sc">$</span>Pre)<span class="sc">*</span>(mitjanes.tracts<span class="sc">$</span>Inc<span class="sc">-</span>mitjana.total)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb518-2"><a href="chap-ANOVA.html#cb518-2" aria-hidden="true" tabindex="-1"></a>SSTr</span></code></pre></div>
<pre><code>## [1] 11274.32</code></pre>
<ul>
<li>Per calcular
<span class="math display">\[
SS_E=\displaystyle\sum_{i=1}^k\sum_{j=1}^{n_i} (X_{ij}-\overline{X}_{i})^2
\]</span>
podem fixar-nos que, tal i com hem construït el <em>dataframe</em> <strong>CO2</strong>, les entrades de <code>CO2$Inc</code> que difereixen en un múltiple de 5 són del mateix tractament; per exemple, les entrades que corresponen a pressió 0 són la 1a, la 6a, la 11a etc.; les entrades que corresponen a pressió 0.83 són la 2a, la 7a, la 12a etc.; i així successivament. Per tant, si fem <code>CO2$Inc-mitjanes.tracts$Inc</code>, com que la longitud de <code>CO2$Inc</code> és 10 vegades la de <code>mitjanes.tracts$Inc</code>, el que estarem dient és que a <code>CO2$Inc</code> se li resti un vector format per 10 còpies consecutives de <code>mitjanes.tracts$Inc</code>, i d’aquesta manera justament a cada entrada de <code>CO2$Inc</code> se li restarà l’entrada de <code>mitjanes.tracts$Inc</code> que conté la mitjana del seu tractament. Per tant, <span class="math inline">\(SS_E\)</span> es pot calcular amb</li>
</ul>
<div class="sourceCode" id="cb520"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb520-1"><a href="chap-ANOVA.html#cb520-1" aria-hidden="true" tabindex="-1"></a>SSE<span class="ot">=</span><span class="fu">sum</span>((CO2<span class="sc">$</span>Inc<span class="sc">-</span>mitjanes.tracts<span class="sc">$</span>Inc)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb520-2"><a href="chap-ANOVA.html#cb520-2" aria-hidden="true" tabindex="-1"></a>SSE</span></code></pre></div>
<pre><code>## [1] 1248.038</code></pre>
<p>Si no estau còmodes amb això de restar vectors de longituds una un múltiple de l’altra, el que heu de fer és restar a <code>CO2$Inc</code> un vector format per 10 còpies consecutives de <code>mitjanes.tracts$Inc</code>:</p>
<div class="sourceCode" id="cb522"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb522-1"><a href="chap-ANOVA.html#cb522-1" aria-hidden="true" tabindex="-1"></a>SSEalt<span class="ot">=</span><span class="fu">sum</span>((CO2<span class="sc">$</span>Inc<span class="sc">-</span><span class="fu">rep</span>(mitjanes.tracts<span class="sc">$</span>Inc,<span class="at">times=</span><span class="dv">10</span>))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb522-2"><a href="chap-ANOVA.html#cb522-2" aria-hidden="true" tabindex="-1"></a>SSEalt</span></code></pre></div>
<pre><code>## [1] 1248.038</code></pre>
<p>Comprovem la identitat de les sumes de quadrats:</p>
<div class="sourceCode" id="cb524"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb524-1"><a href="chap-ANOVA.html#cb524-1" aria-hidden="true" tabindex="-1"></a>SSTotal</span></code></pre></div>
<pre><code>## [1] 12522.36</code></pre>
<div class="sourceCode" id="cb526"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb526-1"><a href="chap-ANOVA.html#cb526-1" aria-hidden="true" tabindex="-1"></a>SSTr<span class="sc">+</span>SSE</span></code></pre></div>
<pre><code>## [1] 12522.36</code></pre>
<p>La idea del contrast ANOVA és que</p>
<blockquote>
<p>Rebutjam la hipòtesi nul·la si <span class="math inline">\(SS_{Tr}\)</span> és molt gran.</p>
</blockquote>
<p>Per la identitat de les sumes de quadrats <span class="math inline">\(SS_{Total}=SS_{Tr}+SS_E\)</span>, això ho podem traduir en</p>
<blockquote>
<p>Rebutjam la hipòtesi nul·la si <span class="math inline">\(SS_{Total}\)</span> és molt més gran que <span class="math inline">\(SS_E\)</span>.</p>
</blockquote>
<p>I això en realitat ho traduïm en</p>
<blockquote>
<p>Rebutjam la hipòtesi nul·la si <span class="math inline">\(SS_{Tr}\)</span> és molt més gran que <span class="math inline">\(SS_E\)</span>.</p>
</blockquote>
<p>Per mesurar-ho emprarem els estadístics següents:</p>
<ul>
<li><strong>Quadrat mitjà dels tractaments</strong>:
<span class="math display">\[
MS_{Tr}=\frac{SS_{Tr}}{k-1}
\]</span></li>
<li><strong>Quadrat mitjà residual</strong>:
<span class="math display">\[
MS_E=\frac{SS_E}{N-k}
\]</span></li>
</ul>
<p>Aquests estadístics són variables aleatòries, i sota les condicions necessàries per poder fer una ANOVA (mostres aleatòries simples independents, variable poblacional normal per a cada tractament i totes amb la mateixa variància, que indicarem amb <span class="math inline">\(\sigma^2\)</span>), satisfan que:</p>
<ul>
<li><p><span class="math inline">\(E(MS_{Tr})=\displaystyle\sigma^2 + \sum_{i=1}^k \frac{n_i (\mu_i-\mu)^2}{k-1}\)</span></p></li>
<li><p><span class="math inline">\(E(MS_E)=\sigma^2\)</span></p></li>
</ul>

<div class="rmdrecordau">
En particular, <strong><span class="math inline">\(MS_E\)</span> és un estimador no esbiaixat de la variància poblacional comuna de tots els tractaments, <span class="math inline">\(\sigma^2\)</span></strong>.
</div>
<p>Ara, si <span class="math inline">\(H_0:\mu_1=\cdots=\mu_k (=\mu)\)</span> és certa,
<span class="math display">\[
\sum_{i=1}^k \frac{n_i (\mu_i -\mu)^2}{k-1}=0,
\]</span>
i si <span class="math inline">\(H_0\)</span> no és certa, aquesta quantitat és <span class="math inline">\(&gt;0\)</span>.</p>
<p>Per tant</p>
<ul>
<li><p>Si <span class="math inline">\(H_0\)</span> és certa, <span class="math inline">\(E(MS_E)=E(MS_{Tr})\)</span> i per tant hauríem d’esperar que aquests dos estadístics prenguessin valors propers, és a dir, hauríem d’esperar que
<span class="math display">\[
\frac{MS_{Tr}}{MS_E}\approx 1
\]</span></p></li>
<li><p>Si <span class="math inline">\(H_0\)</span> és falsa, <span class="math inline">\(E(MS_E)&lt;E(MS_{Tr})\)</span> i hauríem d’esperar que <span class="math inline">\(MS_{Tr}\)</span> donàs valors més grans que <span class="math inline">\(MS_E\)</span>, és a dir, hauríem d’esperar que
<span class="math display">\[
\frac{MS_{Tr}}{MS_E}&gt; 1
\]</span></p></li>
</ul>
<p>Aleshores, prenem com a <strong>estadístic de contrast</strong> el quocient
<span class="math display">\[
F=\frac{MS_{Tr}}{MS_E}
\]</span>
el qual satisfà la propietat següent.</p>

<div class="theorem">
<p><span id="thm:unnamed-chunk-653" class="theorem"><strong>Teorema 10.2  </strong></span>Sota les condicions necessàries per poder realitzar una ANOVA i si <span class="math inline">\(H_0:\mu_1=\cdots=\mu_k\)</span> és certa,</p>
<ul>
<li><p>La variable F té distribució F de Fisher amb <span class="math inline">\(k-1\)</span> i <span class="math inline">\(N-k\)</span> graus de llibertat, <span class="math inline">\(F_{k-1,N-k}\)</span>.</p></li>
<li><p>El seu valor és proper a 1.</p></li>
</ul>
</div>
<p>Per tant, en una ANOVA <strong>rebutjarem la hipòtesi nul·la si el valor <span class="math inline">\(F_0\)</span> de F obtingut sobre la nostra mostra és molt gran</strong>. Això ho traduirem en que rebutjarem la hipòtesi nul·la si la probabilitat que F sigui més gran que <span class="math inline">\(F_0\)</span> és petita, i aquesta probabilitat serà el p-valor del contrast.</p>

<div class="rmdnote">
Si <span class="math inline">\(k=2\)</span>, aquesta F és igual al quadrat de l’estadístic del test t de 2 mostres independents i variàncies iguals. Per tant, efectuar una ANOVA d’1 via amb només 2 tractaments és equivalent a efectuar un test t amb mostres independents i mateixa variància poblacional.
</div>

<div class="rmdcorbes">
Per si qualcú necessita una dosi d’àlgebra, recordau que el quadrat de l’estadístic del test t de 2 mostres independents i variàncies iguals és
<span class="math display">\[
T^2=\frac{(\overline{X}_1-\overline{X}_2)^2}{(\frac{1}{n_1}+\frac{1}{n_2})\cdot 
\frac{(n_1-1)\widetilde{S}_{X_1}^2+(n_2-1)\widetilde{S}_{X_2}^2}{n_1+n_2-2}}
\]</span>
i que el nostre F és <span class="math inline">\(MS_{Tr}/MS_E\)</span>. Ara, en el cas <span class="math inline">\(k=2\)</span>,
<span class="math display">\[
MS_E=\frac{\sum_{j=1}^{n_1}(X_{1j}-\overline{X}_1)^2+\sum_{j=1}^{n_2}(X_{2j}-\overline{X}_2)}{N-2}=
  \frac{(n_1-1)\widetilde{S}_{X_1}+(n_2-1)\widetilde{S}_{X_2}}{n_1+n_2-2}
\]</span>
que surt tal qual al denominador de <span class="math inline">\(T^2\)</span>. Per tant ens queda veure que <span class="math inline">\(MS_{Tr}\)</span> és igual a
<span class="math display">\[
  \frac{(\overline{X}_1-\overline{X}_2)^2}{\frac{1}{n_1}+\frac{1}{n_2}}
\]</span>
Per simplificar, diguem <span class="math inline">\(S_1=n_1\overline{X}_1=\sum_{j=1}^{n_1} X_{1j}\)</span>, <span class="math inline">\(S_2=n_2\overline{X}_2=\sum_{j=1}^{n_2} X_{2j}\)</span>
i
<span class="math display">\[
S=(n_1+n_2)\overline{X}=\sum_{i=1}^2\sum_{j=1}^{n_i} X_{ij}=S_1+S_2=n_1\overline{X}_1+n_2\overline{X}_2.
\]</span>
Doncs va, desenvolupem <span class="math inline">\(MS_{Tr}\)</span> en aquest cas <span class="math inline">\(k=2\)</span>:
<span class="math display">\[
\begin{array}{rl}
MS_{Tr} &amp; \displaystyle = \frac{n_1(\overline{X}_1-\overline{X})^2+n_2(\overline{X}_2-\overline{X})^2}{1}\\
&amp; \displaystyle  = n_1\overline{X}_1^2-2n_1\overline{X}_1\overline{X}+n_1\overline{X}^2+ n_2\overline{X}_2^2-2n_2\overline{X}_2\overline{X}+n_2\overline{X}^2\\
&amp; \displaystyle  = S_1\overline{X}_1+S_2\overline{X}_2-2S_1\overline{X}-2S_2\overline{X}+(n_1+n_2)\overline{X}^2\\
&amp; \displaystyle  =S_1\overline{X}_1+S_2\overline{X}_2-2(S_1+S_2)\overline{X}+(S_1+S_2)\overline{X}\\
&amp; \displaystyle  =S_1\overline{X}_1+S_2\overline{X}_2-(S_1+S_2)\overline{X}\\
&amp; \displaystyle  = S_1\overline{X}_1+S_2\overline{X}_2 -\frac{(S_1+S_2)(n_1\overline{X}_1+n_2\overline{X}_2)}{n_1+n_2}\\
&amp; \displaystyle  =\frac{(n_1+n_2)S_1\overline{X}_1+(n_1+n_2)S_2\overline{X}_2-n_1S_1\overline{X}_1-n_1S_2\overline{X}_1-n_2S_1\overline{X}_2-n_2S_2\overline{X}_2}{n_1+n_2}\\
&amp; \displaystyle  =\frac{n_2S_1\overline{X}_1+n_1S_2\overline{X}_2-n_1S_2\overline{X}_1-n_2S_1\overline{X}_2}{n_1+n_2}\\
&amp; \displaystyle  =\frac{n_2n_1\overline{X}_1^2+n_1n_2\overline{X}_2^2-n_1n_2\overline{X}_2\overline{X}_1-n_2n_1\overline{X}_1\overline{X}_2}{n_1+n_2}\\
&amp; \displaystyle  =\frac{n_1n_2(\overline{X}_1^2+\overline{X}_2^2-2\overline{X}_1\overline{X}_2)}{n_1+n_2}\\
&amp; \displaystyle  =\frac{n_1n_2(\overline{X}_1-\overline{X}_2^2}{n_1+n_2}\\
&amp; \displaystyle  =\frac{(\overline{X}_1-\overline{X}_2)^2}{\frac{n_1+n_2}{n_1n_2}}\\
&amp; \displaystyle  =\frac{(\overline{X}_1-\overline{X}_2)^2}{\frac{1}{n_1}+\frac{1}{n_2}}
\end{array}
\]</span>
</div>
<p><img src="Bioestadistica-II_files/figure-html/loconsegui.png" width="30%" style="display: block; margin: auto;" /></p>
<p>En resum, per realitzar una ANOVA d’1 via a partir d’una mostra:</p>
<ul>
<li><p>Calculam les sumes de quadrats
<span class="math display">\[
SS_{Tr},\ SS_E
\]</span></p></li>
<li><p>Calculam els quadrats mitjans
<span class="math display">\[
MS_{Tr}=\frac{SS_{Tr}}{k-1},\
MS_E=\frac{SS_E}{N-k} 
\]</span></p></li>
<li><p>Calculam el valor de l’estadístic de contrast
<span class="math display">\[
F_0=\frac{MS_{Tr}}{MS_E}
\]</span></p></li>
<li><p>Calculam el p-valor
<span class="math display">\[
P(F_{k-1,N-k}\geqslant F_0)
\]</span></p></li>
<li><p>Si el p-valor és més petit que el nivell de significació <span class="math inline">\(\alpha\)</span>, rebutjam <span class="math inline">\(H_0\)</span> i concloem que no totes les mitjanes són iguals. En cas contrari, acceptam que totes les mitjanes són iguals.</p></li>
</ul>

<div class="example">
<p><span id="exm:unnamed-chunk-658" class="example"><strong>Exemple 10.4  </strong></span>Continuem amb el nostre Exemple <a href="chap-ANOVA.html#exm:CO2">10.1</a>.</p>
</div>
<ul>
<li><p>Ja sabem que <span class="math inline">\(N=50\)</span>, <span class="math inline">\(k=5\)</span>, <span class="math inline">\(SS_{Total}=12522.36\)</span>,
<span class="math inline">\(SS_{Tr}=11274.32\)</span> i <span class="math inline">\(SS_E=1248.038\)</span>.</p></li>
<li><p>Els quadrats mitjans són:</p></li>
</ul>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb528-1"><a href="chap-ANOVA.html#cb528-1" aria-hidden="true" tabindex="-1"></a>N<span class="ot">=</span><span class="dv">50</span></span>
<span id="cb528-2"><a href="chap-ANOVA.html#cb528-2" aria-hidden="true" tabindex="-1"></a>k<span class="ot">=</span><span class="dv">5</span></span>
<span id="cb528-3"><a href="chap-ANOVA.html#cb528-3" aria-hidden="true" tabindex="-1"></a>MSTr<span class="ot">=</span>SSTr<span class="sc">/</span>(k<span class="dv">-1</span>)</span>
<span id="cb528-4"><a href="chap-ANOVA.html#cb528-4" aria-hidden="true" tabindex="-1"></a>MSTr</span></code></pre></div>
<pre><code>## [1] 2818.58</code></pre>
<div class="sourceCode" id="cb530"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb530-1"><a href="chap-ANOVA.html#cb530-1" aria-hidden="true" tabindex="-1"></a>MSE<span class="ot">=</span>SSE<span class="sc">/</span>(N<span class="sc">-</span>k)</span>
<span id="cb530-2"><a href="chap-ANOVA.html#cb530-2" aria-hidden="true" tabindex="-1"></a>MSE</span></code></pre></div>
<pre><code>## [1] 27.73418</code></pre>
<ul>
<li>L’estadístic de contrast val:</li>
</ul>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb532-1"><a href="chap-ANOVA.html#cb532-1" aria-hidden="true" tabindex="-1"></a>F0<span class="ot">=</span>MSTr<span class="sc">/</span>MSE</span>
<span id="cb532-2"><a href="chap-ANOVA.html#cb532-2" aria-hidden="true" tabindex="-1"></a>F0</span></code></pre></div>
<pre><code>## [1] 101.6284</code></pre>
<ul>
<li>El p-valor <span class="math inline">\(P(F_{k-1,N-k}\geqslant F_0)\)</span> val</li>
</ul>
<div class="sourceCode" id="cb534"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb534-1"><a href="chap-ANOVA.html#cb534-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pf</span>(F0,k<span class="dv">-1</span>,N<span class="sc">-</span>k)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p><em>Conclusió</em>: Hem trobat evidència estadística que el nivell de pressió de CO<sub>2</sub> influeix en el creixement mitjà del microorganisme <em>Pseudomonas fragi</em> (ANOVA, p-valor 0).</p>

<div class="rmdcaution">
Per ara només concloem que no totes les mitjanes (dels percentatges d’increment de volum cel·lular) són iguals: no concloem que totes aquestes mitjanes siguin diferents. <strong>No és el mateix!</strong>
</div>
<p>Un contrast ANOVA d’1 via se sol resumir en la <strong>taula ANOVA</strong> següent:
<span class="math display">\[
\begin{array}{llllll}
\hline
\text{Origen de la}&amp;\text{Graus de}&amp;\text{Sumes de}&amp;\text{Quadrats} &amp; \text{Estadístic de}&amp;\text{p-valor}\\[-0.5ex]
\text{variabilitat}&amp;\text{llibertat}&amp;\text{quadrats}&amp;\text{mitjans}&amp;\text{contrast} &amp; \\\hline
\text{Tractaments} &amp; k-1 &amp; SS_{Tr}&amp; MS_{Tr}  &amp; F &amp; \text{p-valor} \\
\text{Residus} &amp; N-k &amp; SS_E &amp; MS_E &amp; \\\hline
\end{array}
\]</span></p>
<p>Així, la taula de l’ANOVA de l’Exemple <a href="chap-ANOVA.html#exm:CO2">10.1</a> és
<span class="math display">\[
\begin{array}{llllll}
\hline
\text{Origen de la}&amp;\text{Graus de}&amp;\text{Sumes de}&amp;\text{Quadrats} &amp; \text{Estadístic de}&amp;\text{p-valor}\\[-0.5ex]
\text{variabilitat}&amp;\text{llibertat}&amp;\text{quadrats}&amp;\text{mitjans}&amp;\text{contrast} &amp; \\\hline
\text{Tractaments} &amp; 4 &amp; 11274.32&amp; 2818.58  &amp; 101.63 &amp; 0 \\
\text{Residus} &amp; 45 &amp; 1248.04 &amp; 27.73 &amp; \\\hline
\end{array}
\]</span></p>
<p>En aquesta taula, a banda de l’estadístic de contrast i el p-valor, ens pot interessar el valor del <span class="math inline">\(MS_E\)</span>, que estima la variància comuna de tots els tractaments. En el nostre exemple, (si se satisfan les condicions per poder efectuar una ANOVA d’1 via) estimam que les variables que ens donen els percentatges d’increment en 1 hora de les poblacions de <em>P. fragi</em> sota les diferents pressions de CO<sub>2</sub> considerades tenen totes variància (poblacional) 27.73.</p>
<p>Vegem un altre exemple.</p>

<div class="example">
<p><span id="exm:ANOVAterapgen" class="example"><strong>Exemple 10.5  </strong></span>Disposam de quatre tractaments genètics diferents, numerats de l’1 al 4, per corregir un cert gen defectuós responsable d’una malaltia. Els investigadors volen saber si els quatre tractaments tenen una eficàcia similar o no. Per contrastar-ho, en un assaig clínic es varen prendre 20 pacients amb aquesta malaltia, els repartiren aleatòriament en 4 grups de 5 malalts cadascun, i assignaren de forma aleatòria un dels quatre tractaments a cada grup. Després d’aplicar el tractament, es va mesurar a cada pacient l’expressió del gen defectuós sota estudi.</p>
</div>
<p>Les dades obtingudes varen ser</p>
<p><span class="math display">\[
\begin{array}{c}
\text{Tractament}\\
\begin{array}{llll}
1 &amp; 2 &amp; 3 &amp; 4 \\
\hline
96 &amp; 93 &amp; 70 &amp;  78 \\
99 &amp; 90 &amp; 90 &amp; 87 \\
100 &amp; 75 &amp; 84 &amp; 57 \\
104 &amp; 80 &amp; 76 &amp; 66  \\
84 &amp; 90 &amp; 78 &amp; 76
\end{array}
\end{array}
\]</span></p>
<p>Aquest experiment té disseny d’ANOVA d’1 via:</p>
<ul>
<li><p>La variable <span class="math inline">\(X\)</span> és “Prenc un individu amb aquest gen defectuós i mesur l’expressió del gen” (aquí es quantificà per mitjà de la quantitat de mRNA en una mostra biològica mesurada amb un <em>Northern blot</em>, no entrarem en més detall).</p></li>
<li><p>El factor emprat per classificar les expressions té com a nivells els 4 tractaments objecte d’estudi.</p></li>
<li><p>S’hi ha pres una m.a.s. per a cada tractament, i de manera independent les unes de les altres.</p></li>
</ul>

<div class="rmdexercici">
Efectuau a mà l’ANOVA d’1 via d’aquestes dades.
</div>
<p>Els resultats parcials us haurien de donar:</p>
<ul>
<li><p><span class="math inline">\(N=20\)</span>, <span class="math inline">\(k=4\)</span>,</p></li>
<li><p>Les mitjanes: <span class="math inline">\(\overline{X}_{1}=96.6\)</span>, <span class="math inline">\(\overline{X}_{2}=85.6\)</span>, <span class="math inline">\(\overline{X}_{3}=79.6\)</span>, <span class="math inline">\(\overline{X}_{4}=72.8\)</span>, <span class="math inline">\(\overline{X}=83.65\)</span></p></li>
<li><p>Les sumes de quadrats: <span class="math inline">\(SS_{Total}=2766.55\)</span>, <span class="math inline">\(SS_{Tr}=1528.15\)</span>, <span class="math inline">\(SS_E=1238.4\)</span></p></li>
<li><p>Els quadrats mitjans: <span class="math inline">\(MS_{Tr}=509.4\)</span>, <span class="math inline">\(MS_{E}=77.4\)</span></p></li>
<li><p>L’estadístic de contrast, <span class="math inline">\(F_0=6.6\)</span></p></li>
<li><p>El p-valor: <span class="math inline">\(P(F_{3,16}&gt;6.6)=\texttt{1-pf(6.6,3,16)}=0.004\)</span></p></li>
<li><p>La taula de l’ANOVA
<span class="math display">\[
\begin{array}{llllll}
\hline
\text{Origen de la}&amp;\text{Graus de}&amp;\text{Sumes de}&amp;\text{Quadrats} &amp; \text{Estadístic de}&amp;\text{p-valor}\\[-0.5ex]
\text{variabilitat}&amp;\text{llibertat}&amp;\text{quadrats}&amp;\text{mitjans}&amp;\text{contrast} &amp; \\\hline
\text{Tractaments} &amp; 3&amp; 1528.15 &amp;  509.4 &amp; 6.6  &amp;  0.004 \\
\text{Residus} &amp; 16 &amp; 1238.4 &amp;  77.4 &amp; \\\hline
\end{array}
\]</span></p></li>
</ul>
<p><em>Conclusió</em>: Hem trobat evidència estadística que les quatre teràpies no tenen totes la mateixa eficàcia mitjana (ANOVA, p-valor 0.004).</p>
</div>
<div id="amb-r" class="section level3" number="10.2.2">
<h3><span class="header-section-number">10.2.2</span> Amb R</h3>
<p>Per realitzar una ANOVA, s’aplica la funció</p>
<div class="sourceCode" id="cb536"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb536-1"><a href="chap-ANOVA.html#cb536-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>( ))</span></code></pre></div>
<p>a la fórmula que separa les dades numèriques segons els nivells del factor (<strong>ha de ser un factor</strong> o, a partir de la versió 4.0 de R, <strong>un vector de paraules</strong>). Si la fórmula només especifica els noms de les variables, s’hi ha d’indicar el nom del <em>dataframe</em> amb el paràmetre <code>data</code>.</p>
<p>Per exemple, l’ANOVA de l’Exemple <a href="chap-ANOVA.html#exm:CO2">10.1</a> s’obté amb</p>
<div class="sourceCode" id="cb537"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb537-1"><a href="chap-ANOVA.html#cb537-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(CO2<span class="sc">$</span>Inc<span class="sc">~</span>CO2<span class="sc">$</span>Pre))</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value Pr(&gt;F)    
## CO2$Pre      4  11274  2818.6   101.6 &lt;2e-16 ***
## Residuals   45   1248    27.7                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>o, equivalentment, amb</p>
<div class="sourceCode" id="cb539"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb539-1"><a href="chap-ANOVA.html#cb539-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(Inc<span class="sc">~</span>Pre,<span class="at">data=</span>CO2))</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value Pr(&gt;F)    
## Pre          4  11274  2818.6   101.6 &lt;2e-16 ***
## Residuals   45   1248    27.7                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>D’aquesta manera obtenim la taula de l’ANOVA que hem explicat fa una estona. La primera filera, <code>Pre</code>, correspon als tractaments, que són els nivells del factor <code>Pre</code> de <strong>CO2</strong>. El valor de <code>Pr(&gt; F)</code> és el p-valor del contrast.</p>

<div class="example">
<p><span id="exm:unnamed-chunk-668" class="example"><strong>Exemple 10.6  </strong></span>Per realitzar l’ANOVA de l’Exemple <a href="chap-ANOVA.html#exm:ANOVAterapgen">10.5</a>, primer hem d’entrar les dades en un <em>dataframe</em>. Un altre cop, entrarem les dades per fileres i per tant els indicadors dels tractaments s’han d’entrar com el vector (1,2,3,4) repetit 5 vegades.</p>
</div>
<div class="sourceCode" id="cb541"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb541-1"><a href="chap-ANOVA.html#cb541-1" aria-hidden="true" tabindex="-1"></a>Expr<span class="ot">=</span><span class="fu">c</span>(<span class="dv">96</span>,<span class="dv">93</span>,<span class="dv">70</span>,<span class="dv">78</span>,<span class="dv">99</span>,<span class="dv">90</span>,<span class="dv">90</span>,<span class="dv">87</span>,<span class="dv">100</span>,<span class="dv">75</span>,<span class="dv">84</span>,<span class="dv">57</span>,<span class="dv">104</span>,<span class="dv">80</span>,<span class="dv">76</span>,<span class="dv">66</span>,<span class="dv">84</span>,<span class="dv">90</span>,<span class="dv">78</span>,<span class="dv">76</span>)</span>
<span id="cb541-2"><a href="chap-ANOVA.html#cb541-2" aria-hidden="true" tabindex="-1"></a>Tract<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,<span class="dv">5</span>)</span>
<span id="cb541-3"><a href="chap-ANOVA.html#cb541-3" aria-hidden="true" tabindex="-1"></a>EG<span class="ot">=</span><span class="fu">data.frame</span>(Expr,Tract)</span>
<span id="cb541-4"><a href="chap-ANOVA.html#cb541-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(EG)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:	20 obs. of  2 variables:
##  $ Expr : num  96 93 70 78 99 90 90 87 100 75 ...
##  $ Tract: int  1 2 3 4 1 2 3 4 1 2 ...</code></pre>
<div class="sourceCode" id="cb543"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb543-1"><a href="chap-ANOVA.html#cb543-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(Expr<span class="sc">~</span>Tract,<span class="at">data=</span>EG))</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## Tract        1   1498  1497.7   21.25 0.000218 ***
## Residuals   18   1269    70.5                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>No ha donat el mateix p-valor que quan l’hem fet a mà!</p>
<p><img src="Bioestadistica-II_files/figure-html/ups.png" width="30%" style="display: block; margin: auto;" /></p>

<div class="rmderror">
No hem entrat els tractaments com un factor. Fixau-vos que el nombre de graus de llibertat a la filera dels tractaments en aquesta taula és 1 i no 3, que és el que tocaria.
</div>
<p>Va, tornem a començar i ara fem-ho bé:</p>
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb545-1"><a href="chap-ANOVA.html#cb545-1" aria-hidden="true" tabindex="-1"></a>Expr<span class="ot">=</span><span class="fu">c</span>(<span class="dv">96</span>,<span class="dv">93</span>,<span class="dv">70</span>,<span class="dv">78</span>,<span class="dv">99</span>,<span class="dv">90</span>,<span class="dv">90</span>,<span class="dv">87</span>,<span class="dv">100</span>,<span class="dv">75</span>,<span class="dv">84</span>,<span class="dv">57</span>,<span class="dv">104</span>,<span class="dv">80</span>,<span class="dv">76</span>,<span class="dv">66</span>,<span class="dv">84</span>,<span class="dv">90</span>,<span class="dv">78</span>,<span class="dv">76</span>)</span>
<span id="cb545-2"><a href="chap-ANOVA.html#cb545-2" aria-hidden="true" tabindex="-1"></a>Tract<span class="ot">=</span><span class="fu">as.factor</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,<span class="dv">5</span>))</span>
<span id="cb545-3"><a href="chap-ANOVA.html#cb545-3" aria-hidden="true" tabindex="-1"></a>EG<span class="ot">=</span><span class="fu">data.frame</span>(Expr,Tract)</span>
<span id="cb545-4"><a href="chap-ANOVA.html#cb545-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(EG)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:	20 obs. of  2 variables:
##  $ Expr : num  96 93 70 78 99 90 90 87 100 75 ...
##  $ Tract: Factor w/ 4 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;: 1 2 3 4 1 2 3 4 1 2 ...</code></pre>
<div class="sourceCode" id="cb547"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb547-1"><a href="chap-ANOVA.html#cb547-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(EG)</span></code></pre></div>
<pre><code>##   Expr Tract
## 1   96     1
## 2   93     2
## 3   70     3
## 4   78     4
## 5   99     1
## 6   90     2</code></pre>
<div class="sourceCode" id="cb549"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb549-1"><a href="chap-ANOVA.html#cb549-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(Expr<span class="sc">~</span>Tract,<span class="at">data=</span>EG))</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value  Pr(&gt;F)   
## Tract        3   1528   509.4   6.581 0.00417 **
## Residuals   16   1238    77.4                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Ara sí que hem obtingut el mateix.</p>
</div>
<div id="comparacions-posteriors-per-parelles" class="section level3" number="10.2.3">
<h3><span class="header-section-number">10.2.3</span> Comparacions posteriors per parelles</h3>
<p>Si hem rebutjat la hipòtesi nul·la <span class="math inline">\(H_0:\mu_1=\cdots =\mu_k\)</span>, podem demanar-nos quins són els tractaments que donen mitjanes diferents.
Això es pot fer de diverses maneres, aquí veurem la més “òbvia”: comparar totes les parelles de mitjanes per mitjà de tests t.
És a dir, per a cada parell de tractaments, realitzar el contrast
<span class="math display">\[
\left\{
\begin{array}{l}
H_0 : \mu_i=\mu_j \\
H_1 : \mu_i\neq\mu_j
\end{array}
\right.
\]</span>
L’estadístic que fem servir en cada un d’aquests contrastos és ara
<span class="math display">\[
T=\frac{\overline{X}_{i} - \overline{X}_{j}}{\sqrt{{MS_E}\cdot (\frac{1}{n_i}
+\frac{1}{n_j})}}
\]</span>
que, si la hipòtesi nul·la d’aquest contrast és vertadera, segueix una distribució <span class="math inline">\(t\)</span> de Student amb <span class="math inline">\(N-k\)</span> graus de llibertat, <span class="math inline">\(t_{N-k}\)</span>.</p>

<div class="rmdcorbes">
<p>Tots aquests contrastos per parelles serien tests t amb mostres independents i la mateixa variància. Per ventura alguns recordeu que la fórmula que us hem explicat al tema de Contrastos paramètrics per a aquests tests no és aquesta, sinó
<span class="math display">\[
T=\frac{\overline{X}_i-\overline{X}_j}{\sqrt{
\frac{(n_i-1)\widetilde{S}_i^2+(n_j-1)\widetilde{S}_j^2}{n_i+n_j-2}\cdot \Big(\frac{1}{n_i}+\frac{1}{n_j}\Big)}} 
\]</span>
que, si <span class="math inline">\(\mu_i=\mu_j\)</span> és vertadera, té distribució <span class="math inline">\(t_{n_i+n_j-2}\)</span>. En aquesta fórmula, el factor
<span class="math display">\[
\frac{(n_i-1)\widetilde{S}_i^2+(n_j-1)\widetilde{S}_j^2}{n_i+n_j-2}
\]</span>
dins l’arrel quadrada del denominador estima la variància comuna de <span class="math inline">\(X_i\)</span> i <span class="math inline">\(X_j\)</span>.</p>
<p>Però en una ANOVA tenim més dades (les mostres de tots els tractaments, no només d’una parella) i les podem emprar totes per estimar la variància comuna de tots els tractaments. Com ja hem dit quan parlàvem de la distribució dels Quadrats Mitjans, aquesta estimació és <span class="math inline">\(MS_E\)</span>, que és el que apareix ara dins l’arrel quadrada del denominador. I com que hem emprat totes les dades que tenim per estimar aquesta variància, i no només les de dues mostres, també canvia el nombre de graus de llibertat.</p>
</div>
<p>El p-valor de cada contrast serà <span class="math inline">\(2P(t_{N-k}\geqslant |t_{i,j}|)\)</span>, on <span class="math inline">\(t_{i,j}\)</span> és el valor que hi pren aquest estadístic <span class="math inline">\(T\)</span>.</p>
<p>Ara bé, observau que d’aquesta manera realitzam <span class="math inline">\(\binom{k}{2}\)</span> contrastos. Com més contrastos fem, més probabilitat tenim d’equivocar-nos.</p>

<div class="rmdcaution">
Si es realitzen <span class="math inline">\(c\)</span> contrastos amb nivell de significació <span class="math inline">\(\alpha\)</span>, la probabilitat d’Error de Tipus I a qualcun és més gran que <span class="math inline">\(\alpha\)</span>: de fet, és <span class="math inline">\(1-(1-\alpha)^c\)</span>.
</div>
<p>Per exemple, a l’Exemple <a href="chap-ANOVA.html#exm:CO2">10.1</a>, si realitzam els <span class="math inline">\(c=\binom{5}{2}=10\)</span> contrastos (totes les pressions contra totes les pressions) amb nivell de significació <span class="math inline">\(\alpha =0.05\)</span>, la probabilitat de cometre almenys un Error de Tipus I a qualcun (si totes les mitjanes fossin iguals en la realitat) és <span class="math inline">\(1-(1-0.05)^{10} \approx 0.4\)</span>.</p>
<p>Per tant, haurem de reduir el nivell de significació de cada contrast perquè la probabilitat global de cometre <strong>qualque</strong> Error de Tipus I sigui <span class="math inline">\(\alpha\)</span>. O, equivalentment, augmentar (se’n diu <strong>ajustar</strong>) el p-valor de cada contrast abans de comparar-lo amb l’<span class="math inline">\(\alpha\)</span> global fixat.</p>
<p>Tot seguit explicam dos mètodes d’ajust de p-valors.</p>
<div id="mètode-de-bonferroni" class="section level4" number="10.2.3.1">
<h4><span class="header-section-number">10.2.3.1</span> Mètode de Bonferroni</h4>
<p>El mètode d’ajust de p-valors més popular és el <strong>de Bonferroni</strong>. Emprant que <span class="math inline">\(1-(1-x)^c \leqslant c\cdot x\)</span>, si volem efectuar <span class="math inline">\(c\)</span> contrastos amb nivell de significació (global) <span class="math inline">\(\alpha\)</span>,</p>
<blockquote>
<p>realitzam cada contrast amb nivell de significació <span class="math inline">\(\alpha/c\)</span></p>
</blockquote>
<p>i així el nivell de significació global segur que serà menor o igual que <span class="math inline">\(c\cdot \alpha/c=\alpha\)</span>. O, equivalentment</p>
<blockquote>
<p>multiplicam el p-valor de cada contrast per <span class="math inline">\(c\)</span> abans de comparar-lo amb el nivell de significació <span class="math inline">\(\alpha\)</span>.</p>
</blockquote>
<p>Les dues accions són equivalents, perquè
<span class="math display">\[
p&lt;\alpha/c \Longleftrightarrow c\cdot p&lt;\alpha
\]</span></p>

<div class="rmdcaution">
Bé, gairebé equivalents. Si quan multiplicau un dels p-valors per <span class="math inline">\(c\)</span> us dóna un valor més gran que 1, heu de donar com a p-valor ajustat 1. Pensau que, ajustats o no, els p-valors representen probabilitats, i per tant és incorrecte donar-ne de més grans que 1.
</div>

<div class="example">
<p><span id="exm:unnamed-chunk-676" class="example"><strong>Exemple 10.7  </strong></span>A l’Exemple <a href="chap-ANOVA.html#exm:CO2">10.1</a>, si realitzam els 10 contrastos per parelles, per obtenir un nivell de significació global <span class="math inline">\(\alpha =0.05\)</span> amb el mètode de Bonferroni,</p>
<ul>
<li>Hem de efectuar cada contrast amb nivell de significació <strong>0.05/10=0.005</strong></li>
</ul>
<p>o equivalentment</p>
<ul>
<li>Hem de multiplicar cada p-valor per <strong>10</strong> i comparar-los amb 0.05.</li>
</ul>
<p>A l’Exemple 2, si realitzam els 6 contrastos de totes les parelles possibles, per obtenir un nivell de significació global <span class="math inline">\(\alpha =0.05\)</span>,</p>
<ul>
<li>Hem de efectuar cada contrast amb nivell de significació <strong>0.05/6=0.0083</strong></li>
</ul>
<p>o equivalentment</p>
<ul>
<li><p>Hem de multiplicar cada p-valor per <strong>6</strong>.</p>
</div></li>
</ul>
<p>Amb R, per calcular tots els p-valors de cop (sense ajustar) podem emprar la funció</p>
<div class="sourceCode" id="cb551"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb551-1"><a href="chap-ANOVA.html#cb551-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.t.test</span>(variable numèrica, factor, <span class="at">p.adjust.method=</span><span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p>El resultat d’un <code>pairwise.t.test</code> dóna el triangle inferior de la matriu dels p-valors: l’entrada <span class="math inline">\((i,j)\)</span> correspon al contrast de mitjanes del nivell <span class="math inline">\(i\)</span>-èsim i el nivell <span class="math inline">\(j\)</span>-èsim.</p>
<p>Per calcular tots els p-valors ajustats amb qualque mètode, s’ha d’especificar al paràmetre <code>p.adjust.method</code>. Per exemple, per ajustar-los amb el mètode de Bonferroni, s’hauria d’entrar <code>p.adjust.method="bonferroni"</code> (fixau-vos que <code>bonferroni</code> hi va entre cometes i començant amb minúscula).</p>

<div class="example">
<p><span id="exm:unnamed-chunk-678" class="example"><strong>Exemple 10.8  </strong></span>Tornem a l’Exemple <a href="chap-ANOVA.html#exm:ANOVAterapgen">10.5</a>.</p>
</div>
<ul>
<li>Per obtenir tots els p-valors sense ajustar, els quals després nosaltres haurem de comparar amb <span class="math inline">\(\alpha/6\)</span>, executam</li>
</ul>
<div class="sourceCode" id="cb552"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb552-1"><a href="chap-ANOVA.html#cb552-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.t.test</span>(EG<span class="sc">$</span>Expr,EG<span class="sc">$</span>Tract, <span class="at">p.adjust.method=</span><span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 	Pairwise comparisons using t tests with pooled SD 
## 
## data:  EG$Expr and EG$Tract 
## 
##   1       2       3      
## 2 0.06554 -       -      
## 3 0.00756 0.29688 -      
## 4 0.00058 0.03522 0.23937
## 
## P value adjustment method: none</code></pre>
<p>La primera entrada d’aquest resultat, 0.06554, és el p-valor sense ajustar del contrast de <span class="math inline">\(\mu_2\)</span> contra <span class="math inline">\(\mu_1\)</span>; el 0.00756 és el p-valor sense ajustar del contrast de <span class="math inline">\(\mu_3\)</span> contra <span class="math inline">\(\mu_1\)</span>; etc.</p>
<ul>
<li>Per obtenir tots els p-valors ajustats segons Bonferroni, que després nosaltres haurem de comparar amb <span class="math inline">\(\alpha\)</span>, entram</li>
</ul>
<div class="sourceCode" id="cb554"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb554-1"><a href="chap-ANOVA.html#cb554-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.t.test</span>(EG<span class="sc">$</span>Expr,EG<span class="sc">$</span>Tract,<span class="at">p.adjust.method=</span><span class="st">&quot;bonferroni&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 	Pairwise comparisons using t tests with pooled SD 
## 
## data:  EG$Expr and EG$Tract 
## 
##   1      2      3     
## 2 0.3933 -      -     
## 3 0.0453 1.0000 -     
## 4 0.0035 0.2113 1.0000
## 
## P value adjustment method: bonferroni</code></pre>
<p>Podeu comprovar que els p-valors d’aquest segon resultat són els del primer resultat multiplicats per 6 (llevat d’arrodoniments i dels 1 que poden representar resultats més grans que 1).</p>
<p>Suposem que fixam el nivell de significació global usual <span class="math inline">\(\alpha=0.05\)</span>. En la primera execució de <code>pairwise.t.test</code>, els únics p-valors per davall de <span class="math inline">\(0.05/6=0.0083\)</span> han estat els dels parells (1,3) i (1,4).
En la segona, els únics p-valors per davall de 0.05 han estat també els dels parells (1,3) i (1,4). Casualitat? És clar que no! Les conclusions havien de coincidir, perquè les dues tècniques són equivalents.</p>
<p><em>Conclusió</em>: Hem trobat evidència estadística que la teràpia 1 té una eficàcia mitjana diferent de la de les teràpies 3 i 4 (ANOVA d’1 via, test posterior de Bonferroni, p-valors 0.0453 i 0.0035, respectivament), i no n’hem trobat de cap altra diferència.</p>
</div>
<div id="mètode-de-holm" class="section level4" number="10.2.3.2">
<h4><span class="header-section-number">10.2.3.2</span> Mètode de Holm</h4>
<p>Un altre mètode popular d’ajust de p-valors, més potent que el de Bonferroni, i que de fet és el mètode que empra R per defecte és el <strong>mètode de Holm</strong>, que funciona bàsicament de la forma següent:</p>
<ol style="list-style-type: decimal">
<li><p>Siguin <span class="math inline">\(C_{1},\ldots ,C_{c}\)</span> els contrastos per parelles que es volen realitzar i <span class="math inline">\(p_{1},\ldots ,p_{c}\)</span> els p-valors corresponents.</p></li>
<li><p>Ordenam aquests p-valors en ordre creixent <span class="math inline">\(p_{(1)}&lt; \cdots&lt; p_{(c)}\)</span> i re-enumeram consistentment els contrastos <span class="math inline">\(C_{(1)},\ldots, C_{(c)}\)</span>.</p></li>
<li><p>Per a cada <span class="math inline">\(j=1,\ldots,c\)</span>, calculam el <strong>p-valor ajustat</strong> <span class="math inline">\(\widetilde{p}_{(j)}=(c+1-j)\cdot p_{(j)}\)</span>.</p></li>
<li><p>Aleshores rebutjam la hipòtesi nul·la als contrastos <span class="math inline">\(C_{(j)}\)</span> on <span class="math inline">\(\widetilde{p}_{(j)}&lt;\alpha\)</span>.</p></li>
</ol>

<div class="example">
<p><span id="exm:unnamed-chunk-681" class="example"><strong>Exemple 10.9  </strong></span>Anem a fer a mà l’ajust dels p-valors segons Holm a l’Exemple <a href="chap-ANOVA.html#exm:ANOVAterapgen">10.5</a>.</p>
</div>
<ol style="list-style-type: decimal">
<li><p>La taula amb els p-valors dels contrastos és:
<span class="math display">\[
\begin{array}{c|c}
\text{Contrast} &amp; \text{p-valor} \\ \hline
\text{1-2} &amp; 0.06554\\
\text{1-3} &amp; 0.00756\\
\text{1-4} &amp; 0.00058\\
\text{2-3} &amp;0.29688\\
\text{2-4} &amp; 0.03522\\
\text{3-4} &amp; 0.23937
\end{array}
\]</span></p></li>
<li><p>Ordenam en ordre creixent del p-valor:</p></li>
</ol>
<p><span class="math display">\[
\begin{array}{c|c}
\text{Contrast} &amp; \text{p-valor} \\ \hline
\text{1-4} &amp; 0.00058\\
\text{2-3} &amp; 0.00756\\
\text{2-4} &amp; 0.03522\\
\text{1-2} &amp; 0.06554\\
\text{3-4} &amp; 0.23937\\
\text{2-3} &amp;0.29688\\
\end{array}
\]</span></p>
<ol start="3" style="list-style-type: decimal">
<li>Ajustam, multiplicant, per a cada <span class="math inline">\(j\)</span>, el <span class="math inline">\(j\)</span>-èsim p-valor (en ordre decreixent) per <span class="math inline">\(6+1-j\)</span>:</li>
</ol>
<p><span class="math display">\[
\begin{array}{c|cc}
\text{Contrast} &amp; \text{p-valor} &amp;  \text{p-valor ajustat}\\ \hline
\text{1-4} &amp; 0.00058 &amp; 6\times 0.00058 = 0.00348\\
\text{1-3} &amp; 0.00756 &amp; 5\times 0.00756 = 0.03780\\
\text{2-4} &amp; 0.03522 &amp; 4\times 0.03522 = 0.14088\\
\text{1-2} &amp; 0.06554 &amp; 3\times 0.06554 =  0.19662\\
\text{3-4} &amp; 0.23937 &amp; 2\times 0.23937 = 0.47874\\
\text{2-3} &amp; 0.29688 &amp; 1\times 0.29688 = 0.29688\\
\end{array}
\]</span></p>
<ol start="4" style="list-style-type: decimal">
<li>Comparam els p-valors ajustats amb <span class="math inline">\(\alpha\)</span>. En aquest cas, amb <span class="math inline">\(\alpha=0.05\)</span> arribam a la mateixa conclusió que amb el mètode de Bonferroni: concloem que <span class="math inline">\(\mu_1\neq \mu_4\)</span> i <span class="math inline">\(\mu_1\neq \mu_3\)</span> i que no podem rebutjar que les altres parelles de mitjanes siguin iguals.</li>
</ol>
<p>Amb R, s’ha d’especificar a la funció <code>pairwise.t.test</code> el paràmetre <code>p.adjust.method="holm"</code>, o no especificar aquest paràmetre perquè “holm” és el valor per defecte de <code>p.adjust.method</code>.</p>
<div class="sourceCode" id="cb556"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb556-1"><a href="chap-ANOVA.html#cb556-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.t.test</span>(EG<span class="sc">$</span>Expr,EG<span class="sc">$</span>Tract,<span class="at">p.adjust.method=</span><span class="st">&quot;holm&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 	Pairwise comparisons using t tests with pooled SD 
## 
## data:  EG$Expr and EG$Tract 
## 
##   1      2      3     
## 2 0.1966 -      -     
## 3 0.0378 0.4787 -     
## 4 0.0035 0.1409 0.4787
## 
## P value adjustment method: holm</code></pre>

<div class="example">
<p><span id="exm:unnamed-chunk-683" class="example"><strong>Exemple 10.10  </strong></span>Els tests posteriors per parelles de l’Exemple <a href="chap-ANOVA.html#exm:CO2">10.1</a> amb el mètode de Bonferroni i de Holm són:</p>
</div>
<div class="sourceCode" id="cb558"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb558-1"><a href="chap-ANOVA.html#cb558-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.t.test</span>(CO2<span class="sc">$</span>Inc,CO2<span class="sc">$</span>Pre,<span class="at">p.adjust.method=</span><span class="st">&quot;bonferroni&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 	Pairwise comparisons using t tests with pooled SD 
## 
## data:  CO2$Inc and CO2$Pre 
## 
##      0.0     0.08    0.29    0.50   
## 0.08 1.4e-05 -       -       -      
## 0.29 1.6e-11 0.00186 -       -      
## 0.50 &lt; 2e-16 3.0e-10 0.00028 -      
## 0.86 &lt; 2e-16 2.5e-15 6.6e-10 0.00389
## 
## P value adjustment method: bonferroni</code></pre>
<div class="sourceCode" id="cb560"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb560-1"><a href="chap-ANOVA.html#cb560-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.t.test</span>(CO2<span class="sc">$</span>Inc,CO2<span class="sc">$</span>Pre,<span class="at">p.adjust.method=</span><span class="st">&quot;holm&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 	Pairwise comparisons using t tests with pooled SD 
## 
## data:  CO2$Inc and CO2$Pre 
## 
##      0.0     0.08    0.29    0.50   
## 0.08 5.6e-06 -       -       -      
## 0.29 1.2e-11 0.00037 -       -      
## 0.50 &lt; 2e-16 1.8e-10 8.4e-05 -      
## 0.86 &lt; 2e-16 2.0e-15 3.3e-10 0.00039
## 
## P value adjustment method: holm</code></pre>
<p><em>Conclusió</em>: Hem trobat evidència estadística que cada una de les diferents pressions de CO<sub>2</sub> considerades dona lloc a un increment mitjà diferent del volum cel·lular de <em>P. fragi</em> al cap d’una hora (ANOVA d’1 via, test posterior de Holm, p-valors ajustats &lt; 0.0004).</p>

<div class="rmdcaution">
Ara sí que hem trobat evidència que <strong>totes</strong> les mitjanes són diferents. Amb l’ANOVA, només podíem concloure que <strong>algunes</strong> mitjanes són diferents, però no quines.
</div>
</div>
</div>
<div id="comprovació-de-les-condicions" class="section level3" number="10.2.4">
<h3><span class="header-section-number">10.2.4</span> Comprovació de les condicions</h3>
<p>Recordau que perquè la conclusió d’una ANOVA d’1 via tengui sentit:</p>
<ol style="list-style-type: decimal">
<li><p>Les mostres de cada tractament han de ser aleatòries simples i independents i almenys una ha de tenir més d’un element.</p></li>
<li><p>La població definida per cada tractament ha de ser normal.</p></li>
<li><p>Totes aquestes poblacions han de tenir la mateixa variància (homocedasticitat).</p></li>
</ol>
<p>El punt (1) és responsabilitat de l’investigador, però (2) i (3) s’han de contrastar. Si fallen, sobretot si falla (3), no es pot usar una ANOVA: convé emprar un test no paramètric.</p>
<p>La normalitat de les mostres s’ha de contrastar amb algun test de normalitat. Per exemple, emprarem el test de Shapiro-Wilks per contrastar la normalitat dels nostre exemple de creixement del volum cel·lular de <em>P. fragi</em>:</p>
<div class="sourceCode" id="cb562"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb562-1"><a href="chap-ANOVA.html#cb562-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(CO2<span class="sc">$</span>Inc[CO2<span class="sc">$</span>Pre<span class="sc">==</span><span class="st">&quot;0.0&quot;</span>])<span class="sc">$</span>p.value</span></code></pre></div>
<pre><code>## [1] 0.320568</code></pre>
<div class="sourceCode" id="cb564"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb564-1"><a href="chap-ANOVA.html#cb564-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(CO2<span class="sc">$</span>Inc[CO2<span class="sc">$</span>Pre<span class="sc">==</span><span class="st">&quot;0.08&quot;</span>])<span class="sc">$</span>p.value</span></code></pre></div>
<pre><code>## [1] 0.1023687</code></pre>
<div class="sourceCode" id="cb566"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb566-1"><a href="chap-ANOVA.html#cb566-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(CO2<span class="sc">$</span>Inc[CO2<span class="sc">$</span>Pre<span class="sc">==</span><span class="st">&quot;0.29&quot;</span>])<span class="sc">$</span>p.value</span></code></pre></div>
<pre><code>## [1] 0.5197501</code></pre>
<div class="sourceCode" id="cb568"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb568-1"><a href="chap-ANOVA.html#cb568-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(CO2<span class="sc">$</span>Inc[CO2<span class="sc">$</span>Pre<span class="sc">==</span><span class="st">&quot;0.50&quot;</span>])<span class="sc">$</span>p.value</span></code></pre></div>
<pre><code>## [1] 0.465208</code></pre>
<div class="sourceCode" id="cb570"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb570-1"><a href="chap-ANOVA.html#cb570-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(CO2<span class="sc">$</span>Inc[CO2<span class="sc">$</span>Pre<span class="sc">==</span><span class="st">&quot;0.86&quot;</span>])<span class="sc">$</span>p.value</span></code></pre></div>
<pre><code>## [1] 0.4840276</code></pre>
<p>Podem acceptar que totes les mostres provenen de variables normals.</p>
<p>Naturalment, el més pràctic és fer tots aquests tests de cop, emprant la funció <code>aggregate</code>. En el bloc de codi següent, definim una funció <code>Test.SW</code> que calcula el p-valor del test de Shapiro-Wilks i l’aplicam a la variable <code>CO2$Inc</code> separada segons el factor <code>CO2$Pre</code>.</p>
<div class="sourceCode" id="cb572"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb572-1"><a href="chap-ANOVA.html#cb572-1" aria-hidden="true" tabindex="-1"></a>Test.SW<span class="ot">=</span><span class="cf">function</span>(x){<span class="fu">shapiro.test</span>(x)<span class="sc">$</span>p.value}</span>
<span id="cb572-2"><a href="chap-ANOVA.html#cb572-2" aria-hidden="true" tabindex="-1"></a>p.vals.CO2<span class="ot">=</span><span class="fu">aggregate</span>(Inc<span class="sc">~</span>Pre, <span class="at">data=</span>CO2, <span class="at">FUN=</span>Test.SW)</span>
<span id="cb572-3"><a href="chap-ANOVA.html#cb572-3" aria-hidden="true" tabindex="-1"></a>p.vals.CO2</span></code></pre></div>
<pre><code>##    Pre       Inc
## 1  0.0 0.3205680
## 2 0.08 0.1023687
## 3 0.29 0.5197501
## 4 0.50 0.4652080
## 5 0.86 0.4840276</code></pre>
<p>El resultat és un data frame, la variable <code>Inc</code> del qual conté els p-valors.</p>
<p>Pel que fa l’exemple de l’expressió de gens,</p>
<div class="sourceCode" id="cb574"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb574-1"><a href="chap-ANOVA.html#cb574-1" aria-hidden="true" tabindex="-1"></a>p.vals.EG<span class="ot">=</span><span class="fu">aggregate</span>(Expr<span class="sc">~</span>Tract, <span class="at">data=</span>EG, <span class="at">FUN=</span>Test.SW)</span>
<span id="cb574-2"><a href="chap-ANOVA.html#cb574-2" aria-hidden="true" tabindex="-1"></a>p.vals.EG</span></code></pre></div>
<pre><code>##   Tract      Expr
## 1     1 0.3062060
## 2     2 0.2722278
## 3     3 0.9611411
## 4     4 0.9065984</code></pre>
<p>També podem acceptar que totes les mostres provenen de variables normals.</p>

<div class="rmdimportant">
Si efectuam <span class="math inline">\(k\)</span> contrastos de normalitat amb nivell de significació <span class="math inline">\(\alpha\)</span>, tenim una probabilitat de cometre algun error de tipus I de <span class="math inline">\(1-(1-\alpha)^k\)</span>. Per tant, com als contrastos posteriors per parelles, convé ajustar els p-valors a fi que el nivell de significació global sigui <span class="math inline">\(\alpha\)</span>.
</div>
<p>En els nostres dos exemples això no afecta les conclusions, perquè els p-valors han estat grans i en ajustar-los encara creixeran. Però si us cal comprovar-ho, podeu fer servir la funció</p>
<div class="sourceCode" id="cb576"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb576-1"><a href="chap-ANOVA.html#cb576-1" aria-hidden="true" tabindex="-1"></a><span class="fu">p.adjust</span>(p<span class="sc">-</span>valors, <span class="at">method=</span>...)</span></code></pre></div>
<p>especificant a <code>method</code> el mètode d’ajust amb la mateixa sintaxi que a <code>pairwise.t.test</code> (per defecte, serà el de Holm).</p>
<p>Per exemple, per ajustar els p-valors de l’exemple del CO<sub>2</sub> pel mètode de Bonferroni, i afegir el resultat al data frame amb els p-valors, faríem</p>
<div class="sourceCode" id="cb577"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb577-1"><a href="chap-ANOVA.html#cb577-1" aria-hidden="true" tabindex="-1"></a>p.vals.CO2<span class="sc">$</span>p.vals.ajustats<span class="ot">=</span><span class="fu">p.adjust</span>(p.vals.CO2<span class="sc">$</span>Inc,<span class="at">method=</span><span class="st">&quot;bonferroni&quot;</span>)</span>
<span id="cb577-2"><a href="chap-ANOVA.html#cb577-2" aria-hidden="true" tabindex="-1"></a>p.vals.CO2</span></code></pre></div>
<pre><code>##    Pre       Inc p.vals.ajustats
## 1  0.0 0.3205680       1.0000000
## 2 0.08 0.1023687       0.5118436
## 3 0.29 0.5197501       1.0000000
## 4 0.50 0.4652080       1.0000000
## 5 0.86 0.4840276       1.0000000</code></pre>
<p>Pel que fa a contrastar l’homocedasticitat, els dos tests més populars són:</p>
<ul>
<li>Si acceptam que les mostres provenen de distribucions normals, el <strong>test de Bartlett</strong>, implementat en R en la funció <code>bartlett.test</code>.</li>
<li>Si <strong>no</strong> acceptam que les mostres provenen de distribucions normals, el <strong>test de Fligner-Killeen</strong>, implementat en R en la funció <code>fligner.test</code>.</li>
</ul>
<p>En tots dos casos, la funció s’aplica a una fórmula, exactament igual que <code>aov</code>. Per exemple, per contrastar l’homocedasticitat dels increments de volum cel·lular sota diferents pressions de CO<sub>2</sub> de l’Exemple <a href="chap-ANOVA.html#exm:CO2">10.1</a> amb un test de Bartlett, entraríem:</p>
<div class="sourceCode" id="cb579"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb579-1"><a href="chap-ANOVA.html#cb579-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(CO2<span class="sc">$</span>Inc<span class="sc">~</span>CO2<span class="sc">$</span>Pre)</span></code></pre></div>
<pre><code>## 
## 	Bartlett test of homogeneity of variances
## 
## data:  CO2$Inc by CO2$Pre
## Bartlett&#39;s K-squared = 1.0701, df = 4, p-value = 0.899</code></pre>
<p>Podem acceptar que les variàncies de les subpoblacions definides pels percentatges d’increment del volum cel·lular sota les diferents pressions de CO<sub>2</sub> considerades són totes iguals.</p>
<p>Ja que hi som, comprovem l’homocedasticitat de l’Exemple <a href="chap-ANOVA.html#exm:ANOVAterapgen">10.5</a>, ara amb el test de Fligner-Killeen i emprant l’altra sintaxi possible perquè la vegeu:</p>
<div class="sourceCode" id="cb581"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb581-1"><a href="chap-ANOVA.html#cb581-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fligner.test</span>(Expr<span class="sc">~</span>Tract, <span class="at">data=</span>EG)</span></code></pre></div>
<pre><code>## 
## 	Fligner-Killeen test of homogeneity of variances
## 
## data:  Expr by Tract
## Fligner-Killeen:med chi-squared = 0.89109, df = 3, p-value = 0.8276</code></pre>
<p>Acceptaríem (si el test de Fligner fos l’adient) que se satisfà l’homocedasticitat.</p>
</div>
<div id="test-no-paramètric" class="section level3" number="10.2.5">
<h3><span class="header-section-number">10.2.5</span> Test no paramètric</h3>
<p>Si en un experiment de disseny d’ANOVA d’1 via no podem emprar una ANOVA perquè no se satisfaci la normalitat de les poblacions o, sobretot, l’homocedasticitat, cal emprar un test no paramètric. El més popular es el <strong>test de Kruskal-Wallis</strong>, que generalitza el test de Mann-Whitney a més de 2 poblacions igual que l’ANOVA d’1 via generalitza el test t amb mostres independents. Es fa amb la funció <code>kruskal.test</code>.</p>
<p>Per exemple, per aplicar-lo a les dades de l’Exemple <a href="chap-ANOVA.html#exm:CO2">10.1</a>:</p>
<div class="sourceCode" id="cb583"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb583-1"><a href="chap-ANOVA.html#cb583-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kruskal.test</span>(CO2<span class="sc">$</span>Inc<span class="sc">~</span>CO2<span class="sc">$</span>Pre)</span></code></pre></div>
<pre><code>## 
## 	Kruskal-Wallis rank sum test
## 
## data:  CO2$Inc by CO2$Pre
## Kruskal-Wallis chi-squared = 44.716, df = 4, p-value = 4.555e-09</code></pre>
<p>Seguim concloent que no totes les mitjanes (en realitat, les <strong>medianes</strong>) són iguals.</p>
<p>Si el test de Kruskal-Wallis permet rebutjar la igualtat de mitjanes, i voleu determinar quines parelles són diferents, disposau de la funció <code>pairwise.wilcox.test</code> que efectua contrastos per parelles de Mann-Whitney (amb el paràmetre <code>paired=FALSE</code>). Té la mateixa sintaxi que <code>pairwise.t.test</code> i com en aquella funció, el mètode d’ajust dels p-valors s’hi entra amb el paràmetre <code>p.adjust.method</code>. El mètode per defecte emprat per aquesta funció també és el mètode de Holm.</p>
<p>Per exemple, per realitzar tots els contrastos de Mann-Whitney en l’exemple del CO<sub>2</sub> emprant el mètode d’ajust de Bonferroni, entram:</p>
<div class="sourceCode" id="cb585"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb585-1"><a href="chap-ANOVA.html#cb585-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.wilcox.test</span>(CO2<span class="sc">$</span>Inc, CO2<span class="sc">$</span>Pre, <span class="at">paired=</span><span class="cn">FALSE</span>, </span>
<span id="cb585-2"><a href="chap-ANOVA.html#cb585-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">p.adjust.method=</span><span class="st">&quot;bonferroni&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 	Pairwise comparisons using Wilcoxon rank sum test with continuity correction 
## 
## data:  CO2$Inc and CO2$Pre 
## 
##      0.0     0.08    0.29    0.50   
## 0.08 0.00211 -       -       -      
## 0.29 0.00011 0.01050 -       -      
## 0.50 0.00011 0.00011 0.00325 -      
## 0.86 0.00011 0.00011 0.00011 0.03186
## 
## P value adjustment method: bonferroni</code></pre>
<p>Tornam a concloure que els percentatges mitjans poblacionals d’increment són tots diferents.</p>
</div>
</div>
<div id="anova-de-blocs" class="section level2" number="10.3">
<h2><span class="header-section-number">10.3</span> ANOVA de blocs</h2>
<p>De la mateixa manera que l’ANOVA d’1 via generalitza a més de dues mitjanes el contrast d’igualtat de dues mitjanes emprant mostres independents, l’<strong>ANOVA de blocs</strong> generalitza a més de dues mitjanes el contrast d’igualtat de dues mitjanes emprant mostres <strong>aparellades</strong>.</p>
<div id="contrast-bàsic-1" class="section level3" number="10.3.1">
<h3><span class="header-section-number">10.3.1</span> Contrast bàsic</h3>
<p>Comencem amb un exemple</p>

<div class="example">
<p><span id="exm:esports" class="example"><strong>Exemple 10.11  </strong></span>Volem determinar si l’energia que es requereix per dur a terme tres activitats físiques (córrer, caminar i muntar amb bicicleta) és la mateixa o no. Quantificam aquesta energia amb el nombre de Kcal consumides per Km recorregut.</p>
</div>
<p><img src="Bioestadistica-II_files/figure-html/esports.png" width="40%" style="display: block; margin: auto;" /></p>
<p>Les diferències metabòliques entre els individus poden afectar l’energia requerida per dur a terme una determinada activitat. Si triam tres grups d’individus i a cada grup li fem fer una de les tres activitats físiques, aquestes diferències metabòliques entre els individus triats podrien afectar els resultats i amagar l’efecte real. Per aquest motiu, ens decidim per un <strong>disseny experimental en paral·lel</strong>. Seleccionam alguns individus i fem que cadascun corri, camini i recorri amb bicicleta una distància fixada i mesuram per a cada individu en tres moments diferents i cada activitat el consum de Kca/Km. A més,
seleccionam l’ordre de les activitats de cada individu a l’atzar.</p>

<div class="rmdcaution">
Si a tots els individus els féssim fer les tres activitats en el mateix ordre, podria ser que qualque factor extern que no controlàssim influís en el resultat. Per exemple, si tots caminen al mateix temps, després corren al mateix temps i després pedalen al mateix temps, i hi ha grans diferències de temperatura ambient entre els tres moments, això podria influir en el resultat final. Si, en canvi, aleatoritzam l’ordre de les activitats, en principi podem esperar que aquestes diferències es compensin.
</div>
<p>Aquests són els resultats obtinguts per a 8 individus:</p>
<p><span class="math display">\[
\begin{array}{c}
\hphantom{Individu}\text{Activitat}\\
\begin{array}{c|ccc}
\text{Individu} &amp;\text{1 (corrent)} &amp;\text{2 (caminant)}&amp;\text{3 (pedalant)}\\
\hline
1&amp;1.4&amp;1.1&amp;0.7\\
2&amp;1.5&amp;1.2&amp;0.8\\
3&amp;1.8&amp;1.3&amp;0.7\\
4&amp;1.7&amp;1.3&amp;0.8\\
5&amp;1.6&amp;0.7&amp;0.1\\
6&amp;1.5&amp;1.2&amp;0.7\\
7&amp;1.7&amp;1.1&amp;0.4\\
8&amp;2.0&amp;1.3&amp;0.6\\
\end{array}
\end{array}
\]</span></p>
<p>En aquest estudi, fixau-vos que empram els nivells d’un factor (tipus de desplaçament) per classificar la població (els consums energètics) en tres subpoblacions, però ara les mostres que hem pres no són independents sinó <strong>aparellades</strong>: hem mesurat els consums energètics dels tres esports sobre els mateixos individus. Per tant no podem realitzar una ANOVA d’1 via per analitzar els resultats. L’<strong>ANOVA de blocs</strong> (<strong>complets aleatoris</strong>, però ometrem aquests adjectius perquè és l’únic que veurem) generalitza el contrast de 2 mitjanes amb mostres aparellades a <span class="math inline">\(k\)</span> mitjanes amb mostres aparellades.</p>
<p>La situació general és la següent. Tenim una variable aleatòria <span class="math inline">\(X\)</span> i un factor de <span class="math inline">\(k\)</span> nivells, o <strong>tractaments</strong>, que classifica la població en <span class="math inline">\(k\)</span> subpoblacions (les quals, recordau, identificam amb els tractaments). Diguem <span class="math inline">\(\mu_i\)</span> a la mitjana de <span class="math inline">\(X\)</span> en els individus del nivell <span class="math inline">\(i\)</span>-èsim. Volem decidir si aquestes mitjanes <span class="math inline">\(\mu_1\)</span>,…,<span class="math inline">\(\mu_k\)</span> són totes iguals o no. És a dir, el contrast és
<span class="math display">\[
\left\{
\begin{array}{l}
H_0 : \mu_{1} =\mu_{2} =\cdots =\mu_{k} \\
H_1 : \text{Hi ha } i,j \text{ tals que }  \mu_{i} \not=\mu_{j}
\end{array}
\right.
\]</span></p>
<p>En un <strong>experiment de disseny d’ANOVA de blocs</strong>:</p>
<ol style="list-style-type: decimal">
<li><p>Escollim una mostra aleatòria de <span class="math inline">\(b\)</span> <strong>blocs</strong>: conjunts de <span class="math inline">\(k\)</span> subjectes aparellats (per exemple, escollim <span class="math inline">\(b\)</span> subjectes i entenem cada bloc com a format per <span class="math inline">\(k\)</span> còpies del mateix subjecte), on <span class="math inline">\(k\)</span> és el nombre de tractaments.</p></li>
<li><p>Dins cada bloc, assignam aleatòriament a cada subjecte un tractament, de manera que cada tractament s’empri exactament un cop dins cada bloc.</p></li>
</ol>
<p>Així, el disseny de l’Exemple <a href="chap-ANOVA.html#exm:esports">10.11</a> és d’una ANOVA de blocs:</p>
<ul>
<li><p>La variable aleatòria d’interès és l’energia consumida (en Kcal) per una persona en recórrer 1 km.</p></li>
<li><p>Els tractaments són els tres tipus de desplaçament.</p></li>
<li><p>Prenem 8 persones de manera raonablement aleatòria i interpretam cada una com un bloc.</p></li>
<li><p>Assignam a cada persona el tres tractaments en un ordre escollit a l’atzar per a cada una d’elles.</p></li>
</ul>
<p>La filosofia del contrast serà similar a la de l’ANOVA d’1 via, comparant variabilitats: si la variabilitat de les mitjanes de les mostres és molt més gran que la variabilitat dels “errors”, rebutjarem la igualtat de totes les mitjanes poblacionals.</p>
<p>En una ANOVA de blocs, les dades se solen representar en forma d’una taula com la següent
<span class="math display">\[
\begin{array}{c}
\hphantom{Bloc}\text{Tractament}\\
\begin{array}{ccccc}
\text{Bloc} &amp;\text{Tract. 1} &amp;\text{Tract. 2}&amp;\ldots &amp; \text{Tract. $k$}\\
\hline
 1 &amp; X_{11} &amp; X_{21} &amp; \ldots &amp; X_{k1} \\
 2 &amp; X_{12} &amp; X_{22} &amp; \ldots &amp; X_{k2} \\
 \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
 b &amp; X_{1b} &amp; X_{2b} &amp; \ldots &amp; X_{kb} \\
\hline
\end{array}
\end{array}
\]</span></p>
<p>on cada <span class="math inline">\(X_{ij}\)</span> és el valor del tractament <span class="math inline">\(i\)</span>-èsim en l’individu corresponent del bloc <span class="math inline">\(j\)</span>-èsim. Com en les taules emprades en l’ANOVA d’1 via, observau que no és la notació usual de les taules de dades, sinó la transposada: a <span class="math inline">\(X_{{i}{j}}\)</span>, <span class="math inline">\(i\)</span> hi indica la <strong>columna</strong>, el tractament, i <span class="math inline">\(j\)</span> hi indica la <strong>filera</strong>, és a dir, el bloc. D’aquesta manera, cada filera <span class="math inline">\((X_{1j},\ldots,X_{kj})\)</span> representa un bloc.</p>

<div class="example">
<p><span id="exm:unnamed-chunk-699" class="example"><strong>Exemple 10.12  </strong></span>Tornant al nostre Exemple <a href="chap-ANOVA.html#exm:esports">10.11</a> inicial, els blocs són els 8 individus (<span class="math inline">\(b=8\)</span>) i els tractaments, les diferents activitats (<span class="math inline">\(k=3\)</span>). Si</p>
<ul>
<li><span class="math inline">\(\mu_{1}\)</span> representa el nombre mitjà de Kcal que es consumeixen corrent 1 km</li>
<li><span class="math inline">\(\mu_{2}\)</span> representa el nombre mitjà de Kcal que es consumeixen caminant 1 km</li>
<li><span class="math inline">\(\mu_{3}\)</span> representa el nombre mitjà de Kcal que es consumeixen pedalant 1 km</li>
</ul>
<p>el contrast que volem realitzar és
<span class="math display">\[
\left\{
\begin{array}{l}
H_0 : \mu_{1} = \mu_{2} = \mu_{3} \\
H_1 : \mu_{1} \neq \mu_{2}\text{ o } \mu_{1} \neq \mu_{3}\text{ o } \mu_{2} \neq \mu_{3}
\end{array}
\right.
\]</span></p>
</div>
<p>Perquè les conclusions d’una ANOVA de blocs tenguin sentit cal que:</p>
<ul>
<li><p>Les <span class="math inline">\(k\cdot b\)</span> observacions constitueixin mostres aleatòries, cadascuna de mida 1, de les <span class="math inline">\(k\cdot b\)</span> poblacions definides per les parelles (tractament,bloc)</p></li>
<li><p>Aquestes <span class="math inline">\(k\cdot b\)</span> poblacions siguin totes normals, cada una amb mitjana <span class="math inline">\(\mu_{ij}\)</span>, on <span class="math inline">\(i\)</span> indica el tractament i <span class="math inline">\(j\)</span> indica el bloc, i totes amb la mateixa variància <span class="math inline">\(\sigma^2\)</span></p></li>
<li><p>No hi hagi <strong>interacció</strong> entre els blocs i els tractaments. Això significa que l’efecte dels blocs i els tractaments és <strong>additiu</strong>:
la diferència entre les mitjanes poblacionals de cada parella concreta de tractaments és la mateixa a cada bloc
<span class="math display">\[
\mu_{i_1j_1}-\mu_{i_2j_1}=\mu_{i_1j_2}-\mu_{i_2j_2}
\]</span></p>
<p>Per exemple, que no hi hagi interacció entre els blocs i els tractaments a l’Exemple <a href="chap-ANOVA.html#exm:esports">10.11</a> significa que:</p>
<ul>
<li>La diferència entre el consum energètic mitjà en córrer 1 km i en caminar 1 km és la mateixa a cada individu de la mostra</li>
<li>La diferència entre el consum energètic mitjà en córrer 1 km i en pedalar 1 km és la mateixa a cada individu de la mostra</li>
<li>La diferència entre el consum energètic mitjà en caminar 1 km i en pedalar 1 km és la mateixa a cada individu de la mostra</li>
</ul>
<p>En canvi, hi hauria interacció si, per exemple, la diferència entre el consum energètic mitjà en córrer i en caminar depengués de l’individu: si en uns la diferència fos més gran que en d’altres.</p></li>
</ul>

<div class="rmdnote">
<p>Observau que <span class="math inline">\(\mu_{i_1j_1}-\mu_{i_2j_1}=\mu_{i_1j_2}-\mu_{i_2j_2}\)</span> és equivalent a <span class="math inline">\(\mu_{i_1j_1}-\mu_{i_1j_2}=\mu_{i_2j_1}-\mu_{i_2j_2}\)</span>. Per tant, la interacció també es pot descriure intercanviant els blocs i els tractaments. En el nostre exemple, no hi hauria interacció si, per a cada parella d’individus de la mostra, fossin iguals:</p>
<ul>
<li>la diferència entre els seus consums energètics mitjans en córrer 1 km,</li>
<li>la diferència entre els seus consums energètics mitjans en caminar 1 km,</li>
<li>la diferència entre els seus consums energètics mitjans en pedalar 1 km.</li>
</ul>
</div>
<p>Amb un sol valor per cada parell (tractament,bloc), cap d’aquestes condicions necessàries per poder realitzar una ANOVA de blocs no es pot contrastar i per tant l’experimentador ha de decidir si se satisfan o no segons la seva experiència.</p>

<div class="rmdnote">
<p>Què significa això de la interacció entre dues variables?</p>
<p>Imaginau que podem administrar dos analgèsics, A i B, a dones i homes, i mesuram el temps que triguen en fer efecte. Diguem</p>
<ul>
<li><span class="math inline">\(\mu_{AD}\)</span>: temps mitjà que triga en fer efecte l’analgèsic A sobre les dones</li>
<li><span class="math inline">\(\mu_{BD}\)</span>: temps mitjà que triga en fer efecte l’analgèsic B sobre les dones</li>
<li><span class="math inline">\(\mu_{AH}\)</span>: temps mitjà que triga en fer efecte l’analgèsic A sobre els homes</li>
<li><span class="math inline">\(\mu_{BH}\)</span>: temps mitjà que triga en fer efecte l’analgèsic B sobre els homes</li>
</ul>
<p>Aleshores:</p>
<ul>
<li><p>No hi ha interacció entre els analgèsics i el sexe si la diferència en el temps mitjà en fer efecte A i B és la mateixa en les dones que en els homes:
<span class="math display">\[
\mu_{AD}-\mu_{BD}=  \mu_{AH}-\mu_{BH}
\]</span></p></li>
<li><p>En canvi, sí que hi ha interacció entre els analgèsics i el sexe quan aquestes dues diferències són diferents, la qual cosa significaria que la diferència d’efectivitat entre els dos analgèsics no és la mateixa en els homes que en les dones:
<span class="math display">\[
\mu_{AD}-\mu_{BD}\neq  \mu_{AH}-\mu_{BH}
\]</span></p></li>
</ul>
Fixau-vos que l’existència d’interacció no és equivalent al fet que un analgèsic sigui més efectiu en un sexe que en l’altre, per exemple més en les dones que en els homes: si l’altre analgèsic també és més efectiu en les dones que en els homes, pot ser que la diferència entre les mitjanes se mantengui i no hi hagi interacció.
</div>
<p>Recordarem algunes notacions, i n’introduïm algunes altres. Pel que fa a la població:</p>
<ul>
<li>Direm <span class="math inline">\(\mu_i\)</span> a la mitjana de la variable d’interès sobre la població definida pel tractament <span class="math inline">\(i\)</span>-èsim.</li>
<li>Direm <span class="math inline">\(\mu\)</span> a la mitjana de la variable d’interès sobre el total de la població, sense distingir tractaments.</li>
<li>Direm <span class="math inline">\(\mu_{\bullet j}\)</span> a la mitjana de la variable d’interès sobre el bloc <span class="math inline">\(j\)</span>-èsim.</li>
</ul>
<p>L’ANOVA de blocs se basa en el <strong>model</strong> següent: per a tots <span class="math inline">\(i=1,\ldots,k\)</span> i <span class="math inline">\(j=1,\ldots,b\)</span>
<span class="math display">\[
X_{ij}=\mu+ (\mu_{i}-\mu) +(\mu_{\bullet j}-\mu) + E_{ij} 
\]</span>
on:</p>
<ul>
<li><p><span class="math inline">\(X_{ij}\)</span> indica el valor de la variable <span class="math inline">\(X\)</span> per al tractament <span class="math inline">\(i\)</span>-èsim en el bloc <span class="math inline">\(j\)</span>-èsim.</p></li>
<li><p><span class="math inline">\(\mu_i-\mu\)</span> representa la desviació de la mitjana de <span class="math inline">\(X\)</span> en el nivell <span class="math inline">\(i\)</span>-èsim respecte de la mitjana global <span class="math inline">\(\mu\)</span> (l’<strong>efecte del tractament <span class="math inline">\(i\)</span>-èsim</strong>).</p></li>
<li><p><span class="math inline">\(\mu_{\bullet j}-\mu\)</span> representa la desviació de la mitjana de <span class="math inline">\(X\)</span> en el bloc <span class="math inline">\(j\)</span>-èsim respecte de la mitjana global <span class="math inline">\(\mu\)</span> (l’<strong>efecte del bloc <span class="math inline">\(j\)</span>-èsim</strong>).</p></li>
<li><p><span class="math inline">\(E_{ij}\)</span> representa la part de la diferència entre <span class="math inline">\(X_{ij}\)</span> i <span class="math inline">\(\mu\)</span> que no expliquen ni el tractament ni el bloc; en diem l’<strong>error aleatori</strong>, o el <strong>residu</strong>.</p></li>
</ul>
<p>Aquest model diu bàsicament que el valor de <span class="math inline">\(X\)</span> sobre un individu és la suma de quatre components:</p>
<ul>
<li>La mitjana global <span class="math inline">\(\mu\)</span> de <span class="math inline">\(X\)</span> sobre tota la població</li>
<li>L’efecte del tractament</li>
<li>L’efecte del bloc</li>
<li>L’error aleatori</li>
</ul>
<p>i per tant hi pressuposam que res més no influeix en el valor de <span class="math inline">\(X\)</span>, i en particular que l’efecte del bloc i el del tractament se sumen, sense que hi hagi interacció entre ells. Si això no és cert, és a dir, si aquest valor pot dependre d’altres efectes que no tinguem en compte o si hi ha interacció entre els blocs i els tractaments, el model no és vàlid, i les conclusions de l’ANOVA tampoc.</p>
<p>Pel que fa a la nostra mostra:</p>
<ul>
<li><p><span class="math inline">\(\overline{X}_{i}\)</span> és la mitjana mostral de la mostra del tractament <span class="math inline">\(i\)</span>-èsim
<span class="math display">\[
\overline{X}_{i}=\dfrac{\sum_{j=1}^b X_{ij}}{b}
\]</span>
Estima la mitjana poblacional del tractament <span class="math inline">\(i\)</span>-èsim, <span class="math inline">\(\mu_i\)</span>.</p></li>
<li><p><span class="math inline">\(\overline{X}_{\bullet j}\)</span> és la mitjana mostral de les mesures preses sobre el bloc <span class="math inline">\(j\)</span>-èsim
<span class="math display">\[
\overline{X}_{\bullet j}=\dfrac{\sum_{i=1}^k X_{ij}}{k}
\]</span>
Estima la mitjana poblacional del bloc <span class="math inline">\(j\)</span>-èsim, <span class="math inline">\(\mu_{\bullet j}\)</span>.</p></li>
<li><p><span class="math inline">\(\overline{X}\)</span> és la mitjana mostral de tota la mostra
<span class="math display">\[
\overline{X}=\dfrac{\sum_{i=1}^k\sum_{j=1}^b X_{ij}}{k\cdot b}
\]</span>
Estima la mitjana poblacional global, <span class="math inline">\(\mu\)</span>.</p></li>
</ul>

<div class="example">
<p><span id="exm:unnamed-chunk-702" class="example"><strong>Exemple 10.13  </strong></span>Tornem a l’Exemple <a href="chap-ANOVA.html#exm:esports">10.11</a>. Recordem que les dades eren</p>
</div>
<p><span class="math display">\[
\begin{array}{c}
\hphantom{Individu}\text{Tractament}\\
\begin{array}{c|ccc}
\text{Individu} &amp;\text{1 (corrent)} &amp;\text{2 (caminant)}&amp;\text{3 (pedalant)}\\
\hline
1&amp;1.4&amp;1.1&amp;0.7\\
2&amp;1.5&amp;1.2&amp;0.8\\
3&amp;1.8&amp;1.3&amp;0.7\\
4&amp;1.7&amp;1.3&amp;0.8\\
5&amp;1.6&amp;0.7&amp;0.1\\
6&amp;1.5&amp;1.2&amp;0.7\\
7&amp;1.7&amp;1.1&amp;0.4\\
8&amp;2.0&amp;1.3&amp;0.6\\ 
\end{array}
\end{array}
\]</span></p>
<p>Per tant les mitjanes serien, amb aquestes notacions</p>
<p><span class="math display">\[
\begin{array}{c}
\text{Tractament}\\
\begin{array}{c|ccc|c}
\text{Individu} &amp;\text{1 (corrent)} &amp;\text{2 (caminant)}&amp;\text{3 (pedalant)} &amp; \text{Mitjanes}\\
\hline
1&amp;1.4&amp;1.1&amp;0.7 &amp; \overline{X}_{\bullet1}\\
2&amp;1.5&amp;1.2&amp;0.8 &amp; \overline{X}_{\bullet2}\\
3&amp;1.8&amp;1.3&amp;0.7 &amp; \overline{X}_{\bullet3}\\
4&amp;1.7&amp;1.3&amp;0.8 &amp; \overline{X}_{\bullet4}\\
5&amp;1.6&amp;0.7&amp;0.1 &amp; \overline{X}_{\bullet5}\\
6&amp;1.5&amp;1.2&amp;0.7 &amp; \overline{X}_{\bullet6}\\
7&amp;1.7&amp;1.1&amp;0.4 &amp; \overline{X}_{\bullet7}\\
8&amp;2.0&amp;1.3&amp;0.6 &amp; \overline{X}_{\bullet8}\\ \hline
\text{Mitjanes} &amp; \overline{X}_{1} &amp; \overline{X}_{2} &amp; \overline{X}_{3} &amp; \overline{X}
\end{array}
\end{array}
\]</span></p>
<p>Anem a calcular-les. Emmagatzemarem les dades en un <em>dataframe</em> <code>Dades</code> de tres variables:</p>
<ul>
<li><strong>kilocal</strong>: les Kcal/Km consumides</li>
<li><strong>blocs</strong>: l’individu</li>
<li><strong>tracts</strong>: l’activitat</li>
</ul>
<p>Per poder després fer l’ANOVA amb R, aquests dos darrers han de ser factors. Com que entrarem les dades de la taula per fileres:</p>
<ul>
<li>El factor <strong>blocs</strong> ha de tenir la forma (1,1,1,2,2,2,3,3,3,…).</li>
<li>El factor <strong>tracts</strong> ha d’estar format per 8 còpies del vector (1,2,3), on 1 representa córrer, 2, caminar i 3, pedalar.</li>
</ul>
<div class="sourceCode" id="cb587"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb587-1"><a href="chap-ANOVA.html#cb587-1" aria-hidden="true" tabindex="-1"></a>kilocal<span class="ot">=</span><span class="fu">c</span>(<span class="fl">1.4</span>,<span class="fl">1.1</span>,<span class="fl">0.7</span>,<span class="fl">1.5</span>,<span class="fl">1.2</span>,<span class="fl">0.8</span>,<span class="fl">1.8</span>,<span class="fl">1.3</span>,<span class="fl">0.7</span>,<span class="fl">1.7</span>,<span class="fl">1.3</span>,<span class="fl">0.8</span>,</span>
<span id="cb587-2"><a href="chap-ANOVA.html#cb587-2" aria-hidden="true" tabindex="-1"></a>          <span class="fl">1.6</span>,<span class="fl">0.7</span>,<span class="fl">0.1</span>,<span class="fl">1.5</span>,<span class="fl">1.2</span>,<span class="fl">0.7</span>,<span class="fl">1.7</span>,<span class="fl">1.1</span>,<span class="fl">0.4</span>,<span class="fl">2.0</span>,<span class="fl">1.3</span>,<span class="fl">0.6</span>)</span>
<span id="cb587-3"><a href="chap-ANOVA.html#cb587-3" aria-hidden="true" tabindex="-1"></a>blocs<span class="ot">=</span><span class="fu">as.factor</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>,<span class="at">each=</span><span class="dv">3</span>))</span>
<span id="cb587-4"><a href="chap-ANOVA.html#cb587-4" aria-hidden="true" tabindex="-1"></a>blocs</span></code></pre></div>
<pre><code>##  [1] 1 1 1 2 2 2 3 3 3 4 4 4 5 5 5 6 6 6 7 7 7 8 8 8
## Levels: 1 2 3 4 5 6 7 8</code></pre>
<div class="sourceCode" id="cb589"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb589-1"><a href="chap-ANOVA.html#cb589-1" aria-hidden="true" tabindex="-1"></a>tracts<span class="ot">=</span><span class="fu">as.factor</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="at">times=</span><span class="dv">8</span>))</span>
<span id="cb589-2"><a href="chap-ANOVA.html#cb589-2" aria-hidden="true" tabindex="-1"></a>tracts</span></code></pre></div>
<pre><code>##  [1] 1 2 3 1 2 3 1 2 3 1 2 3 1 2 3 1 2 3 1 2 3 1 2 3
## Levels: 1 2 3</code></pre>
<div class="sourceCode" id="cb591"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb591-1"><a href="chap-ANOVA.html#cb591-1" aria-hidden="true" tabindex="-1"></a>Dades<span class="ot">=</span><span class="fu">data.frame</span>(kilocal,tracts,blocs)</span>
<span id="cb591-2"><a href="chap-ANOVA.html#cb591-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(Dades)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:	24 obs. of  3 variables:
##  $ kilocal: num  1.4 1.1 0.7 1.5 1.2 0.8 1.8 1.3 0.7 1.7 ...
##  $ tracts : Factor w/ 3 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;: 1 2 3 1 2 3 1 2 3 1 ...
##  $ blocs  : Factor w/ 8 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,..: 1 1 1 2 2 2 3 3 3 4 ...</code></pre>
<div class="sourceCode" id="cb593"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb593-1"><a href="chap-ANOVA.html#cb593-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Dades)</span></code></pre></div>
<pre><code>##   kilocal tracts blocs
## 1     1.4      1     1
## 2     1.1      2     1
## 3     0.7      3     1
## 4     1.5      1     2
## 5     1.2      2     2
## 6     0.8      3     2</code></pre>
<ul>
<li>Calculem les mitjanes mostrals dels tractaments, <span class="math inline">\(\overline{X}_i\)</span>:</li>
</ul>
<div class="sourceCode" id="cb595"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb595-1"><a href="chap-ANOVA.html#cb595-1" aria-hidden="true" tabindex="-1"></a>mitjanes.tracts<span class="ot">=</span><span class="fu">aggregate</span>(kilocal<span class="sc">~</span>tracts,<span class="at">data=</span>Dades,mean)</span>
<span id="cb595-2"><a href="chap-ANOVA.html#cb595-2" aria-hidden="true" tabindex="-1"></a>mitjanes.tracts</span></code></pre></div>
<pre><code>##   tracts kilocal
## 1      1    1.65
## 2      2    1.15
## 3      3    0.60</code></pre>
<ul>
<li>Calculem les mitjanes mostrals dels blocs, <span class="math inline">\(\overline{X}_{\bullet j}\)</span>:</li>
</ul>
<div class="sourceCode" id="cb597"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb597-1"><a href="chap-ANOVA.html#cb597-1" aria-hidden="true" tabindex="-1"></a>mitjanes.blocs<span class="ot">=</span><span class="fu">aggregate</span>(kilocal<span class="sc">~</span>blocs,<span class="at">data=</span>Dades,mean)</span>
<span id="cb597-2"><a href="chap-ANOVA.html#cb597-2" aria-hidden="true" tabindex="-1"></a>mitjanes.blocs</span></code></pre></div>
<pre><code>##   blocs  kilocal
## 1     1 1.066667
## 2     2 1.166667
## 3     3 1.266667
## 4     4 1.266667
## 5     5 0.800000
## 6     6 1.133333
## 7     7 1.066667
## 8     8 1.300000</code></pre>
<ul>
<li>Calculem la mitjana mostral global <span class="math inline">\(\overline{X}\)</span>:</li>
</ul>
<div class="sourceCode" id="cb599"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb599-1"><a href="chap-ANOVA.html#cb599-1" aria-hidden="true" tabindex="-1"></a>mitjana.total<span class="ot">=</span><span class="fu">mean</span>(Dades<span class="sc">$</span>kilocal)</span>
<span id="cb599-2"><a href="chap-ANOVA.html#cb599-2" aria-hidden="true" tabindex="-1"></a>mitjana.total</span></code></pre></div>
<pre><code>## [1] 1.133333</code></pre>
<p>A l’ANOVA de blocs s’hi té la identitat següent:</p>

<div class="theorem">
<p><span id="thm:SSblocs" class="theorem"><strong>Teorema 10.3  (Identitat de les sumes de quadrats)  </strong></span><span class="math display">\[
SS_{Total}=SS_{Tr}+SS_{Blocs}+SS_E
\]</span>
on</p>
<ul>
<li><p><span class="math inline">\(SS_{Total}=\displaystyle\sum\limits_{i=1}^k\sum\limits_{j=1}^b (X_{ij}- \overline{X})^2\)</span>; és la <strong>Suma Total de Quadrats</strong>.</p></li>
<li><p><span class="math inline">\(SS_{Tr}=\displaystyle b\sum\limits_{i=1}^k (\overline{X}_{i}-\overline{X})^2\)</span>; és la <strong>Suma de Quadrats dels Tractaments</strong>.</p></li>
<li><p><span class="math inline">\(SS_{Blocs}=\displaystyle k\sum\limits_{j=1}^b (\overline{X}_{\bullet j}-\overline{X})^2\)</span>; és la <strong>Suma de Quadrats dels Blocs</strong>.</p></li>
<li><p><span class="math inline">\(SS_E=\displaystyle\sum\limits_{i=1}^k\sum\limits_{j=1}^b (X_{ij} - \overline{X}_{i}- \overline{X}_{\bullet j}+\overline{X})^2\)</span>; és la <strong>Suma de Quadrats dels Residus</strong> o <strong>dels Errors</strong>.</p>
</div></li>
</ul>
<p>En aquesta identitat</p>
<ul>
<li><p><span class="math inline">\(SS_{Total}\)</span> representa la variabilitat total de les dades: és el numerador de la variància de la mostra total.</p></li>
<li><p><span class="math inline">\(SS_{Tr}\)</span> representa la variabilitat de les mitjanes dels tractaments: és igual al numerador de la variància d’una mostra formada per <span class="math inline">\(b\)</span> còpies de cada una de les mitjanes mostrals dels tractaments, <span class="math inline">\(\overline{X}_1,\overline{X}_2,\ldots,\overline{X}_k\)</span>.</p></li>
<li><p><span class="math inline">\(SS_{Tr}\)</span> representa la variabilitat de les mitjanes dels blocs: és igual al numerador de la variància d’una mostra formada per <span class="math inline">\(k\)</span> còpies de cada una de les mitjanes mostrals dels blocs, <span class="math inline">\(\overline{X}_{\bullet 1},\overline{X}_{\bullet 2},\ldots,\overline{X}_{\bullet b}\)</span>.</p></li>
<li><p><span class="math inline">\(SS_E\)</span> representa la “resta de la variabilitat”.</p></li>
</ul>

<div class="rmdnote">
<p>Si se satisfà el model de l’ANOVA de blocs
<span class="math display">\[
X_{ij}=\mu+ (\mu_{i}-\mu) +(\mu_{\bullet j}-\mu) + E_{ij}  
\]</span>
aleshores
<span class="math display">\[
E_{ij}=X_{ij}-\mu_{i}-\mu_{\bullet j}+\mu
\]</span>
Veiem així que <span class="math inline">\(SS_E\)</span> és la suma dels quadrats de les estimacions d’aquests errors aleatoris per als individus de la nostra mostra.</p>
</div>
<p>Per tant
<span class="math display">\[
SS_{Total}=SS_{Tr}+SS_{Blocs}+SS_E
\]</span>
bàsicament diu que en una ANOVA de blocs</p>
<blockquote>
<p>la variabilitat total descompon en la suma de la variabilitat de les mitjanes dels tractaments més la variabilitat de les mitjanes dels blocs més la variabilitat “residual”.</p>
</blockquote>

<div class="example">
<p><span id="exm:unnamed-chunk-708" class="example"><strong>Exemple 10.14  </strong></span>Tornem a l’Exemple <a href="chap-ANOVA.html#exm:esports">10.11</a>. Recordem les dades que ja tenim:</p>
</div>
<div class="sourceCode" id="cb601"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb601-1"><a href="chap-ANOVA.html#cb601-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(Dades)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:	24 obs. of  3 variables:
##  $ kilocal: num  1.4 1.1 0.7 1.5 1.2 0.8 1.8 1.3 0.7 1.7 ...
##  $ tracts : Factor w/ 3 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;: 1 2 3 1 2 3 1 2 3 1 ...
##  $ blocs  : Factor w/ 8 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,..: 1 1 1 2 2 2 3 3 3 4 ...</code></pre>
<div class="sourceCode" id="cb603"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb603-1"><a href="chap-ANOVA.html#cb603-1" aria-hidden="true" tabindex="-1"></a>k<span class="ot">=</span><span class="dv">3</span>  <span class="co">#Nombre de tractaments</span></span>
<span id="cb603-2"><a href="chap-ANOVA.html#cb603-2" aria-hidden="true" tabindex="-1"></a>b<span class="ot">=</span><span class="dv">8</span>  <span class="co">#Nombre de blocs</span></span>
<span id="cb603-3"><a href="chap-ANOVA.html#cb603-3" aria-hidden="true" tabindex="-1"></a>mitjanes.tracts  <span class="co">#Mitjanes de tractaments</span></span></code></pre></div>
<pre><code>##   tracts kilocal
## 1      1    1.65
## 2      2    1.15
## 3      3    0.60</code></pre>
<div class="sourceCode" id="cb605"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb605-1"><a href="chap-ANOVA.html#cb605-1" aria-hidden="true" tabindex="-1"></a>mitjanes.blocs  <span class="co">#Mitjanes de blocs</span></span></code></pre></div>
<pre><code>##   blocs  kilocal
## 1     1 1.066667
## 2     2 1.166667
## 3     3 1.266667
## 4     4 1.266667
## 5     5 0.800000
## 6     6 1.133333
## 7     7 1.066667
## 8     8 1.300000</code></pre>
<div class="sourceCode" id="cb607"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb607-1"><a href="chap-ANOVA.html#cb607-1" aria-hidden="true" tabindex="-1"></a>mitjana.total  <span class="co"># Mitjana global</span></span></code></pre></div>
<pre><code>## [1] 1.133333</code></pre>
<ul>
<li>Calculem la suma total de quadrats
<span class="math display">\[
SS_{Total}=\sum\limits_{i=1}^k\sum\limits_{j=1}^b (X_{ij}- \overline{X})^2
\]</span></li>
</ul>
<div class="sourceCode" id="cb609"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb609-1"><a href="chap-ANOVA.html#cb609-1" aria-hidden="true" tabindex="-1"></a>SS.Tot<span class="ot">=</span><span class="fu">sum</span>((kilocal<span class="sc">-</span>mitjana.total)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb609-2"><a href="chap-ANOVA.html#cb609-2" aria-hidden="true" tabindex="-1"></a>SS.Tot</span></code></pre></div>
<pre><code>## [1] 5.353333</code></pre>
<ul>
<li>Calculem la suma de quadrats dels tractaments
<span class="math display">\[
SS_{Tr}=b\sum\limits_{i=1}^k (\overline{X}_{i}-\overline{X})^2
\]</span>
Recordau que el vector <span class="math inline">\((\overline{X}_{1},\overline{X}_{2},\overline{X}_{3})\)</span> és la variable <strong>kilocal</strong> de <code>mitjanes.tracts</code>.</li>
</ul>
<div class="sourceCode" id="cb611"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb611-1"><a href="chap-ANOVA.html#cb611-1" aria-hidden="true" tabindex="-1"></a>SS.Tr<span class="ot">=</span>b<span class="sc">*</span><span class="fu">sum</span>((mitjanes.tracts<span class="sc">$</span>kilocal<span class="sc">-</span>mitjana.total)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb611-2"><a href="chap-ANOVA.html#cb611-2" aria-hidden="true" tabindex="-1"></a>SS.Tr</span></code></pre></div>
<pre><code>## [1] 4.413333</code></pre>
<ul>
<li>Calculem la suma de quadrats dels blocs
<span class="math display">\[
SS_{Blocs}=k\sum\limits_{j=1}^b (\overline{X}_{\bullet j}-\overline{X})^2
\]</span>
Recordau que el vector <span class="math inline">\((\overline{X}_{\bullet 1},\ldots,\overline{X}_{\bullet b})\)</span> és la variable <strong>kilocal</strong> de <code>mitjanes.blocs</code>.</li>
</ul>
<div class="sourceCode" id="cb613"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb613-1"><a href="chap-ANOVA.html#cb613-1" aria-hidden="true" tabindex="-1"></a>SS.Bl<span class="ot">=</span>k<span class="sc">*</span><span class="fu">sum</span>((mitjanes.blocs<span class="sc">$</span>kilocal<span class="sc">-</span>mitjana.total)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb613-2"><a href="chap-ANOVA.html#cb613-2" aria-hidden="true" tabindex="-1"></a>SS.Bl</span></code></pre></div>
<pre><code>## [1] 0.5533333</code></pre>
<ul>
<li><p>Calculem la suma de quadrats dels residus
<span class="math display">\[
SS_E=\sum\limits_{i=1}^k\sum\limits_{j=1}^b (X_{ij} - \overline{X}_{i}- \overline{X}_{\bullet j}+\overline{X})^2
\]</span>
Per calcular aquesta suma, procedirem com al càlcul de la <span class="math inline">\(SS_E\)</span> de l’ANOVA d’1 via, tenint en compte que</p>
<ul>
<li><p>Les entrades de <code>Dades$kilocal</code> que difereixen en un múltiple de 3 són del mateix tractament: per exemple, la 1a, la 4a, la 7a etc. corresponen al tractament 1 (córrer). Si a <code>Dades$kilocal</code> li restam el vector de les mitjanes del tractaments, <code>mitjanes.tracts$kilocal</code>, en realitat estam dient a R que li resti 8 còpies consecutives d’aquest vector, i per tant a cada entrada de <code>Dades$kilocal</code> li restam la mitjana del seu tractament.</p></li>
<li><p>Cada grup de 3 entrades consecutives de <code>Dades$kilocal</code> corresponen a un bloc: les tres primeres al bloc 1, les tres següents al bloc 2 etc. Per tant, per restar a cada entrada de <code>Dades$kilocal</code> la mitjana del bloc corresponent, li hem de restar <code>rep(mitjanes.blocs$kilocal,each=3)</code>.</p></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb615"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb615-1"><a href="chap-ANOVA.html#cb615-1" aria-hidden="true" tabindex="-1"></a>SSE<span class="ot">=</span><span class="fu">sum</span>((Dades<span class="sc">$</span>kilocal<span class="sc">-</span>mitjanes.tracts<span class="sc">$</span>kilocal</span>
<span id="cb615-2"><a href="chap-ANOVA.html#cb615-2" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span><span class="fu">rep</span>(mitjanes.blocs<span class="sc">$</span>kilocal,<span class="at">each=</span><span class="dv">3</span>)<span class="sc">+</span>mitjana.total)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb615-3"><a href="chap-ANOVA.html#cb615-3" aria-hidden="true" tabindex="-1"></a>SSE</span></code></pre></div>
<pre><code>## [1] 0.3866667</code></pre>
<p>Comprovem la identitat de les sumes de quadrats:</p>
<div class="sourceCode" id="cb617"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb617-1"><a href="chap-ANOVA.html#cb617-1" aria-hidden="true" tabindex="-1"></a>SS.Tot</span></code></pre></div>
<pre><code>## [1] 5.353333</code></pre>
<div class="sourceCode" id="cb619"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb619-1"><a href="chap-ANOVA.html#cb619-1" aria-hidden="true" tabindex="-1"></a>SS.Tr<span class="sc">+</span>SS.Bl<span class="sc">+</span>SSE</span></code></pre></div>
<pre><code>## [1] 5.353333</code></pre>
<p>A partir d’aquí, tot funciona com a l’ANOVA d’1 via. Al contrast
<span class="math display">\[
\left\{
\begin{array}{l}
H_0 :  \mu_{1}=\cdots =\mu_{k} \\
H_1 : \text{Hi ha } i,j=1,\ldots ,k \text{ tals que }  \mu_{i}\neq \mu_{j}
\end{array}
\right.
\]</span>
rebutjarem la hipòtesi nul·la si <span class="math inline">\(SS_{Tr}\)</span> és prou més gran que <span class="math inline">\(SS_{E}\)</span>. Per mesurar-ho,
emprarem els estadístics següents:</p>
<ul>
<li><p><strong>Quadrat mitjà dels tractaments</strong>:
<span class="math display">\[
MS_{Tr}=\dfrac{SS_{Tr}}{k-1}
\]</span></p></li>
<li><p><strong>Quadrat mitjà dels errors</strong>:
<span class="math display">\[
MS_E = \dfrac{SS_E}{(b-1) (k-1)}
\]</span>
Fixau-vos que el denominador és diferent que al <span class="math inline">\(MS_E\)</span> de l’ANOVA d’1 via.</p></li>
<li><p>A més, R calcula el <strong>Quadrat mitjà dels blocs</strong>, que nosaltres no farem servir però que definim perquè sapigueu què és:
<span class="math display">\[
MS_{Blocs}=\dfrac{SS_{Blocs}}{b-1}
\]</span></p></li>
</ul>
<p>Si se satisfan les condicions necessàries que hem esmentat perquè l’ANOVA es pugui realitzar, es té que
<span class="math display">\[
\begin{array}{l}
E(MS_{Tr})=\sigma^2 + \dfrac{b}{k-1}\sum\limits_{i=1}^k (\mu_{i}-\mu)^2 \\
E(MS_E)=\sigma^2
\end{array}
\]</span>
on <span class="math inline">\(\sigma^2\)</span> indica la variància comuna de totes les poblacions definides per les parelles (tractament,bloc). Per tant, <span class="math inline">\(MS_E\)</span> torna a ser un estimador no esbiaixat d’aquesta <span class="math inline">\(\sigma^2\)</span>.</p>
<p>Aleshores, com a l’ANOVA d’1 via, si <span class="math inline">\(H_0:\mu_{1}=\cdots =\mu_{k}(=\mu)\)</span> és certa,
<span class="math display">\[
\sum\limits_{i=1}^k (\mu_{i}-\mu)^2 = 0,
\]</span>
i per tant <span class="math inline">\(E(MS_{Tr})=E(MS_E)\)</span>, mentre que si <span class="math inline">\(H_0\)</span> no és certa
<span class="math display">\[
\sum\limits_{i=1}^k (\mu_{i}-\mu)^2 &gt; 0
\]</span>
cas en el qual <span class="math inline">\(E(MS_{Tr})&gt;E(MS_E)\)</span>.</p>
<p>Aleshores prendrem com a <strong>estadístic de contrast</strong> el quocient
<span class="math display">\[
F=\frac{MS_{Tr}}{MS_E}
\]</span>
Si <span class="math inline">\(H_0\)</span> és certa:</p>
<ul>
<li>La seva distribució és F de Fisher amb <span class="math inline">\(k-1\)</span> i <span class="math inline">\((k-1)(b-1)\)</span> graus de llibertat, <span class="math inline">\(F_{k-1,(k-1)(b-1)}\)</span>.</li>
</ul>

<div class="rmdimportant">
En general, els graus de llibertat de l’estadístic F d’una ANOVA, sigui del tipus que sigui, són els denominadors emprats en les definicions dels quadrats mitjans del numerador i el denominador.
</div>
<ul>
<li>El seu valor és proper a 1.</li>
</ul>
<p>I per tant rebutjarem la hipòtesi nul·la si el valor <span class="math inline">\(F_0\)</span> de F sobre la nostra mostra és prou més gran que 1, la qual cosa decidirem comparant el p-valor <span class="math inline">\(P(F_{k-1,(k-1)(b-1)}\geqslant F_0)\)</span> amb el nivell de significació <span class="math inline">\(\alpha\)</span>.</p>
<p>En resum, per realitzar una ANOVA de blocs a partir d’una mostra:</p>
<ul>
<li><p>Calculam <span class="math inline">\(SS_{Tr},SS_E\)</span></p></li>
<li><p>Calculam <span class="math inline">\(MS_{Tr},MS_E\)</span></p></li>
<li><p>Calculam el valor <span class="math inline">\(F_0\)</span> de l’estadístic de contrast
<span class="math display">\[
F=\frac{MS_{Tr}}{MS_E}
\]</span></p></li>
<li><p>Calculam el p-valor
<span class="math display">\[
P(F_{k-1,(k-1)(b-1)}\geqslant F_0)
\]</span></p></li>
<li><p>Si aquest p-valor és més petit que el nivell de significació <span class="math inline">\(\alpha\)</span>, rebutjam <span class="math inline">\(H_0\)</span> i concloem que no totes les mitjanes són iguals. En cas contrari, acceptam que totes les mitjanes són iguals.</p></li>
</ul>
<p>Totes aquestes dades se solen recollir en la <strong>taula ANOVA</strong> següent:
<span class="math display">\[
\begin{array}{llllll}
\hline
\text{Origen de la}&amp;\text{Graus de}&amp;\text{Sumes de}&amp;\text{Quadrats} &amp; \text{Estadístic de}&amp;\text{p-valor}\\[-0.5ex]
\text{variabilitat}&amp;\text{llibertat}&amp;\text{quadrats}&amp;\text{mitjans}&amp;\text{contrast} &amp; \\\hline
\text{Tractaments} &amp; k-1 &amp; SS_{Tr}&amp; MS_{Tr}  &amp; F &amp; \text{p-valor} \\
\text{Blocs} &amp; b-1 &amp; SS_{Blocs} &amp; MS_{Blocs} &amp; \\ 
\text{Residus} &amp; (k-1)(b-1) &amp; SS_E &amp; MS_E &amp; \\\hline
\end{array}
\]</span></p>

<div class="example">
<p><span id="exm:unnamed-chunk-716" class="example"><strong>Exemple 10.15  </strong></span>Tornem al nostre Exemple <a href="chap-ANOVA.html#exm:esports">10.11</a>. Ja hem calculat:</p>
</div>
<p><span class="math display">\[
\begin{array}{cccccc}
k &amp; b &amp; SS_{Total} &amp; SS_{Tr} &amp; SS_{Blocs} &amp; SS_E\\ \hline
3 &amp; 8 &amp; 5.3533  &amp; 4.4133 &amp; 0.5533  &amp; 0.3867
\end{array}
\]</span>
Aleshores:</p>
<ul>
<li><p><span class="math inline">\(MS_{Tr}=\dfrac{SS_{Tr}}{k-1}=2.2066\)</span></p></li>
<li><p><span class="math inline">\(MS_{Blocs}=\dfrac{SS_{Blocs}}{b-1}=0.079\)</span></p></li>
<li><p><span class="math inline">\(MS_E = \dfrac{SS_E}{(b-1) (k-1)}=0.0276\)</span></p></li>
<li><p><span class="math inline">\(F=\dfrac{MS_{Tr}}{MS_E}=79.949\)</span></p></li>
<li><p>p-valor: <span class="math inline">\(P(F_{2,14}\geqslant 79.949)=2\cdot 10^{-8}\)</span></p></li>
<li><p><em>Conclusió</em>: Hem obtingut evidència estadística que no és cert que les tres activitats tenguin el mateix consum energètic mitjà per km (ANOVA de blocs, p-valor 2·10<sup>-8</sup>)</p></li>
</ul>
<p>La taula ANOVA d’aquest exemple és</p>
<p><span class="math display">\[
\begin{array}{llllll}
\hline
\text{Origen de la}&amp;\text{Graus de}&amp;\text{Sumes de}&amp;\text{Quadrats} &amp; \text{Estadístic de}&amp;\text{p-valor}\\[-0.5ex]
\text{variabilitat}&amp;\text{llibertat}&amp;\text{quadrats}&amp;\text{mitjans}&amp;\text{contrast} &amp; \\\hline
\text{Tractaments} &amp; 2 &amp;  4.4133&amp;2.2067&amp;79.949 &amp; 2\cdot 10^{-8} \\
\text{Blocs} &amp; 7 &amp; 0.5533&amp;0.079&amp; &amp; \\ 
\text{Residus} &amp; 14 &amp; 0.3867&amp;0.0276&amp; &amp; \\\hline
\end{array}
\]</span></p>
</div>
<div id="amb-r-1" class="section level3" number="10.3.2">
<h3><span class="header-section-number">10.3.2</span> Amb R</h3>
<p>L’ANOVA de blocs s’efectua amb R aplicant <code>summary(aov( ))</code> a la fórmula que separa la variable numèrica per la <strong>suma dels factors que representen els tractaments i els blocs</strong>. Així, l’ANOVA de blocs de l’Exemple <a href="chap-ANOVA.html#exm:esports">10.11</a> es fa amb</p>
<div class="sourceCode" id="cb621"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb621-1"><a href="chap-ANOVA.html#cb621-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(Dades<span class="sc">$</span>kilocal<span class="sc">~</span>Dades<span class="sc">$</span>tracts<span class="sc">+</span>Dades<span class="sc">$</span>blocs))</span></code></pre></div>
<pre><code>##              Df Sum Sq Mean Sq F value  Pr(&gt;F)    
## Dades$tracts  2  4.413  2.2067  79.897 2.2e-08 ***
## Dades$blocs   7  0.553  0.0790   2.862  0.0446 *  
## Residuals    14  0.387  0.0276                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>o, equivalentment, amb</p>
<div class="sourceCode" id="cb623"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb623-1"><a href="chap-ANOVA.html#cb623-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(kilocal<span class="sc">~</span>tracts<span class="sc">+</span>blocs, <span class="at">data=</span>Dades))</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value  Pr(&gt;F)    
## tracts       2  4.413  2.2067  79.897 2.2e-08 ***
## blocs        7  0.553  0.0790   2.862  0.0446 *  
## Residuals   14  0.387  0.0276                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Obtenim la taula d’abans (llevat d’una petita diferència en la F deguda a que als càlculs a mà hem arrodonit pel camí) amb dues entrades més: l’estadístic de contrast i el p-valor de la filera <code>blocs</code>, que corresponen al contrast sobre hi ha diferència o no entre les mitjanes dels blocs (en aquest exemple, els consums mitjans energètics per km dels individus de la mostra en desplaçar-se de qualsevol de les tres maneres).</p>
</div>
<div id="comparacions-posteriors-per-parelles-1" class="section level3" number="10.3.3">
<h3><span class="header-section-number">10.3.3</span> Comparacions posteriors per parelles</h3>
<p>Com en el cas d’1 via, si rebutjam la hipòtesi nul·la, podem demanar-nos quins són els tractaments que tenen mitjanes diferents.
Ho podem respondre fent un test t per a cada parella de tractaments <strong>emprant mostres aparellades</strong> i ajustant el p-valor (per Bonferroni, Holm…). No donarem els detalls de les fórmules, simplement heu de saber que amb R es fa com a l’ANOVA d’1 via: amb la funció <code>pairwise.t.test</code>, però ara indicant-hi que <code>paired=TRUE</code>.</p>

<div class="example">
<p><span id="exm:unnamed-chunk-719" class="example"><strong>Exemple 10.16  </strong></span>A l’experiment de l’Exemple <a href="chap-ANOVA.html#exm:esports">10.11</a> hem arribat a la conclusió que no totes les mitjanes són iguals. Emprem un contrast posterior per parelles amb l’ajust de Bonferroni per esbrinar quines són diferents.</p>
</div>
<div class="sourceCode" id="cb625"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb625-1"><a href="chap-ANOVA.html#cb625-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.t.test</span>(Dades<span class="sc">$</span>kilocal, Dades<span class="sc">$</span>tracts, <span class="at">paired=</span><span class="cn">TRUE</span>, <span class="at">p.adjust.method=</span><span class="st">&quot;bonferroni&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 	Pairwise comparisons using paired t tests 
## 
## data:  Dades$kilocal and Dades$tracts 
## 
##   1       2      
## 2 0.00108 -      
## 3 0.00011 1.1e-05
## 
## P value adjustment method: bonferroni</code></pre>
<p><em>Conclusió</em>: Hem obtingut evidència estadística que les tres activitats tenen consum energètic mitjà per km diferent (ANOVA de blocs, test posterior de Bonferroni, p-valors ajustats inferiors a 0.0011)</p>
</div>
<div id="contrast-no-paramètric" class="section level3" number="10.3.4">
<h3><span class="header-section-number">10.3.4</span> Contrast no paramètric</h3>
<p>Si en un experiment amb disseny d’ANOVA de blocs no podem aplicar l’ANOVA perquè sospitem que no se satisfan les condicions necessàries, <strong>cal emprar un test no paramètric</strong>. El més popular és el <strong>test de Friedman</strong>, que generalitza el test de Wilcoxon a més de 2 mostres aparellades. En R està implementat en la funció <code>friedman.test</code> que s’aplica a la mateixa fórmula que <code>summary(aov( ))</code> excepte que cal substituir-hi la suma “+” per una barra vertical “|”. Per exemple:</p>
<div class="sourceCode" id="cb627"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb627-1"><a href="chap-ANOVA.html#cb627-1" aria-hidden="true" tabindex="-1"></a><span class="fu">friedman.test</span>(kilocal<span class="sc">~</span>tracts<span class="sc">|</span>blocs,<span class="at">data=</span>Dades)</span></code></pre></div>
<pre><code>## 
## 	Friedman rank sum test
## 
## data:  kilocal and tracts and blocs
## Friedman chi-squared = 16, df = 2, p-value = 0.0003355</code></pre>
<p>La conclusió és la mateixa que abans: No tots els consums energètics mitjans són iguals (test de Friedman, p-valor 0.0003).</p>
<p>Si ara volem realitzar els tests posteriors per parelles, el més adient és emprar en tots ells el test de Wilcoxon, amb la funció <code>pairwise.wilcox.test</code> que ja empràvem a l’ANOVA d’1 via, però ara amb <code>paired=TRUE</code>:</p>
<div class="sourceCode" id="cb629"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb629-1"><a href="chap-ANOVA.html#cb629-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.wilcox.test</span>(Dades<span class="sc">$</span>kilocal, Dades<span class="sc">$</span>tracts, <span class="at">paired =</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## 
## 	Pairwise comparisons using Wilcoxon signed rank test with continuity correction 
## 
## data:  Dades$kilocal and Dades$tracts 
## 
##   1     2    
## 2 0.042 -    
## 3 0.042 0.042
## 
## P value adjustment method: holm</code></pre>
<p>Obtenim evidència estadística que les tres activitats tenen consums energètics mitjans diferents (test de Friedman, test posterior per parelles de Wilcoxon amb ajust de Holm, p-valors ajustats 0.042).</p>
</div>
</div>
<div id="anova-de-2-vies" class="section level2" number="10.4">
<h2><span class="header-section-number">10.4</span> ANOVA de 2 vies</h2>
<p>Amb l’ANOVA d’1 via comparàvem les mitjanes de més de 2 subpoblacions definides pels nivells d’un únic factor. Ara ens interessa el cas quan aquestes subpoblacions estan definides combinant els nivells de més d’un factor. Es diu en aquest cas que el disseny de l’experiment és d’<strong>ANOVA factorial</strong>. Nosaltres aquí explicarem només el cas més senzill, quan s’empren només 2 factors (<strong>2 vies</strong>). A més, per simplificar, només considerarem el cas que totes les mostres de cada combinació de nivells d’un factor i de l’altre tenen la mateixa mida.</p>
<p>Per tant, en un experiment amb <strong>disseny d’ANOVA de 2 vies</strong>:</p>
<ul>
<li><p>Tenim una variable aleatòria <span class="math inline">\(X\)</span>.</p></li>
<li><p>Classificam la població segons les combinacions dels nivells de dos factors.</p></li>
<li><p>Prenem una m.a.s. de cada combinació de nivells, independents i totes de la mateixa mida, i hi mesuram la variable <span class="math inline">\(X\)</span>.</p></li>
</ul>
<div id="contrast-bàsic-2" class="section level3" number="10.4.1">
<h3><span class="header-section-number">10.4.1</span> Contrast bàsic</h3>
<p>Comencem amb un exemple.</p>

<div class="example">
<p><span id="exm:gupis" class="example"><strong>Exemple 10.17  </strong></span>S’havien observat diferències estacionals en el desenvolupament de les gònades d’una espècie de peixos que viuen als llacs africans, i es volia saber si això era conseqüència de la diferència entre estacions en hores de llum o en temperatura. Per decidir-ho, en un experiment s’intentà determinar l’efecte de la llum i la temperatura sobre l’índex gonadosomàtic o <em>GSI</em> (una mesura de creixement de l’ovari) d’aquesta espècie de peixos. S’hi van utilitzar dos fotoperíodes (l’estival, 14 hores de llum i 10 hores de foscor; i l’hivernal, 9 hores de llum i 15 hores de foscor) i dues temperatures (l’estival, 27<sup>o</sup> C, i l’hivernal, 16<sup>o</sup> C). En concret, com diem, es volia determinar si el GSI mitjà depèn del fotoperíode, o de la temperatura, o de la combinació dels dos tractaments, i si a més hi ha interacció entre ells, en el sentit que en alguna combinació de nivells dels dos tractaments els dos efectes no s’acumulin, sinó que l’efecte final sigui més gran, o més petit, que la suma dels dos efectes per separat.</p>
</div>
<p>L’experiment es va realitzar sobre 20 femelles recent nascudes. Es van dividir aleatòriament en 4 subgrups de 5 exemplars cadascun. Cada grup va rebre una combinació diferent de llum i temperatura. Als 3 mesos es mesuraren els seus GSI.</p>
<p>Els resultats obtinguts varen ser:</p>
<p><span class="math display">\[
\begin{array}{c}
\hphantom{(temperatura)}\text{Factor A}\\
\hphantom{(temperatura)}\text{(hores de llum)}\\
\begin{array}{c|cc}
\text{Factor B} &amp; \text{9 hores}&amp;  \text{14 hores}\\
\text{(temperatura)}&amp; &amp;\\\hline
16^\circ &amp;1.30&amp;1.01\\
&amp;2.88&amp;1.52\\
&amp;2.42&amp;1.02\\
&amp;2.66&amp;1.32\\
&amp;2.94&amp;1.63\\\hline
27^\circ &amp;0.90&amp;0.83\\
&amp;1.06&amp;0.67\\
&amp;0.98&amp;0.57\\
&amp;1.29&amp;0.47\\
&amp;1.12&amp;0.66\\ 
\end{array}
\end{array}
\]</span></p>
<p>El disseny experimental d’aquest estudi és d’ANOVA de 2 vies:</p>
<ul>
<li><p>La variable aleatòria d’interès <span class="math inline">\(X\)</span> és el GSI d’un peix (femella) de 3 mesos.</p></li>
<li><p>Classificam la població (els peixos) segons les combinacions dels nivells de dos factors (A: el foto-període; B: la temperatura).</p></li>
<li><p>Prenem una m.a.s. de cada combinació de nivells, independents i totes de la mateixa mida, i mesuram el GSI dels individus seleccionats.</p></li>
</ul>
<p>La situació general en una ANOVA de 2 vies serà la següent:</p>
<ul>
<li><p>Tenim en compte dos factors, A i B. El factor A té <span class="math inline">\(a\)</span> nivells (o <strong>tractaments</strong>, recordau) i el factor B, <span class="math inline">\(b\)</span> nivells.</p>
<p>En el nostre exemple, <span class="math inline">\(a=b=2\)</span>.</p></li>
<li><p>Fem <span class="math inline">\(n\)</span> observacions de cada combinació de tractaments, un de cada factor. El nombre total d’observacions serà per tant <span class="math inline">\(N=n\cdot a\cdot b\)</span>.</p>
<p>En el nostre exemple, <span class="math inline">\(n=5\)</span> i <span class="math inline">\(N=20\)</span>.</p></li>
<li><p>Indicarem amb <span class="math inline">\(X_{ijk}\)</span>, <span class="math inline">\(i=1,\ldots,a\)</span>, <span class="math inline">\(j=1,\ldots,b\)</span>, <span class="math inline">\(k=1,\ldots,n\)</span>, el valor de la variable <span class="math inline">\(X\)</span> en el <span class="math inline">\(k\)</span>-èsim subjecte de la mostra corresponent al nivell <span class="math inline">\(i\)</span>-èsim del factor A i el nivell <span class="math inline">\(j\)</span>-èsim del factor B.</p></li>
<li><p>Donarem les dades en una taula d’aquest estil:</p></li>
</ul>
<p><span class="math display">\[
\begin{array}{c}
\hphantom{Factor B}\text{Factor A}\\
\begin{array}{c|cccc}
\text{Factor B} &amp; 1&amp; 2 &amp; \ldots &amp; a\\
\hline
1&amp;X_{111}&amp;X_{211}&amp;\cdots&amp;X_{a11}\\
&amp;X_{112}&amp;X_{212}&amp;\cdots&amp;X_{a12}\\
&amp;\cdots&amp;\cdots&amp;\cdots&amp;\cdots\\
&amp;X_{11n}&amp;X_{21n}&amp;\cdots&amp;X_{a1n}\\\hline
2&amp;X_{121}&amp;X_{221}&amp;\cdots&amp;X_{a21}\\
&amp;X_{122}&amp;X_{222}&amp;\cdots&amp;X_{a22}\\
&amp;\cdots&amp;\cdots&amp;\cdots&amp;\cdots\\
&amp;X_{12n}&amp;X_{22n}&amp;\cdots&amp;X_{a2n}\\\hline
\vdots&amp;\vdots&amp;\vdots&amp;\vdots&amp;\vdots\\ 
\vdots&amp;\vdots&amp;\vdots&amp;\vdots&amp;\vdots\\\hline
b&amp;X_{1b1}&amp;X_{2b1}&amp;\cdots&amp;X_{ab1}\\
&amp;X_{1b2}&amp;X_{2b2}&amp;\cdots&amp;X_{ab2}\\
&amp;\cdots&amp;\cdots&amp;\cdots&amp;\cdots\\
&amp;X_{1bn}&amp;X_{2bn}&amp;\cdots&amp;X_{abn}\\\hline
\end{array}
\end{array}
\]</span></p>
<p>Perquè tengui sentit realitzar una ANOVA de 2 vies sobre aquestes dades, s’han de satisfer les condicions següents:</p>
<ul>
<li><p>Les observacions per a cada combinació de nivells constitueixen mostres aleatòries simples independents, totes de la mateixa mida <span class="math inline">\(n\geqslant 2\)</span>.</p></li>
<li><p>Cadascuna de les <span class="math inline">\(a\cdot b\)</span> subpoblacions definides per les combinacions de tractaments, un de cada factor, és normal.</p></li>
<li><p><strong>Homocedasticitat</strong>: Totes aquestes subpoblacions tenen la mateixa variància, que indicarem amb <span class="math inline">\(\sigma^2\)</span>.</p></li>
</ul>
<p>Els paràmetres que intervindran en el contrast són:</p>
<ul>
<li><p><span class="math inline">\(\mu\)</span>: la mitjana poblacional global.</p></li>
<li><p><span class="math inline">\(\mu_{i\bullet}\)</span>: la mitjana poblacional del nivell <span class="math inline">\(i\)</span>-èsim del factor A.</p></li>
<li><p><span class="math inline">\(\mu_{\bullet j}\)</span>: mitjana poblacional del nivell <span class="math inline">\(j\)</span>-èsim del factor B.</p></li>
<li><p><span class="math inline">\(\mu_{ij}\)</span>: mitjana poblacional de la combinació <span class="math inline">\((i,j)\)</span> de nivells d’A i B.</p></li>
</ul>
<p>L’ANOVA de 2 vies se basa en el <strong>model</strong> següent: per a tots <span class="math inline">\(i=1,\ldots,a\)</span> i <span class="math inline">\(j=1,\ldots,b\)</span>
<span class="math display">\[
X_{ij}=\mu+ \alpha_i +\beta_j + (\alpha\beta)_{ij}+E_{ij} 
\]</span>
on:</p>
<ul>
<li><p><span class="math inline">\(X_{ij}\)</span> indica el valor de la variable <span class="math inline">\(X\)</span> sobre un individu que pertany al nivell <span class="math inline">\(i\)</span>-èsim del factor A i al nivell <span class="math inline">\(j\)</span>-èsim del factor B.</p></li>
<li><p><span class="math inline">\(\alpha_i=\mu_{i\bullet}-\mu\)</span> representa la desviació de la mitjana de <span class="math inline">\(X\)</span> en el nivell <span class="math inline">\(i\)</span>-èsim del factor A respecte de la mitjana global <span class="math inline">\(\mu\)</span> (l’<strong>efecte del tractament <span class="math inline">\(i\)</span>-èsim del factor A</strong>).</p></li>
<li><p><span class="math inline">\(\beta_j=\mu_{\bullet j}-\mu\)</span> representa la desviació de la mitjana de <span class="math inline">\(X\)</span> en el nivell <span class="math inline">\(j\)</span>-èsim del factor B respecte de la mitjana global <span class="math inline">\(\mu\)</span> (l’<strong>efecte del tractament <span class="math inline">\(j\)</span>-èsim del factor B</strong>).</p></li>
<li><p><span class="math inline">\((\alpha\beta)_{ij}=\mu_{ij}-\mu_{i\bullet}-\mu_{\bullet j}+\mu\)</span> representa l’<strong>efecte de la interacció</strong> entre el nivell <span class="math inline">\(i\)</span>-èsim del factor <span class="math inline">\(A\)</span> i el nivell <span class="math inline">\(j\)</span>-èsim del factor <span class="math inline">\(B\)</span>; si no hi hagués interacció, tendríem que
<span class="math display">\[
\mu_{ij}-\mu=(\mu_{i\bullet}-\mu)+(\mu_{\bullet j}-\mu)
\]</span>
(l’efecte dels dos tractaments se sumaria; la demostració la donam en un bloc de corbes perilloses més a baix) i aquesta contribució de la interacció seria 0.</p></li>
<li><p><span class="math inline">\(E_{ij}=X_{ij}-\mu_{ij}\)</span> representa la part de la diferència entre <span class="math inline">\(X_{ij}\)</span> i <span class="math inline">\(\mu\)</span> que no expliquen ni el tractament ni el bloc ni la interacció; en diem l’<strong>error aleatori</strong>, o el <strong>residu</strong>.</p></li>
</ul>
<p>Aquest model diu bàsicament que el valor de <span class="math inline">\(X\)</span> sobre un individu és la suma de cinc components:</p>
<ul>
<li>La mitjana global <span class="math inline">\(\mu\)</span> de <span class="math inline">\(X\)</span> sobre tota la població</li>
<li>L’efecte del tractament A</li>
<li>L’efecte del tractament B</li>
<li>L’efecte de la interacció</li>
<li>L’error aleatori</li>
</ul>
<p>Passem ara a la mostra amb què volem realitzar el contrast. Siguin:</p>
<ul>
<li><p><span class="math inline">\(\overline{X}_{ij}=\dfrac{\sum_{k=1}^n X_{ijk}}{n}\)</span>: la mitjana mostral de la combinació <span class="math inline">\((i,j)\)</span> de nivells d’A i B; estima <span class="math inline">\(\mu_{ij}\)</span>.</p></li>
<li><p><span class="math inline">\(\overline{X}_{i\bullet}=\dfrac{\sum_{j=1}^b\sum_{k=1}^n X_{ijk}}{bn}\)</span>: la mitjana mostral del nivell <span class="math inline">\(i\)</span>-èsim del factor A; estima <span class="math inline">\(\mu_{i\bullet}\)</span>.</p></li>
<li><p><span class="math inline">\(\overline{X}_{\bullet j}=\dfrac{\sum_{i=1}^a\sum_{k=1}^n X_{ijk}}{an}\)</span>: la mitjana mostral del nivell <span class="math inline">\(j\)</span>-èsim del factor B estima <span class="math inline">\(\mu_{\bullet j}\)</span>.</p></li>
<li><p><span class="math inline">\(\overline{X}=\dfrac{\sum_{i=1}^{a}\sum_{j=1}^b\sum_{k=1}^n X_{ijk}}{a b n}\)</span>: la mitjana mostral de tota la mostra; estima <span class="math inline">\(\mu\)</span>.</p></li>
</ul>

<div class="example">
<p><span id="exm:unnamed-chunk-723" class="example"><strong>Exemple 10.18  </strong></span>Les mitjanes de la taula de l’Exemple <a href="chap-ANOVA.html#exm:gupis">10.17</a> correspondrien a</p>
</div>
<p><span class="math display">\[
\begin{array}{c}
\text{Factor A}\\
\begin{array}{c|cc|cc|c}
\text{Factor B}&amp;\text{9 hores} &amp; &amp;\text{14 hores} &amp; &amp; \\ \hline
16^\circ &amp;1.30&amp; &amp; 1.01&amp; &amp;\\
&amp;2.88&amp; &amp; 1.52&amp; &amp;\\
&amp;2.42&amp; \!\!\!\!\!\!\overline{X}_{11} &amp; 1.02&amp;\!\!\!\!\!\!\! \overline{X}_{21} &amp;\overline{X}_{\bullet1}\\
&amp;2.66&amp; &amp; 1.32&amp; &amp;\\
&amp;2.94&amp; &amp; 1.63&amp; &amp;\\\hline
27^\circ &amp;0.90&amp; &amp; 0.83&amp; &amp;\\ 
&amp;1.06&amp; &amp; 0.67&amp; &amp;\\
&amp;0.98&amp;\!\!\!\!\!\!  \overline{X}_{12} &amp; 0.57&amp;\!\!\!\!\!\!\! \overline{X}_{22} &amp;\overline{X}_{\bullet2}\\
&amp;1.29&amp; &amp; 0.47&amp; &amp;\\
&amp;1.12&amp; &amp; 0.66&amp; &amp;\\\hline
&amp; \overline{X}_{1\bullet} &amp; &amp; \overline{X}_{2\bullet} &amp; &amp;
\end{array}
\end{array}
\]</span></p>
<p>Anem a calcular-les. Organitzarem les dades en un dataframe <code>peixos</code> amb 3 variables:</p>
<ul>
<li><p><strong>GSI</strong>, quantitativa, contendrà el GSI de cada peix</p></li>
<li><p><strong>llum</strong>, un factor que contendrà el valor del nivell del factor A (foto-període) per a cada peix</p></li>
<li><p><strong>temp</strong>, un factor que contendrà el valor del nivell del factor B (temperatura) per a cada peix</p></li>
</ul>

<div class="rmdrecordau">
Com a totes les ANOVA, els factors que s’empren per classificar la població convé que siguin això, factors (o, almenys, vectors de paraules, no vectors numèrics), al <em>dataframe</em> si volem després emprar la funció <code>aov</code> per fer l’ANOVA.
</div>
<p>Entrarem les dades de la taula per fileres. Per tant el factor <strong>llum</strong> ha d’estar format per 10 còpies consecutives del vector (9,14) i el factor <strong>temp</strong> ha d’estar format per 10 còpies de “16” seguides de 10 còpies de “27”.</p>
<div class="sourceCode" id="cb631"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb631-1"><a href="chap-ANOVA.html#cb631-1" aria-hidden="true" tabindex="-1"></a>GSI<span class="ot">=</span> <span class="fu">c</span>(<span class="fl">1.30</span>,<span class="fl">1.01</span>,<span class="fl">2.88</span>,<span class="fl">1.52</span>,<span class="fl">2.42</span>,<span class="fl">1.02</span>,<span class="fl">2.66</span>,<span class="fl">1.32</span>,<span class="fl">2.94</span>,<span class="fl">1.63</span>,<span class="fl">0.90</span>,</span>
<span id="cb631-2"><a href="chap-ANOVA.html#cb631-2" aria-hidden="true" tabindex="-1"></a>       <span class="fl">0.83</span>,<span class="fl">1.06</span>,<span class="fl">0.67</span>,<span class="fl">0.98</span>,<span class="fl">0.57</span>,<span class="fl">1.29</span>,<span class="fl">0.47</span>,<span class="fl">1.12</span>,<span class="fl">0.66</span>)</span>
<span id="cb631-3"><a href="chap-ANOVA.html#cb631-3" aria-hidden="true" tabindex="-1"></a>llum<span class="ot">=</span><span class="fu">as.factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">14</span>),<span class="dv">10</span>))</span>
<span id="cb631-4"><a href="chap-ANOVA.html#cb631-4" aria-hidden="true" tabindex="-1"></a>llum</span></code></pre></div>
<pre><code>##  [1] 9  14 9  14 9  14 9  14 9  14 9  14 9  14 9  14 9  14 9  14
## Levels: 9 14</code></pre>
<div class="sourceCode" id="cb633"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb633-1"><a href="chap-ANOVA.html#cb633-1" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span><span class="fu">as.factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">16</span>,<span class="dv">27</span>),<span class="at">each=</span><span class="dv">10</span>))</span>
<span id="cb633-2"><a href="chap-ANOVA.html#cb633-2" aria-hidden="true" tabindex="-1"></a>temp</span></code></pre></div>
<pre><code>##  [1] 16 16 16 16 16 16 16 16 16 16 27 27 27 27 27 27 27 27 27 27
## Levels: 16 27</code></pre>
<div class="sourceCode" id="cb635"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb635-1"><a href="chap-ANOVA.html#cb635-1" aria-hidden="true" tabindex="-1"></a>peixos<span class="ot">=</span><span class="fu">data.frame</span>(GSI,llum,temp)</span>
<span id="cb635-2"><a href="chap-ANOVA.html#cb635-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(peixos)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:	20 obs. of  3 variables:
##  $ GSI : num  1.3 1.01 2.88 1.52 2.42 1.02 2.66 1.32 2.94 1.63 ...
##  $ llum: Factor w/ 2 levels &quot;9&quot;,&quot;14&quot;: 1 2 1 2 1 2 1 2 1 2 ...
##  $ temp: Factor w/ 2 levels &quot;16&quot;,&quot;27&quot;: 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
<div class="sourceCode" id="cb637"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb637-1"><a href="chap-ANOVA.html#cb637-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(peixos)</span></code></pre></div>
<pre><code>##    GSI llum temp
## 1 1.30    9   16
## 2 1.01   14   16
## 3 2.88    9   16
## 4 1.52   14   16
## 5 2.42    9   16
## 6 1.02   14   16</code></pre>
<p>Calculem les mitjanes:</p>
<ul>
<li>Les <span class="math inline">\(\overline{X}_{ij}\)</span>:</li>
</ul>
<div class="sourceCode" id="cb639"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb639-1"><a href="chap-ANOVA.html#cb639-1" aria-hidden="true" tabindex="-1"></a>Xb.i.j.bolleta<span class="ot">=</span><span class="fu">aggregate</span>(GSI<span class="sc">~</span>llum<span class="sc">+</span>temp, <span class="at">data=</span>peixos,mean)</span>
<span id="cb639-2"><a href="chap-ANOVA.html#cb639-2" aria-hidden="true" tabindex="-1"></a>Xb.i.j.bolleta</span></code></pre></div>
<pre><code>##   llum temp  GSI
## 1    9   16 2.44
## 2   14   16 1.30
## 3    9   27 1.07
## 4   14   27 0.64</code></pre>
<p>Hem obtingut aquesta taula:
<span class="math display">\[
\begin{array}{c|cc}
\overline{X}_{ij} &amp; 9 &amp; 14\\ \hline
16 &amp; 2.44 &amp; 1.30\\
27 &amp;  1.07 &amp; 0.64
\end{array}
\]</span></p>
<ul>
<li>Les <span class="math inline">\(\overline{X}_{i\bullet}\)</span>:</li>
</ul>
<div class="sourceCode" id="cb641"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb641-1"><a href="chap-ANOVA.html#cb641-1" aria-hidden="true" tabindex="-1"></a>Xb.A<span class="ot">=</span><span class="fu">aggregate</span>(GSI<span class="sc">~</span>llum,<span class="at">data=</span>peixos,mean)</span>
<span id="cb641-2"><a href="chap-ANOVA.html#cb641-2" aria-hidden="true" tabindex="-1"></a>Xb.A</span></code></pre></div>
<pre><code>##   llum   GSI
## 1    9 1.755
## 2   14 0.970</code></pre>
<ul>
<li>Les <span class="math inline">\(\overline{X}_{\bullet j}\)</span>:</li>
</ul>
<div class="sourceCode" id="cb643"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb643-1"><a href="chap-ANOVA.html#cb643-1" aria-hidden="true" tabindex="-1"></a>Xb.B<span class="ot">=</span><span class="fu">aggregate</span>(GSI<span class="sc">~</span>temp,<span class="at">data=</span>peixos,mean)</span>
<span id="cb643-2"><a href="chap-ANOVA.html#cb643-2" aria-hidden="true" tabindex="-1"></a>Xb.B</span></code></pre></div>
<pre><code>##   temp   GSI
## 1   16 1.870
## 2   27 0.855</code></pre>
<ul>
<li>La <span class="math inline">\(\overline{X}\)</span>:</li>
</ul>
<div class="sourceCode" id="cb645"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb645-1"><a href="chap-ANOVA.html#cb645-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(peixos<span class="sc">$</span>GSI)</span></code></pre></div>
<pre><code>## [1] 1.3625</code></pre>
<p>Hem obtingut la taula següent:
<span class="math display">\[
\begin{array}{cc|cc|c}
\overline{X}_{1\bullet} &amp; \overline{X}_{2\bullet} &amp; \overline{X}_{\bullet 1} &amp; \overline{X}_{\bullet 2} &amp; \overline{X} \\ \hline
1.755 &amp;  0.970 &amp; 1.870  &amp; 0.855 &amp; 1.3625
\end{array}
\]</span></p>
<p>En l’ANOVA de 2 vies hi tenim les identitats següents:</p>

<div class="theorem">
<p><span id="thm:SS2vies" class="theorem"><strong>Teorema 10.4  (Identitat de les sumes de quadrats)  </strong></span><span class="math display">\[
\begin{array}{l}
SS_{Total} = SS_{Tr}+SS_E\\[1ex]
SS_{Tr} = SS_A+SS_B+SS_{AB}
\end{array}
\]</span>
on</p>
<ul>
<li><p><span class="math inline">\(SS_{Total}=\displaystyle\sum\limits_{i=1}^a\sum\limits_{j=1}^b\sum\limits_{k=1}^n (X_{ijk}-\overline{X})^2\)</span>; és la <strong>Suma Total de Quadrats</strong>.</p></li>
<li><p><span class="math inline">\(SS_{Tr}=\displaystyle n\sum\limits_{i=1}^a\sum\limits_{j=1}^b (\overline{X}_{ij}-\overline{X})^2\)</span>; és la <strong>Suma de Quadrats dels Tractaments</strong>.</p></li>
<li><p><span class="math inline">\(SS_{A}=\displaystyle b n\sum\limits_{i=1}^a (\overline{X}_{i\bullet}-\overline{X})^2\)</span>; és la <strong>Suma de Quadrats del Factor A</strong>.</p></li>
<li><p><span class="math inline">\(SS_{B}=\displaystyle a n\sum\limits_{i=1}^b (\overline{X}_{\bullet j}-\overline{X})^2\)</span>; és la <strong>Suma de Quadrats del Factor B</strong>.</p></li>
<li><p><span class="math inline">\({SS_{AB}}=n \sum\limits_{i=1}^a\sum\limits_{j=1}^b (\overline{X}_{ij}-\overline{X}_{i\bullet}-\overline{X}_{\bullet j}+\overline{X})^2\)</span>; és la <strong>Suma de Quadrats de la Interacció</strong>.</p></li>
<li><p><span class="math inline">\(SS_E=\displaystyle\sum\limits_{i=1}^a\sum\limits_{j=1}^b\sum\limits_{k=1}^n (X_{ijk}-\overline{X}_{ij})^2\)</span>; és la <strong>Suma de Quadrats dels Residus</strong> o <strong>dels Errors</strong>.</p></li>
</ul>
</div>
<p>Com als ANOVA anteriors, aquestes sumes de quadrats representen les diferents fonts de variabilitat de les dades:</p>
<ul>
<li><p><span class="math inline">\(SS_{Total}\)</span> representa la variabilitat total de les dades.</p></li>
<li><p><span class="math inline">\(SS_{Tr}\)</span> representa la variabilitat de les mitjanes de les combinacions de nivells.</p></li>
<li><p><span class="math inline">\(SS_{A}\)</span> representa la variabilitat de les mitjanes dels nivells del factor A.</p></li>
<li><p><span class="math inline">\(SS_{B}\)</span> representa la variabilitat de les mitjanes dels nivells del factor B.</p></li>
<li><p><span class="math inline">\(SS_E\)</span> representa la suma de les variabilitats dins cada combinació de nivells.</p></li>
<li><p><span class="math inline">\(SS_{AB}\)</span> representa la variabilitat deguda a la interacció.</p></li>
</ul>

<div class="rmdcorbes">
<p>Recordau que, si no hi hagués interacció, per a cada parella de nivells <span class="math inline">\(j,j&#39;\)</span> de B, les diferències
<span class="math display">\[
\mu_{ij}-\mu_{ij&#39;}
\]</span>
serien totes la mateixa, independentment del nivell <span class="math inline">\(i\)</span> de <span class="math inline">\(A\)</span>. Diguem a aquesta diferència <span class="math inline">\(\delta_{jj&#39;}\)</span>. Si ara calculam la mitjana per a tots els nivells <span class="math inline">\(j&#39;\)</span> de B tenim
<span class="math display">\[
\mu_{ij}-\mu_{i\bullet}=\mu_{ij}-\frac{1}{b}\sum_{j&#39;=1}^b \mu_{ij&#39;}=
\frac{1}{b}  \sum_{j&#39;=1}^b(\mu_{ij}-\mu_{ij&#39;})=
  \frac{1}{b}\sum_{j&#39;=1}^b \delta_{jj&#39;}
\]</span>
Aquest valor no depèn del nivell <span class="math inline">\(i\)</span>. Per tant, si ara calculam la mitjana per a tots els nivells <span class="math inline">\(i\)</span> d’A
<span class="math display">\[
\mu_{\bullet j}-\mu=\frac{1}{a}\sum_{i=1}^a(\mu_{ij}-\mu_{i\bullet})=\frac{1}{b}\sum_{j&#39;=1}^b \delta_{jj&#39;}
\]</span>
En resum, si no hi hagués interacció entre els dos factors, tendríem que
<span class="math display">\[
\begin{array}{l}
\mu_{ij}-\mu_{i\bullet}-\mu_{\bullet j}+\mu=(\mu_{ij}-\mu_{i\bullet})-(\mu_{\bullet j}-\mu)\\
\qquad\displaystyle =\frac{1}{b}\sum_{j&#39;=1}^b \delta_{jj&#39;}-\frac{1}{b}\sum_{j&#39;=1}^b \delta_{jj&#39;}=0
\end{array}
\]</span>
i per tant, sobre la nostra mostra, esperaríem que
<span class="math display">\[
\overline{X}_{ij}-\overline{X}_{i\bullet}-\overline{X}_{\bullet j}+\overline{X}=0
\]</span>
Aleshores, <span class="math inline">\(SS_{AB}\)</span> és la suma dels quadrats de les divergències, per a cada parell <span class="math inline">\((i,j)\)</span>, d’aquests valors a la nostra mostra respecte del que esperaríem si no hi hagués interacció.</p>
<p>A més, de <span class="math inline">\(\mu_{ij}-\mu_{i\bullet}-\mu_{\bullet j}+\mu=0\)</span> deduïm que
<span class="math display">\[
\mu_{ij}-\mu=\mu_{i\bullet}+\mu_{\bullet j}-2\mu=(\mu_{i\bullet}-\mu)+(\mu_{\bullet j}-\mu)
\]</span>
com afirmàvem en parlar del model de l’ANOVA de 2 vies.</p>
</div>
<p>Observau que de
<span class="math display">\[
\begin{array}{l}
SS_{Total} = SS_{Tr}+SS_E\\[1ex]
SS_{Tr} = SS_A+SS_B+SS_{AB}
\end{array}
\]</span>
se’n dedueix que
<span class="math display">\[
SS_{Total} = SS_A+SS_B+SS_{AB}+SS_E
\]</span></p>
<blockquote>
<p>La variabilitat total descompon en la suma de la variabilitat de les mitjanes del factor A més la variabilitat de les mitjanes del factor B més la variabilitat deguda a la interacció i més, finalment, la variabilitat “residual”.</p>
</blockquote>

<div class="example">
<p><span id="exm:unnamed-chunk-731" class="example"><strong>Exemple 10.19  </strong></span>Comprovem aquestes identitats amb les dades de l’Exemple <a href="chap-ANOVA.html#exm:gupis">10.17</a>.</p>
</div>

<div class="rmdexercici">
Procurau entendre com calculam les sumes de quadrats; hem donat els raonaments detallats als altres dos tipus d’ANOVA, aquí ja no els donarem.
</div>
<div class="sourceCode" id="cb647"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb647-1"><a href="chap-ANOVA.html#cb647-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">5</span></span>
<span id="cb647-2"><a href="chap-ANOVA.html#cb647-2" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb647-3"><a href="chap-ANOVA.html#cb647-3" aria-hidden="true" tabindex="-1"></a>b<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb647-4"><a href="chap-ANOVA.html#cb647-4" aria-hidden="true" tabindex="-1"></a>X.barra<span class="ot">=</span><span class="fu">mean</span>(peixos<span class="sc">$</span>GSI)</span></code></pre></div>
<ul>
<li>La <span class="math inline">\(SS_{Total}\)</span>:</li>
</ul>
<div class="sourceCode" id="cb648"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb648-1"><a href="chap-ANOVA.html#cb648-1" aria-hidden="true" tabindex="-1"></a>SS.Tot<span class="ot">=</span><span class="fu">sum</span>((peixos<span class="sc">$</span>GSI<span class="sc">-</span>X.barra)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb648-2"><a href="chap-ANOVA.html#cb648-2" aria-hidden="true" tabindex="-1"></a>SS.Tot</span></code></pre></div>
<pre><code>## [1] 11.13377</code></pre>
<ul>
<li>La <span class="math inline">\(SS_{A}\)</span>:</li>
</ul>
<div class="sourceCode" id="cb650"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb650-1"><a href="chap-ANOVA.html#cb650-1" aria-hidden="true" tabindex="-1"></a>SS.A<span class="ot">=</span>b<span class="sc">*</span>n<span class="sc">*</span><span class="fu">sum</span>((Xb.A<span class="sc">$</span>GSI<span class="sc">-</span>X.barra)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb650-2"><a href="chap-ANOVA.html#cb650-2" aria-hidden="true" tabindex="-1"></a>SS.A</span></code></pre></div>
<pre><code>## [1] 3.081125</code></pre>
<ul>
<li>La <span class="math inline">\(SS_{B}\)</span>:</li>
</ul>
<div class="sourceCode" id="cb652"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb652-1"><a href="chap-ANOVA.html#cb652-1" aria-hidden="true" tabindex="-1"></a>SS.B<span class="ot">=</span>a<span class="sc">*</span>n<span class="sc">*</span><span class="fu">sum</span>((Xb.B<span class="sc">$</span>GSI<span class="sc">-</span>X.barra)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb652-2"><a href="chap-ANOVA.html#cb652-2" aria-hidden="true" tabindex="-1"></a>SS.B</span></code></pre></div>
<pre><code>## [1] 5.151125</code></pre>
<ul>
<li>La <span class="math inline">\(SS_{AB}\)</span>:</li>
</ul>
<div class="sourceCode" id="cb654"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb654-1"><a href="chap-ANOVA.html#cb654-1" aria-hidden="true" tabindex="-1"></a>SS.AB<span class="ot">=</span>n<span class="sc">*</span><span class="fu">sum</span>((Xb.i.j.bolleta<span class="sc">$</span>GSI<span class="sc">-</span>Xb.A<span class="sc">$</span>GSI<span class="sc">-</span><span class="fu">rep</span>(Xb.B<span class="sc">$</span>GSI,<span class="at">each=</span>a)<span class="sc">+</span>X.barra)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb654-2"><a href="chap-ANOVA.html#cb654-2" aria-hidden="true" tabindex="-1"></a>SS.AB</span></code></pre></div>
<pre><code>## [1] 0.630125</code></pre>
<ul>
<li>La <span class="math inline">\(SS_{Tr}\)</span>:</li>
</ul>
<div class="sourceCode" id="cb656"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb656-1"><a href="chap-ANOVA.html#cb656-1" aria-hidden="true" tabindex="-1"></a>SS.Tr<span class="ot">=</span>n<span class="sc">*</span><span class="fu">sum</span>((Xb.i.j.bolleta<span class="sc">$</span>GSI<span class="sc">-</span>X.barra)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb656-2"><a href="chap-ANOVA.html#cb656-2" aria-hidden="true" tabindex="-1"></a>SS.Tr</span></code></pre></div>
<pre><code>## [1] 8.862375</code></pre>
<ul>
<li>La <span class="math inline">\(SS_{E}\)</span>:</li>
</ul>
<div class="sourceCode" id="cb658"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb658-1"><a href="chap-ANOVA.html#cb658-1" aria-hidden="true" tabindex="-1"></a>SS.E<span class="ot">=</span><span class="fu">sum</span>((peixos<span class="sc">$</span>GSI<span class="sc">-</span><span class="fu">c</span>(<span class="fu">rep</span>(Xb.i.j.bolleta[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="dv">3</span>],n),<span class="fu">rep</span>(Xb.i.j.bolleta[<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>,<span class="dv">3</span>],n)))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb658-2"><a href="chap-ANOVA.html#cb658-2" aria-hidden="true" tabindex="-1"></a>SS.E    </span></code></pre></div>
<pre><code>## [1] 2.2714</code></pre>
<p>Comprovem les igualtats de sumes de quadrats</p>
<div class="sourceCode" id="cb660"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb660-1"><a href="chap-ANOVA.html#cb660-1" aria-hidden="true" tabindex="-1"></a>SS.Tr</span></code></pre></div>
<pre><code>## [1] 8.862375</code></pre>
<div class="sourceCode" id="cb662"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb662-1"><a href="chap-ANOVA.html#cb662-1" aria-hidden="true" tabindex="-1"></a>SS.A<span class="sc">+</span>SS.B<span class="sc">+</span>SS.AB</span></code></pre></div>
<pre><code>## [1] 8.862375</code></pre>
<div class="sourceCode" id="cb664"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb664-1"><a href="chap-ANOVA.html#cb664-1" aria-hidden="true" tabindex="-1"></a>SS.Tot</span></code></pre></div>
<pre><code>## [1] 11.13377</code></pre>
<div class="sourceCode" id="cb666"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb666-1"><a href="chap-ANOVA.html#cb666-1" aria-hidden="true" tabindex="-1"></a>SS.Tr<span class="sc">+</span>SS.E</span></code></pre></div>
<pre><code>## [1] 11.13377</code></pre>
<p>Com a les altres ANOVA, compararem la variabilitat de les mitjanes amb la variabilitat dels errors. Per això, emprarem els quadrats mitjans següents:</p>
<ul>
<li><p><strong>Quadrat mitjà del factor A</strong>:
<span class="math display">\[
MS_A =\dfrac{SS_A}{a-1}
\]</span></p></li>
<li><p><strong>Quadrat mitjà del factor B</strong>:
<span class="math display">\[
MS_B =\dfrac{SS_B}{b-1}
\]</span></p></li>
<li><p><strong>Quadrat mitjà de la interacció</strong>:
<span class="math display">\[
MS_{AB}=\dfrac{SS_{AB}}{(a-1)(b-1)}
\]</span></p></li>
<li><p><strong>Quadrat mitjà dels tractaments</strong>:
<span class="math display">\[
MS_{Tr}=\dfrac{SS_{Tr}}{ab-1}
\]</span></p></li>
<li><p><strong>Quadrat mitjà dels errors</strong>:
<span class="math display">\[
MS_E=\dfrac{SS_E}{ab (n-1)}
\]</span></p></li>
</ul>
<p>Fixau-vos que els denominadors són diferents dels dels quadrats mitjans homònims en les altres ANOVA.</p>

<div class="example">
<p><span id="exm:unnamed-chunk-741" class="example"><strong>Exemple 10.20  </strong></span>Al nostre Exemple <a href="chap-ANOVA.html#exm:gupis">10.17</a>, hem obtingut les sumes de quadrats següents:</p>
</div>
<p><span class="math display">\[
\begin{array}{cccccc}
SS_{Total} &amp; SS_A &amp; SS_B &amp;   SS_{AB} &amp;SS_{Tr} &amp;  SS_E\\ \hline
11.1338 &amp; 3.0811  &amp;  5.1511  &amp;    0.6301  &amp; 8.8624  &amp;  2.2714
\end{array}
\]</span></p>
<p>En aquest exemple, <span class="math inline">\(n=5\)</span> i <span class="math inline">\(a=b=2\)</span>. Per tant</p>
<p><span class="math display">\[
\begin{array}{ccccc}
MS_A &amp; MS_B &amp; MS_{AB} &amp; MS_{Tr} &amp; MS_E\\ \hline
3.0811  &amp;  5.1511 &amp; 0.6301 &amp; 2.9541 &amp; 0.142
\end{array}
\]</span></p>
<p>En una ANOVA de 2 vies, ens poden interessar els quatre contrastos següents:</p>
<ul>
<li><p><strong>Contrast de mitjanes del factor A</strong>: Contrastam si hi ha diferències entre les mitjanes dels tractaments del factor A:
<span class="math display">\[
\left\{
\begin{array}{l}
H_0 : \mu_{1\bullet}=\mu_{2\bullet}=\cdots
=\mu_{a\bullet} \\
H_1 :  \text{Hi ha } i,i&#39;\text{ tals que }  \mu_{i\bullet}
\not = \mu_{i&#39;\bullet}
\end{array}
\right.
\]</span>
L’estadístic de contrast és
<span class="math display">\[
F_A=\frac{MS_A}{MS_E},
\]</span>
el qual, si <span class="math inline">\(H_0\)</span> és certa, té distribució F de Fisher amb <span class="math inline">\(a-1\)</span> i <span class="math inline">\(ab(n-1)\)</span> graus de llibertat i valor proper a 1.</p></li>
<li><p><strong>Contrast de mitjanes del factor B</strong>: Contrastam si hi ha diferències entre les mitjanes dels tractaments del factor B:
<span class="math display">\[
\left\{
\begin{array}{l}
H_0 : \mu_{\bullet 1}=\mu_{\bullet 2}=\cdots =\mu_{ \bullet
b} \\
H_1 :  \text{Hi ha } j,j&#39;\text{ tals que }  \mu_{\bullet j}
\not = \mu_{\bullet j&#39;}
\end{array}
\right.
\]</span>
L’estadístic de contrast és
<span class="math display">\[
F_B=\frac{MS_B}{MS_E},
\]</span>
el qual, si <span class="math inline">\(H_0\)</span> és certa, té distribució F de Fisher amb <span class="math inline">\(b-1\)</span> i <span class="math inline">\(ab(n-1)\)</span> graus de llibertat i valor proper a 1.</p></li>
<li><p><strong>Contrast dels tractaments</strong>: Contrastam si hi ha diferències entre les mitjanes de les parelles (nivell de A, nivell de B):
<span class="math display">\[
\left\{
\begin{array}{l}
H_0 : \text{Per a tots }i,j,i&#39;,j&#39;,\ \mu_{ij}=\mu_{i&#39;j&#39;} \\
H_1 :  \text{Hi ha } i,j,i&#39;,j&#39;\text{ tals que } \mu_{ij}\neq \mu_{i&#39;j&#39;}
\end{array}
\right.
\]</span>
L’estadístic de contrast és
<span class="math display">\[
F_{Tr}=\frac{MS_{Tr}}{MS_E},
\]</span>
el qual, si <span class="math inline">\(H_0\)</span> és certa, té distribució F de Fisher amb <span class="math inline">\(ab-1\)</span> i <span class="math inline">\(ab(n-1)\)</span> graus de llibertat i valor proper a 1.</p></li>
<li><p><strong>Contrast de no interacció</strong>: Contrastam si hi ha interacció entre els factors A i B:
<span class="math display">\[
\left\{
\begin{array}{l}
H_0 :  \text{No hi ha interacció entre els nivells d&#39;$A$ i $B$} \\
H_1 :  \text{Hi ha interacció entre alguns nivells d&#39;$A$ i $B$}
\end{array}
\right.
\]</span>
L’estadístic de contrast és
<span class="math display">\[
F_{AB} = \frac{MS_{AB}}{MS_E},
\]</span>
el qual, si <span class="math inline">\(H_0\)</span> és certa, té distribució F de Fisher amb <span class="math inline">\((a-1)(b-1)\)</span> i <span class="math inline">\(ab(n-1)\)</span> graus de llibertat i valor proper a 1.</p></li>
</ul>

<div class="rmdrecordau">
Com a les ANOVA anteriors, els graus de llibertat de cada estadístic de contrast F són els denominadors emprats en les definicions dels quadrats mitjans del numerador i el denominador.
</div>
<p>En els quatre contrastos, el p-valor és
<span class="math display">\[
P(F_{x,y}\geqslant \text{valor de l&#39;estadístic sobre la mostra})
\]</span>
on <span class="math inline">\(F_{x,y}\)</span> representa la distribució F de Fisher amb els graus de llibertat que pertoquin al contrast.</p>
<p>Tota aquesta informació se recull en la taula ANOVA següent:</p>
<p><span class="math display">\[
\begin{array}{llllll}
\hline
\text{Origen de la}&amp;\text{Graus de}&amp;\text{Sumes de}&amp;\text{Quadrats} &amp; \text{Estadístic de}&amp;\text{p-valor}\\[-0.5ex]
\text{variabilitat}&amp;\text{llibertat}&amp;\text{quadrats}&amp;\text{mitjans}&amp;\text{contrast} &amp; \\\hline
\text{Tractaments} &amp; ab-1 &amp; SS_{Tr}&amp; MS_{Tr}  &amp; F_{Tr} &amp; \text{p-valor}_{Tr} \\
\text{Factor A} &amp; a-1 &amp; SS_{A}&amp; MS_{A}  &amp; F_A &amp; \text{p-valor}_A \\
\text{Factor B} &amp; b-1 &amp; SS_{B}&amp; MS_{B}  &amp; F_B &amp; \text{p-valor}_B \\
\text{Interacció AB} &amp; (a-1)(b-1) &amp; SS_{AB}&amp; MS_{AB}  &amp; F_{AB} &amp; \text{p-valor}_{AB} \\
\text{Residus} &amp; ab(n-1) &amp; SS_E &amp; MS_E &amp; \\\hline
\end{array}
\]</span></p>

<div class="example">
<p><span id="exm:unnamed-chunk-743" class="example"><strong>Exemple 10.21  </strong></span>Tornant a l’Exemple <a href="chap-ANOVA.html#exm:gupis">10.17</a>, tenim que <span class="math inline">\(n=5\)</span>, <span class="math inline">\(a=b=2\)</span> i ja hem calculat els quadrats mitjans següents:</p>
</div>
<p><span class="math display">\[
\begin{array}{ccccc}
MS_A &amp; MS_B &amp; MS_{AB} &amp; MS_{Tr} &amp; MS_E\\ \hline
3.0811  &amp;  5.1511 &amp; 0.6301 &amp; 2.9541 &amp; 0.142
\end{array}
\]</span></p>
<p>Realitzem els quatre contrastos:</p>
<ul>
<li><p>Hi ha diferència en la mitjana del GSI segons el foto-període?
<span class="math display">\[
\begin{array}{l}
F_A=\dfrac{MS_{A}}{MS_E}=21.7\\
\text{p-valor}_A=P(F_{1,16}\geqslant 21.7)=\texttt{1-pf(21.7,1,16)}=0.0003
\end{array}
\]</span>
<em>Conclusió</em>: Hem trobat evidència estadística que el GSI mitjà és diferent segons el foto-període (ANOVA de 2 vies, p-valor 0.0003)</p></li>
<li><p>Hi ha diferència en la mitjana del GSI segons la temperatura?
<span class="math display">\[
\begin{array}{l}
F_B=\dfrac{MS_{B}}{MS_E}=36.3\\
\text{p-valor}_B=P(F_{1,16}\geqslant 36.3)=\texttt{1-pf(36.3,1,16)}=2\cdot 10^{-5}
\end{array}
\]</span>
<em>Conclusió</em>: Hem trobat evidència estadística que el GSI mitjà és diferent segons la temperatura (ANOVA de 2 vies, p-valor 2·10<sup>-5</sup>)</p></li>
<li><p>Hi ha diferència en la mitjana del GSI segons les combinacions de foto-període i temperatura?
<span class="math display">\[
\begin{array}{l}
F_{Tr}=\dfrac{MS_{Tr}}{MS_E}=20.8\\
\text{p-valor}_{Tr}=P(F_{3,16}\geqslant 20.8)=\texttt{1-pf(20.8,3,16)}=9\cdot 10^{-6}
\end{array}
\]</span>
<em>Conclusió</em>: Hem trobat evidència estadística que no tots els GSI mitjans per a les combinacions de foto-període i temperatura són iguals (ANOVA de 2 vies, p-valor 9·10<sup>-6</sup>)</p></li>
<li><p>Hi ha interacció entre el foto-període i la temperatura?
<span class="math display">\[
\begin{array}{l}
F_{AB}=\dfrac{MS_{AB}}{MS_E}=4.437\\
\text{p-valor}_{AB}=P(F_{1,16}\geqslant 4.437)=\texttt{1-pf(4.437,1,16)}=0.051
\end{array}
\]</span>
<em>Conclusió</em>: No hem trobat evidència estadística que hi hagi interacció entre el foto-període i la temperatura (ANOVA de 2 vies, p-valor 0.051)</p></li>
</ul>
<p>La taula ANOVA és</p>
<p><span class="math display">\[
\begin{array}{llllll}
\hline
\text{Origen de la}&amp;\text{Graus de}&amp;\text{Sumes de}&amp;\text{Quadrats} &amp; \text{Estadístic de}&amp;\text{p-valor}\\[-0.5ex]
\text{variabilitat}&amp;\text{llibertat}&amp;\text{quadrats}&amp;\text{mitjans}&amp;\text{contrast} &amp; \\\hline
\text{Tractaments} &amp;3&amp;8.862&amp;2.954&amp;20.8 &amp; 9\cdot 10^{-6} \\
\text{Factor A} &amp;1&amp;3.081&amp;3.081&amp;21.7 &amp; 0.0003 \\
\text{Factor B} &amp; 1&amp;5.151&amp;5.151&amp;36.3 &amp; 2\cdot 10^{-5} \\
\text{Interacció AB} &amp; 1&amp;0.630&amp;0.630&amp;4.44 &amp; 0.051 \\
\text{Residus} &amp; 19&amp;11.134&amp;&amp; &amp; \\\hline
\end{array}
\]</span></p>

<div class="rmdromans">
<p>Hem fet quatre contrastos. No hauríem d’ajustar els p-valors?</p>
No, perquè estam emprant les mateixes dades als quatre contrastos, no són contrastos independents. És a dir, o la mostra ens ha sortit representativa i totes les conclusions són més o menys fiables, o la mostra ens ha sortit rareta i totes les conclusions són poc fiables.
</div>
</div>
<div id="amb-r-2" class="section level3" number="10.4.2">
<h3><span class="header-section-number">10.4.2</span> Amb R</h3>
<p>A l’ANOVA de 2 vies:</p>
<ul>
<li><p>Els contrastos de les mitjanes de cada un dels factors i de no interacció s’efectuen aplicant <code>summary(aov( ))</code> a la fórmula que separa la variable numèrica pel <strong>producte dels dos factors</strong>, indicat amb un asterisc *.</p></li>
<li><p>El contrast dels tractaments, és a dir, de les mitjanes de les subpoblacions definides per les combinacions de nivells, un de cada factor, s’efectua aplicant <code>summary(aov( ))</code> a la fórmula que separa la variable numèrica per la <strong>combinació dels dos factors</strong>, indicada amb dos punts “:”.</p></li>
</ul>
<p>Així, l’ANOVA de 2 vies de l’Exemple <a href="chap-ANOVA.html#exm:esports">10.11</a> es fa amb</p>
<div class="sourceCode" id="cb668"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb668-1"><a href="chap-ANOVA.html#cb668-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(GSI<span class="sc">~</span>llum<span class="sc">*</span>temp,<span class="at">data=</span>peixos))</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## llum         1  3.081   3.081  21.704 0.000262 ***
## temp         1  5.151   5.151  36.285 1.77e-05 ***
## llum:temp    1  0.630   0.630   4.439 0.051268 .  
## Residuals   16  2.271   0.142                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb670"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb670-1"><a href="chap-ANOVA.html#cb670-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(GSI<span class="sc">~</span>llum<span class="sc">:</span>temp,<span class="at">data=</span>peixos))</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## llum:temp    3  8.862   2.954   20.81 9.06e-06 ***
## Residuals   16  2.271   0.142                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>La primera funció calcula les fileres “Factor A”, “Factor B”, “Interacció AB” i “Residus” de la taula ANOVA, i de la segona funció us heu de quedar amb la primera filera, que us dóna la filera “Tractaments” de la taula ANOVA. No confongueu les fileres <code>llum:temp</code> de la primera taula, que és la de les Interaccions, amb la de la segona, que és la dels Tractaments.</p>
</div>
</div>
<div id="test-de-la-lliçó-10" class="section level2" number="10.5">
<h2><span class="header-section-number">10.5</span> Test de la lliçó 10</h2>
<p><strong>(1)</strong> Per què serveix una Anàlisi de la Variància?</p>
<ol style="list-style-type: decimal">
<li>Per contrastar si els valors mitjans d’una variable quantitativa sobre diverses poblacions són tots diferents o no</li>
<li>Per contrastar si els valors mitjans d’una variable quantitativa sobre diverses poblacions són tots iguals o no</li>
<li>Per contrastar si entre els valors mitjans d’una variable quantitativa sobre diverses poblacions n’hi ha exactament dos que siguin diferents o no.</li>
<li>Per contrastar si les mitjanes mostrals d’una variable quantitativa sobre diverses mostres extretes de diferents subpoblacions són totes iguals o no</li>
<li>Per contrastar si les mitjanes mostrals d’una variable quantitativa sobre diverses mostres extretes de diferents subpoblacions són totes diferents o no</li>
<li>Per contrastar si les variàncies d’una variable quantitativa sobre diverses poblacions són totes diferents o no</li>
<li>Per contrastar si les variàncies d’una variable contínua sobre diverses poblacions són totes iguals o no</li>
</ol>
<p><strong>(2)</strong> Quina és la hipòtesi alternativa en el contrast que efectuam amb una ANOVA?</p>
<ol style="list-style-type: decimal">
<li>Que totes les mitjanes mostrals són diferents.</li>
<li>Que totes les mitjanes poblacionals són diferents.</li>
<li>Que hi ha alguna parella de mitjanes mostrals que són diferents</li>
<li>Que hi ha alguna parella de mitjanes poblacionals que són diferents</li>
<li>Que hi ha exactament una parella de mitjanes mostrals que són diferents</li>
<li>Que hi ha exactament una parella de mitjanes poblacionals que són diferents</li>
<li>Cap de les anteriors</li>
</ol>
<p><strong>(3)</strong> Un contrast d’homogeneïtat on comparam la probabilitat d’èxit d’una variable Bernoulli sobre diferents poblacions (per veure si sempre és la mateixa o no) es pot entendre com un contrast d’igualtat de mitjanes. Si les mostres són prou grans, podem emprar una ANOVA per efectuar-lo?</p>
<ol style="list-style-type: decimal">
<li>Sí</li>
<li>No</li>
</ol>
<p><strong>(4)</strong> Què seria un error de tipus II en una ANOVA?</p>
<ol style="list-style-type: decimal">
<li>Concloure que totes les mitjanes mostrals són iguals quan en realitat són totes diferents</li>
<li>Concloure que hi ha una parella de mitjanes mostrals que són iguals quan en realitat són totes diferents</li>
<li>Concloure que totes les mitjanes mostrals són iguals quan en realitat n’hi ha alguna parella que són diferents</li>
<li>Concloure que totes les mitjanes poblacionals són iguals quan en realitat són totes diferents</li>
<li>Concloure que hi ha una parella de mitjanes poblacionals que són iguals quan en realitat són totes diferents</li>
<li>Concloure que totes les mitjanes poblacionals són iguals quan en realitat n’hi ha alguna parella que són diferents</li>
</ol>
<p><strong>(5)</strong> Per poder efectuar una ANOVA d’1 via, cal que totes les mostres tenguin la mateixa mida?</p>
<ol style="list-style-type: decimal">
<li>Sí</li>
<li>No</li>
</ol>
<p><strong>(6)</strong> Quines de les condicions següents són necessàries per poder efectuar una ANOVA d’1 via?</p>
<ol style="list-style-type: decimal">
<li>Les variables poblacionals han de ser normals</li>
<li>Les variables poblacionals han de ser normals o les mostres han de ser grans</li>
<li>Les variàncies de les mostres han de ser totes iguals</li>
<li>Les variàncies de les poblacions definides pels nivells han de ser totes iguals</li>
<li>Les variàncies de les poblacions definides pels nivells no poden ser totes diferents</li>
<li>Les distribucions de les poblacions definides pels nivells han de ser totes la mateixa (han de ser de la mateixa família i tenir els mateixos paràmetres)</li>
<li>Les mostres han de ser independents</li>
<li>Les mostres han de ser aparellades</li>
</ol>
<p><strong>(7)</strong> Per contrastar si tres somnífers tenen el mateix efecte, prenc 10 persones i durant 3 dies consecutius a cada una li don cada dia un somnífer diferent, en un ordre escollit a l’atzar, a l’hora d’anar a dormir i mesur el temps que tarda en dormir-se. Aquest experiment, te el disseny experimental d’una ANOVA d’1 via?</p>
<ol style="list-style-type: decimal">
<li>Sí</li>
<li>No</li>
</ol>
<p><strong>(8)</strong> Si en efectuar una ANOVA d’1 via va i resulta que la identitat de la suma de quadrats no se satisfà, què ha passat?</p>
<ol style="list-style-type: decimal">
<li>Un error de tipus I</li>
<li>Un error de tipus II</li>
<li>Un error de càlcul</li>
</ol>
<p><strong>(9)</strong> Quines de les afirmacions següents sobre l’ANOVA d’1 via són correctes? Marcau totes les respostes correctes.</p>
<ol style="list-style-type: decimal">
<li>La variància total és igual a la suma de les variàncies dels tractaments més la suma de la variància dels residus.</li>
<li>La suma total de quadrats és igual a la suma dels quadrats dels tractaments més la suma dels quadrats dels residus.</li>
<li>La variància de les dades és igual a la suma del quadrat mitjà dels tractaments més el quadrat mitjà dels residus.</li>
<li>La suma dels dos graus de llibertat de la distribució F de l’estadístic de contrast és igual al nombre total de dades.</li>
<li>Les mostres dels diferents tractaments poden tenir mides diferents.</li>
<li>Cap de les respostes anteriors és correcta.</li>
</ol>
<p><strong>(10)</strong> Hem realitzat una ANOVA d’1 via. Les dues primeres columnes de la taula resultant són:
<span class="math display">\[
\begin{array}{|@{}l@{}|l@{}|l@{}|l@{}|l|l|}
\hline
\text{Font de}&amp;\text{Graus de}\hphantom{x} &amp;\text{Suma de}\hphantom{x}&amp;\text{Quadrats}\hphantom{x} &amp;\text{Estadístic}\hphantom{x} &amp; \text{p-valor}\\
\text{variació}&amp;\text{llibertat}&amp;\text{quadrats}&amp;\text{mitjans}&amp; &amp; \\\hline
\text{Tractament}&amp; 3 &amp; 215.1 &amp; &amp; &amp; \\[1ex]
\text{Error}&amp; 21 &amp; 147.3 &amp; &amp; &amp;\\\hline
\end{array}
\]</span>
Quines de les afirmacions següents són vertaderes? Marcau totes les respostes correctes.</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(SS_{Total}= 215.1+147.3=362.4\)</span></li>
<li>El nombre de nivells del factor d’interès és 3</li>
<li>El nombre total de dades ha estat 24</li>
<li>El nombre total de dades ha estat 25</li>
<li>La distribució de l’estadístic de contrast és F de Fisher amb 3 i 21 graus de llibertat</li>
<li>La distribució de l’estadístic de contrast és F de Fisher amb 21 i 3 graus de llibertat</li>
<li>Cap de les altres respostes és correcta</li>
</ol>
<p><strong>(11)</strong> Si volem realitzar un contrast posterior per parelles després d’una ANOVA d’1 via on hem comparat 5 tractaments, i empram el mètode d’ajust de Bonferroni, per quin valor hem de multiplicar els p-valors dels contrastos individuals?</p>
<ol style="list-style-type: decimal">
<li>Per 5.</li>
<li>Per 10.</li>
<li>Per 20.</li>
<li>Per 1/5.</li>
<li>Per 1/10.</li>
<li>Per 1/20.</li>
<li>Cap de les respostes anteriors és correcta.</li>
</ol>
<p><strong>(12)</strong> S’ha realitzat un assaig clínic dirigit a comparar l’efectivitat de tres tractaments alternatius en pacients cirròtics, provant-los sobre tres grups independents de 50 malalts cadascun. La variable de resposta ha estat el nivell de transaminasses, que és contínua i de distribució asimètrica a la dreta. Quina de les proves estadístiques següents és la més adequada per contrastar si els tres tractaments tenen la mateixa efectivitat o no?:</p>
<ol style="list-style-type: decimal">
<li>3 proves t per a mostres independents, una per a cada parell de tractaments</li>
<li>Una anàlisi de la variància</li>
<li>Un contrast d’homogeneïtat</li>
<li>Un test de Kruskal-Wallis</li>
<li>3 proves de Mann-Whitney, una per a cada parell de tractaments</li>
</ol>
<p><strong>(13)</strong> En una ANOVA de blocs, per calcular el p-valor hem emprat una distribució F amb 3 i 21 graus de llibertat. De quina mida era la mostra completa que hi hem emprat?</p>
<ol style="list-style-type: decimal">
<li>De 21 individus</li>
<li>De 24 individus</li>
<li>De 32 individus</li>
<li>De 63 individus</li>
<li>No ho podem saber a partir d’aquests nombres de graus de llibertat</li>
<li>Cap de les altres respostes és correcta</li>
</ol>
<p><strong>(14)</strong> Hem realitzat una ANOVA de blocs. Hi comparàvem 3 tractaments i hem emprat 10 blocs; les dades no han estat totes iguals. Si haguéssim analitzat les mateixes dades, de manera incorrecta, amb una ANOVA d’1 via, quines de les afirmacions següents segur que serien vertaderes? Marcau totes les respostes correctes.</p>
<ol style="list-style-type: decimal">
<li>La suma de quadrats total hagués estat més gran</li>
<li>La suma de quadrats dels errors hagués estat més petita</li>
<li>La suma de quadrats dels errors hagués estat més gran</li>
<li>El quadrat mitjà dels errors hagués estat més petit</li>
<li>El quadrat mitjà dels errors hagués estat més gran</li>
<li>El segon nombre de graus de llibertat de l’estadístic F emprat per calcular el p-valor seria més petit</li>
<li>El segon nombre de graus de llibertat de l’estadístic F emprat per calcular el p-valor seria més gran</li>
<li>Cap de les altres respostes és correcta</li>
</ol>
<p><strong>(15)</strong> És possible que una ANOVA de blocs, per calcular el p-valor hàgim d’emprar una distribució F amb 3 i 22 graus de llibertat?</p>
<ol style="list-style-type: decimal">
<li>Sí</li>
<li>No</li>
</ol>
<p><strong>(16)</strong> És possible que una ANOVA d’1 via, per calcular el p-valor hàgim d’emprar una distribució F amb 3 i 22 graus de llibertat?</p>
<ol style="list-style-type: decimal">
<li>Sí</li>
<li>No</li>
</ol>
<p><strong>(17)</strong> Respecte al test de Friedman, quines de les afirmacions següents són correctes? Marcau totes les respostes correctes.</p>
<ol style="list-style-type: decimal">
<li>És un test no paramètric.</li>
<li>S’utilitza per comparar les mitjanes (en realitat, les medianes) de tres o més poblacions a partir de mostres independents.</li>
<li>S’utilitza per comparar les mitjanes (en realitat, les medianes) de tres o més poblacions a partir de mostres aparellades.</li>
<li>Si l’aplicam a 2 mostres, és equivalent al test de Wilcoxon</li>
<li>Si l’aplicam a 2 mostres, és equivalent al test de Mann-Whitney</li>
<li>Requereix que les mostres provenguin de distribucions normals.</li>
<li>Requereix que les mostres provenguin de distribucions NO normals.</li>
</ol>
<p><strong>(18)</strong> En una ANOVA de 2 vies, en quantes fonts de variabilitat independents descompon la variabilitat total?</p>
<ol style="list-style-type: decimal">
<li>2</li>
<li>3</li>
<li>4</li>
<li>5</li>
<li>Cap de les altres respostes és correcta</li>
</ol>
<p><strong>(19)</strong> Respecte al test de Kruskal-Wallis, quines de les afirmacions següents són correctes? Marcau totes les respostes correctes.</p>
<ol style="list-style-type: decimal">
<li>És un test no paramètric.</li>
<li>S’utilitza per comparar les mitjanes (en realitat, les medianes) de tres o més poblacions a partir de mostres independents.</li>
<li>S’utilitza per comparar les mitjanes (en realitat, les medianes) de tres o més poblacions a partir de mostres aparellades.</li>
<li>Si l’aplicam a 2 mostres, és equivalent al test de Wilcoxon</li>
<li>Si l’aplicam a 2 mostres, és equivalent al test de Mann-Whitney</li>
<li>Requereix que les mostres provenguin de distribucions normals.</li>
<li>Requereix que les mostres provenguin de distribucions NO normals.</li>
</ol>
<p><strong>(20)</strong> Hem realitzat una ANOVA de blocs. Les dues primeres columnes de la taula resultant són:
<span class="math display">\[
\begin{array}{|@{}l@{}|l@{}|l@{}|l@{}|l|l|}
\hline
\text{Font de}&amp;\text{Graus de}\hphantom{x} &amp;\text{Suma de}\hphantom{x}&amp;\text{Quadrats}\hphantom{x} &amp;\text{Estadístic}\hphantom{x} &amp; \text{p-valor}\\
\text{variació}&amp;\text{llibertat}&amp;\text{quadrats}&amp;\text{mitjans}&amp; &amp; \\\hline
\text{Tractament}&amp; 3 &amp; 6.75 &amp; &amp; &amp; \\[1ex]
\text{Blocs} &amp; 9 &amp;1.55&amp; &amp; &amp;\\[1ex]
\text{Error}&amp; 27 &amp;8.32&amp; &amp; &amp;\\\hline
\end{array}
\]</span></p>
<p>Quina o quines de les afirmacions següents són vertaderes? Marcau totes les respostes correctes.</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(SS_{Total}=6.75+8.32=15.07\)</span></li>
<li>El quadrat mitjà dels tractaments és aproximadament 2.25</li>
<li>El nombre total de dades ha estat 30</li>
<li>El nombre total de dades ha estat 40</li>
<li>Cap de les altres respostes és correcta</li>
</ol>
<p><strong>(21)</strong> En una ANOVA de blocs hem obtingut un p-valor molt més petit que el nivell de significació. Quina és la conclusió correcta? Marcau només una resposta.</p>
<ol style="list-style-type: decimal">
<li>Que hi ha qualque parella de mitjanes mostrals dels tractaments que han estat diferents.</li>
<li>Que hi ha qualque parella de mitjanes poblacionals dels tractaments que són diferents.</li>
<li>Que hi ha qualque parella de mitjanes poblacionals dels blocs que són diferents.</li>
<li>Que hi ha qualque parella de mitjanes poblacionals dels blocs que han estat diferents.</li>
<li>Que les mitjanes mostrals dels tractaments han estat totes diferents.</li>
<li>Que les mitjanes poblacionals dels tractaments són totes diferents.</li>
<li>Que les mitjanes mostrals dels blocs han estat totes diferents.</li>
<li>Que les mitjanes poblacionals dels blocs són totes diferents.</li>
<li>Cap de les respostes anteriors és correcta.</li>
</ol>
<p><strong>(22)</strong> Quines de les afirmacions següents sobre l’ANOVA de blocs són correctes? Marcau totes les correctes:</p>
<ol style="list-style-type: decimal">
<li>Rebutjarem la hipòtesi nul·la si la suma de quadrats dels residus és prou gran.</li>
<li>Rebutjarem la hipòtesi nul·la si la suma de quadrats dels blocs és prou gran.</li>
<li>Rebutjarem la hipòtesi nul·la si la suma de quadrats dels tractaments és prou gran.</li>
<li>La suma de quadrats total és igual a la suma de quadrats dels tractaments més la suma dels quadrats dels residus.</li>
<li>La suma de quadrats total és igual a la suma de quadrats dels tractaments més la suma dels quadrats dels blocs.</li>
</ol>
<p><strong>(23)</strong> Què significa que hi hagi interacció entre els dos factors en una ANOVA de 2 factors?</p>
<ol style="list-style-type: decimal">
<li>Que almenys en un dels factors hem trobat diferències estadísticament significatives</li>
<li>Que hem trobat en els dos factors diferències estadísticament significatives entre les mitjanes</li>
<li>Que les diferències entre les mitjanes poblacionals dels nivells d’un dels factors depenen del nivell de l’altre factor</li>
<li>Que les diferències entre les mitjanes poblacionals dels nivells d’un dels factors són independents del nivell de l’altre factor</li>
<li>Que els dos factors no són variables independents</li>
</ol>
<p><strong>(24)</strong> En un assaig clínic es comparen 3 tractaments (placebo, tractament establert i un tractament nou) sobre 3 grups de pacients escollits de manera independent. Acceptam que la variable resposta té distribució normal i amb la mateixa variància sota cada un dels tractaments. Quina de les proves estadístiques següents és la més adequada per comparar aquesta resposta?</p>
<ol style="list-style-type: decimal">
<li>Tres tests t de mitjanes</li>
<li>Un test de Wilcoxon</li>
<li>Una anàlisi de la variància</li>
<li>Un test de Kruskal-Wallis</li>
<li>Un test khi-quadrat</li>
</ol>
<p><strong>(25)</strong> En un assaig clínic es comparen 3 tractaments (placebo, tractament establert i un tractament nou) sobre 3 grups de pacients escollits de manera independent. Acceptam que la variable resposta té distribució normal i quan aplicam a les mostres el test de Bartlett dóna un p-valor molt petit. Quina de les proves estadístiques següents és la més adequada per comparar aquesta resposta?</p>
<ol style="list-style-type: decimal">
<li>Tres tests t de mitjanes</li>
<li>Un test de Wilcoxon</li>
<li>Una anàlisi de la variància</li>
<li>Un test de Kruskal-Wallis</li>
<li>Un test khi-quadrat</li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chap-ED.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="regressió-lineal.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection",
"download": ["pdf", "epub"]
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
