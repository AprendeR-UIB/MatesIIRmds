[
["index.html", "Matemàtiques II Presentació", " Matemàtiques II 2021-02-01 Presentació Això és una edició en línea dels apunts de Matemàtiques II dels graus de Biologia i Bioquímica de la UIB. Aquests apunts no són autocontinguts pel que fa al R: suposam que l’estudiant va llegint les lliçons de R corresponents a cada tema a la 2a part del manual AprendeR. Aquests apunts estan en construcció. A la llista següent hi anirem anunciant les actualitzacions. 17-02-2021: Pujats temes 1, 2 i 3 Significats d’algunes capses: Material molt important. Alerta! Exercici. Detalls matemàtics que us poden interessar, però que no cal saber. Comentari que volem emfatitzar. Comentari que volem que recordeu. Qüestió en què volem que caigueu. Acabam de matar un moixet. El llibre està escrit en R Markdown, emprant RStudio com a editor de textos i el paquet bookdown per convertir els fitxers markdown en un llibre Aquest treball se publica sota llicència Atribució-No Comercial-SenseDerivats 4.0 "],
["chap-varal.html", "Tema 1 Variables aleatòries 1.1 Generalitats sobre variables aleatòries 1.2 Variables aleatòries discretes 1.3 Famílies importants de variables aleatòries discretes 1.4 Variables aleatòries contínues 1.5 Variables aleatòries normals 1.6 Test de la lliçó 1", " Tema 1 Variables aleatòries 1.1 Generalitats sobre variables aleatòries Una variable aleatòria sobre una població \\(\\Omega\\) és simplement una funció \\[ X: \\Omega\\to \\mathbb{R} \\] que assigna a cada subjecte d’\\(\\Omega\\) un nombre real. La idea intuïtiva que hi ha al darrera d’aquesta definició és que una variable aleatòria mesura una característica dels subjectes d’\\(\\Omega\\) que varia a l’atzar d’un subjecte a un altre. Per exemple: Prenem una persona d’una població i mesuram el seu nivell de colesterol, o la seva alçada, o el seu nombre de fills… En aquest cas, \\(\\Omega\\) és la població sota estudi, de la qual prenem la persona que mesuram. Llançam una moneda equilibrada 3 vegades i comptam les cares que obtenim. En aquest cas, \\(\\Omega\\) és la població formada per totes les seqüències de 3 llançaments d’una moneda equilibrada passades, presents i futures. Procurau adquirir la disciplina de descriure sempre les variables aleatòries mitjançant una plantilla de l’estil de “Prenem … i mesuram …”, perquè us quedi clar quina és la població i quina la funció. A més, afegiu-hi les unitats si és necessari. Per exemple: \\(X\\): “Prenem una persona de Mallorca i mesuram la seva alçada (en cm)”. Fixau-vos en què aquesta variable aleatòria no és la mateixa que \\(Y\\): “Prenem una persona de Mallorca i mesuram la seva alçada (en m)” perquè, encara que totes dues mesuren el mateix sobre els mateixos subjectes, els assignen números diferents. I \\(X\\) també és diferent de \\(Z\\): “Prenem una persona de Suècia i mesuram la seva alçada (en cm)” perquè ha canviat la població. En canvi a “Llançam una moneda 3 vegades i comptam les cares” no hi ha necessitat d’especificar unitats, tret que volgueu emprar una unitat inesperada (jo què sé, que compteu les cares en fraccions de dotzena). El que més ens interessarà d’una variable aleatòria són les probabilitats dels esdeveniments que defineix. I quin tipus d’esdeveniments són els que ens interessen quan mesuram característiques numèriques? Doncs bàsicament esdeveniments definits mitjançant igualtats i desigualtats. Per exemple, si \\(X\\) és la variable aleatòria “Prenem una persona i mesuram el seu nivell de colesterol en plasma (en mg/dl)”, ens poden interessar esdeveniments de l’estil de: El conjunt de les persones amb nivell de colesterol entre 200 i 240. L’indicarem amb \\[ 200\\leq X\\leq 240 \\] El conjunt de les persones amb nivell de colesterol més petit o igual que 200: \\[ X\\leq 200 \\] El conjunt de les persones amb nivell de colesterol més gran que 180: \\[ X&gt;180 \\] El conjunt de les persones amb nivell de colesterol exactament 180: \\[ X=180 \\] Etc. Com déiem, el que ens interessarà d’aquests esdeveniments serà la seva probabilitat, i llavors emprarem notacions de l’estil de les següents: \\(P(200\\leq X\\leq 240)\\). Això indica la probabilitat que una persona tengui el nivell de colesterol entre 200 i 240. Per abreujar, ho llegirem la “probabilitat que \\(X\\) estigui entre 200 i 240” i representa la proporció de persones (de la població \\(\\Omega\\) on hàgim definit la variable \\(X\\)) amb nivell de colesterol entre 200 i 240. \\(P(X\\leq 200)\\). Això indica la probabilitat que una persona tengui el nivell de colesterol més petit o igual que 200 (per abreujar, la probabilitat que “\\(X\\) sigui més petit o igual que 200”). És a dir, la proporció de persones amb nivell de colesterol més petit o igual que 200. Etc. En aquest context, indicarem normalment la unió amb una o i la intersecció amb una coma. Per exemple, si \\(X\\) és la variable aleatòria “Llançam una moneda 6 vegades i comptam les cares”: \\(P(X\\leq 2\\text{ o }X\\geq 5)\\): Probabilitat de treure com a màxim 2 cares o com a mínim 5. \\(P(2\\leq X, X&lt; 5)\\): Probabilitat de treure un nombre de cares que sigui més gran o igual que 2 i més petit que 5; és a dir, \\(P(2\\leq X&lt; 5)\\). Dues variables aleatòries \\(X,Y\\) són independents quan, per a tots els parells de valors \\(a,b\\in \\mathbb{R}\\), els esdeveniments \\[ X\\leq a, Y\\leq b \\] són independents. És a dir, quan el valor que pren \\(X\\) sobre un subjecte no afecta per res el valor que hi pren \\(Y\\), i viceversa. El fet que els esdeveniments \\(X\\leq a\\) i \\(Y\\leq b\\) siguin independents és equivalent a cada una de les tres condicions següents: \\[ \\begin{array}{l} P(X\\leq A|Y\\leq b)=P(X\\leq a)\\\\ P(Y\\leq b|X\\leq A)=P(Y\\leq b)\\\\ P(X\\leq a, Y\\leq b)=P(X\\leq a)\\cdot P(Y\\leq b) \\end{array} \\] Per exemple, si prenem una persona i: \\(X\\): li demanam que llanci una moneda 3 vegades i comptam les cares \\(Y\\): mesuram el seu nivell de colesterol en plasma (en mg/dl) (segurament) \\(X\\) i \\(Y\\) són independents. Més en general, unes variables aleatòries \\(X_1,X_2,\\ldots,X_n\\) són independents quan, per a tots \\(a_1,a_2,\\ldots,a_n\\in \\mathbb{R}\\), els esdeveniments \\[ X_1\\leq a_1, X_2\\leq a_2,\\ldots, X_n\\leq a_n \\] són independents. És a dir, quan el valor que pren una d’aquestes variables sobre un subjecte no afecta per res els valors que hi prenen les altres. 1.2 Variables aleatòries discretes Una variable aleatòria és discreta quan els seus possibles valors són dades quantitatives discretes. Per exemple, Nombre de cares en 3 llançaments d’una moneda Nombre de fills Nombre de casos nous de COVID-19 en un dia a Mallorca 1.2.1 Densitat i distribució Sigui \\(X: \\Omega\\to \\mathbb{R}\\) una variable aleatòria discreta. El seu domini \\(D_X\\) és el conjunt dels valors que pot prendre: més concretament, el conjunt dels \\(x\\in \\mathbb{R}\\) tals que \\(P(X=x)&gt;0\\). La seva funció de densitat és la funció \\(f_X:\\mathbb{R}\\to [0,1]\\) que assigna a cada \\(x\\in \\mathbb{R}\\) la probabilitat que \\(X\\) valgui \\(x\\): \\[ f_X(x)=P(X=x) \\] És a dir, \\(f_X(x)\\) és la proporció de subjectes de la població en els quals \\(X\\) val \\(x\\). La seva funció de distribució és la funció \\(F_X:\\mathbb{R}\\to [0,1]\\) que assigna a cada \\(x\\in \\mathbb{R}\\) la probabilitat que \\(X\\) sigui més petit o igual que \\(x\\): \\[ F_X(x)=P(X\\leq x) \\] És a dir, \\(F_X(x)\\) és la proporció de subjectes de la població en els quals \\(X\\) pren un valor \\(\\leq x\\). A la funció de distribució també se li sol dir la funció de probabilitat acumulada per posar èmfasi en el fet que \\(F_X(x)\\) mesura la “freqüència relativa acumulada” de \\(x\\) en el total de la població. Exemple 1.1 Sigui \\(X\\) la variable aleatòria “Llançam 3 vegades una moneda equilibrada i comptam les cares”. Aleshores: El seu domini és el conjunt dels seus possibles valors: \\(D_X=\\{0,1,2,3\\}\\). La seva funció de densitat és definida per \\(f_X(x)=P(X=x)\\): \\(f_X(0)=P(X=0)=1/8\\) (la probabilitat de treure 0 cares en 3 llançaments) \\(f_X(1)=P(X=1)=3/8\\) (la probabilitat de treure 1 cara en 3 llançaments) \\(f_X(2)=P(X=2)=3/8\\) (la probabilitat de treure 2 cares en 3 llançaments) \\(f_X(3)=P(X=3)=1/8\\) (la probabilitat de treure 3 cares en 3 llançaments) \\(f_X(x)=P(X=x)=0\\) per a qualsevol altre valor de \\(x\\) (si \\(x\\notin\\{0,1,2,3\\}\\), la probabilitat de treure \\(x\\) cares en 3 llançaments és 0) En resum, la funció de densitat de \\(X\\) és \\[ f_X(x) =\\left\\{ \\begin{array}{ll} 1/8 &amp; \\text{ si $x=0$}\\\\ 3/8 &amp; \\text{ si $x=1$}\\\\ 3/8 &amp; \\text{ si $x=2$}\\\\ 1/8 &amp; \\text{ si $x=3$}\\\\ 0 &amp; \\text{ si $x\\neq 0,1,2,3$} \\end{array} \\right. \\] Figura 1.1: Funció de densitat de la variable aleatòria que compta el nombre de cares en 3 llançaments Si \\(X\\) és una variable aleatòria discreta, \\(P(X\\in A)=0\\) per a qualsevol subconjunt \\(A\\) disjunt amb \\(D_X\\), perquè, per la definició del domini \\(D_X\\), \\(X\\) no pot prendre cap valor fora de \\(D_X\\). Per exemple, quina és la probabilitat de treure entre 2.5 i 2.7 cares en llançar 3 vegades una moneda? 0. I la de treure \\(\\pi\\) cares? 0 un altre cop. Vegem ara la seva funció de distribució \\(F_X\\). Recordau que \\(F_X(x)=P(X\\leq x)\\) i que la nostra variable només pot prendre els valors 0, 1, 2 i 3. Si \\(x&lt;0\\), \\(F_X(x)=P(X\\leq x)=0\\) perquè \\(X\\) no pot prendre cap valor estrictament negatiu. Si \\(0\\leq x&lt;1\\), \\(F_X(x)=P(X\\leq x)=P(X=0)=f_X(0)=1/8\\), perquè si \\(0\\leq x&lt;1\\), l’únic valor \\(\\leq x\\) que pot prendre \\(X\\) és el 0. Si \\(1\\leq x&lt;2\\), \\(F_X(x)=P(X\\leq x)=P(X=0\\text{ o }X=1)\\) \\(=f_X(0)+f_X(1)=4/8=1/2\\), perquè si \\(1\\leq x&lt;2\\), els únics valors \\(\\leq x\\) que pot prendre \\(X\\) són 0 i 1. Si \\(2\\leq x&lt;3\\), \\(F_X(x)=P(X\\leq x)=P(X=0\\text{ o }X=1\\text{ o }X=2)\\) \\(=f_X(0)+f_X(1)+f_X(2)=7/8\\), perquè si \\(2\\leq x&lt;3\\), els únics valors \\(\\leq x\\) que pot prendre \\(X\\) són 0, 1 i 2. Si \\(3\\leq x\\), \\(F_X(x)=P(X\\leq x)=1\\), perquè si \\(3\\leq x\\), segur que obtenim un nombre de cares \\(\\leq x\\). Per tant, la funció \\(F_X\\) és la funció \\[ F_X(x) =\\left\\{ \\begin{array}{ll} 0 &amp; \\text{ si $x&lt;0$}\\\\ 1/8 &amp; \\text{ si $0\\leq x&lt; 1$}\\\\ 4/8 &amp; \\text{ si $1\\leq x&lt; 2$}\\\\ 7/8 &amp; \\text{ si $2\\leq x&lt; 3$}\\\\ 1 &amp; \\text{ si $3\\leq x$} \\end{array} \\right. \\] El seu gràfic és el següent: Figura 1.2: Funció de distribució de la variable aleatòria que compta el nombre de cares en 3 llançaments Observau en aquest gràfic que aquesta funció de distribució \\(F_X\\) és creixent i escalonada. Això és general. Si \\(X\\) és una variable aleatòria discreta: \\(F_X\\) és una funció escalonada, amb bots en els valors de \\(D_X\\), que són els únics amb probabilitat estrictament més gran que 0 i per tant els únics que “sumen” probabilitat. Això també fa que \\(F_X\\) sigui constant entre valors consecutius de \\(D_X\\). \\(F_X\\) és creixent, perquè si \\(x\\leq y\\), tots els subjectes de \\(X\\leq x\\) també pertanyen a \\(X\\leq y\\), i per tant \\[ P(X\\leq x)\\leq P(X\\leq y). \\] Si \\(x_0,y_0\\in D_X\\) i \\(x_0&lt;y_0\\), llavors \\(F_X(x_0)&lt; F_X(y_0)\\), perquè, com que \\(P(X=y_0)&gt;0\\), \\[ \\begin{array}{rl} F_X(x_0)\\!\\!\\!\\!\\! &amp; =P(X\\leq x_0)&lt;P(X\\leq x_0)+P(X=y_0)\\\\ &amp; =P(X\\leq x_0\\text{ o }X=y_0)\\leq P(X\\leq y_0)=F_X(y_0) \\end{array} \\] Com que els valors que pren \\(F_X\\) són probabilitats, no poden ser ni més petits que 0 ni més grans que 1. El coneixement de \\(f_X\\), més les regles del càlcul de probabilitats, permet calcular la probabilitat de qualsevol esdeveniment relacionat amb \\(X\\): \\[ P(X\\in A) =\\sum_{x\\in A} P(X=x) = \\sum_{x\\in A} f_X(x) \\] En particular \\[ F_X(x_0)=P(X\\leq x_0)=\\sum_{x\\leq x_0} f_X(x) \\] La moda d’una variable aleatòria discreta \\(X\\) és el valor (o els valors) \\(x_0\\) tal que \\(f_X(x_0)=P(X=x_0)\\) és màxim. Es tracta per tant del valor de \\(X\\) més probable o més freqüent en la població. Per exemple, per a la nostra variable aleatòria que compta el nombre de cares en 3 llançaments d’una moneda equilibrada, la moda són els valors 1 i 2. Hi ha un aspecte de les variables aleatòries discretes sobre el qual volem cridar l’atenció, sobretot per a comparar-lo després amb les variables contínues: Si \\(x\\in D_X\\), \\(P(X&lt;x)&lt;P(X\\leq x)\\), perquè \\(P(X\\leq x)=P(X&lt;x)+P(X=x)&gt;P(X&lt;x)\\). Per exemple, amb la variable \\(X\\) “Llançam una moneda equilibrada 3 vegades i comptam les cares”: La probabilitat de treure 2 cares o menys ja l’hem calculada, i és \\(P(X\\leq 2)=7/8\\) Però la probabilitat de treure menys de 2 cares, \\(P(X&lt;2)\\), és la de treure 1 cara o menys, per tant \\(P(X&lt;2)=P(X\\leq 1)=4/8\\). Considerau la variable aleatòria \\(X\\) “Llançam una moneda equilibrada tantes vegades com sigui necessari fins que surti una cara per primera vegada, i comptam quantes vegades l’hem haguda de llançar”. Quin és el seu domini? Quina és la seva funció de densitat? Quina és la seva moda? Què significa? Quina és la seva funció de distribució? (Indicació: Calculau primer \\(P(X&gt;x)\\), tenint en compte que \\(X&gt;x\\) significa que en els primer \\(x\\) llançaments ha sortit creu, i per això hem hagut de llançar la moneda més de \\(x\\) vegades per obtenir una cara.) 1.2.2 Esperança Quan prenem una mostra d’una variable aleatòria \\(X\\) definida sobre una població, podem calcular la mitjana i la desviació típica dels seus valors a fi i efecte d’obtenir una idea de quin és el valor central de la mostra i si els seus valors estan tots molt a prop d’aquest valor central o no. Naturalment, també ens podem preguntar per aquesta mena d’informació per al total de la població: Quin és el “valor mitjà” de \\(X\\) sobre tota la població? Aquesta variable, pren valors molt dispersos, o més aviat els pren concentrats al voltant del seu valor mitjà? La primera pregunta la responem amb la mitjana, o esperança, de \\(X\\), i la segona amb la seva variància i la seva desviació típica. Comencem amb la primera. La mitjana, o esperança (o valor esperat, valor mitjà…), d’una variable aleatòria discreta \\(X\\) amb densitat \\(f_X:D_X\\to [0,1]\\) és \\[ E(X)=\\sum_{x\\in D_X} x\\cdot f_X(x) \\] Sovint també la indicarem amb \\(\\mu_X\\). La interpretació natural de \\(E(X)\\) és que és la mitjana dels valors de la variable \\(X\\) en el total de la població \\(\\Omega\\). En efecte, com que \\(P(X=x)\\) és la proporció de subjectes d’\\(\\Omega\\) en els quals \\(X\\) val \\(x\\), \\[ E(X)=\\sum_{x\\in D_X} x\\cdot P(X=x) \\] és la mitjana del valor de \\(X\\) sobre tots els subjectes d’\\(\\Omega\\). Comparau-ho amb l’exemple següent. Exemple 1.2 Si, en una classe, un 10% dels estudiants han tret un 4 en un examen, un 20% un 6, un 50% un 8 i un 20% un 10, quina ha estat la nota mitjana obtinguda? Segurament calcularíeu aquesta mitjana de la manera següent: \\[ 4\\cdot 0.1+6\\cdot 0.2+8\\cdot 0.5+10\\cdot 0.2=7.6 \\] Doncs aquest valor és la mitjana de la variable aleatòria “Prenc un estudiant d’aquesta classe i mir quina nota ha tret en aquest examen”: \\[ \\begin{array}{rl} E(X)\\!\\!\\!\\!\\! &amp;=4\\cdot P(X=4)+6\\cdot P(X=6)+8\\cdot P(X=8)+10\\cdot P(X=10)\\\\ &amp; = 4\\cdot 0.1+6\\cdot 0.2+8\\cdot 0.5+10\\cdot 0.2=7.6 \\end{array} \\] A banda de la seva interpretació com a “la mitjana de \\(X\\) en el total de la població”, \\(E(X)\\) és també el valor esperat de \\(X\\), en el sentit següent: Suposau que prenem a l’atzar una mostra de \\(n\\) subjectes de la població, mesuram \\(X\\) sobre ells i calculam la mitjana aritmètica dels \\(n\\) valors obtinguts. Aleshores, quan la mida \\(n\\) de la mostra tendeix a \\(\\infty\\), aquesta mitjana aritmètica tendeix a valer \\(E(X)\\) “gairebé sempre”, en el sentit que la probabilitat que el seu límit sigui \\(E(X)\\) és 1. És a dir: si mesuràssim \\(X\\) sobre molts subjectes triats a l’atzar i calculàssim la mitjana dels valors obtinguts, és gairebé segur que obtendríem un valor molt proper a \\(E(X)\\). Exemple 1.3 Seguim amb la variable aleatòria \\(X\\) “Llançam una moneda equilibrada 3 vegades i comptam les cares”. El seu valor esperat és \\[ E(X)= 0\\cdot \\frac{1}{8}+1\\cdot \\frac{3}{8}+2\\cdot \\frac{3}{8}+3\\cdot \\frac{1}{8}=1.5 \\] Això ens diu que: La mitjana de \\(X\\) és 1.5: El valor mitjà de la variable \\(X\\) sobre tota la població de seqüències de 3 llançaments d’una moneda equilibrada és 1.5. L’esperança de \\(X\\) és 1.5: Si repetíssim moltes vegades l’experiment de llançar la moneda 3 vegades i comptar les cares, la mitjana dels resultats obtinguts donaria, molt probablement, un valor molt pròxim a 1.5. Abreujam això dient que si llançam la moneda 3 vegades, esperam treure 1.5 cares. Més en general, si \\(g:\\mathbb{R}\\to \\mathbb{R}\\) és una funció, l’esperança de \\(g(X)\\) és \\[ E(g(X))=\\sum_{x\\in D_X} g(x)\\cdot f_X(x). \\] Un altre cop, la interpretació natural d’aquest valor és que és la mitjana de \\(g(X)\\) sobre la població, i també que és el valor “esperat” de \\(g(X)\\) en el sentit anterior. Exemple 1.4 Si llançam una moneda equilibrada 3 vegades, comptam les cares i elevam aquest nombre de cares al quadrat, quin valor esperam obtenir? Serà l’esperança de \\(X^2\\), on \\(X\\) és la variable aleatòria “Llançam una moneda equilibrada 3 vegades i comptam les cares” (és a dir, aquesta \\(X^2\\) és la variable aleatòria “Llançam una moneda equilibrada 3 vegades, comptam les cares i elevam aquest número al quadrat”): \\[ E(X^2)= 0\\cdot \\frac{1}{8}+1\\cdot \\frac{3}{8}+2^2\\cdot \\frac{3}{8}+3^2\\cdot \\frac{1}{8}=3 \\] Fixau-vos que \\(E(X^2) \\neq E(X)^2\\). Per exemple, en els dos darrers exemples hem vist que si \\(X\\) és la variable aleatòria que compta el nombre de cares en 3 llançaments d’una moneda equilibrada, \\(E(X^2)=3\\) però \\(E(X)^2=1.5^2=2.25\\). En general, donada una aplicació \\(g:\\mathbb{R}\\to \\mathbb{R}\\), el més habitual és que \\(E(g(X))\\neq g(E(X))\\). L’esperança de les variables aleatòries discretes té les propietats següents, totes molt raonables si les interpretau en termes del valor mitjà de \\(X\\) sobre la població: Sigui \\(b\\) una variable aleatòria constant, que sobre tots els individus de la població pren el mateix valor \\(b\\in \\mathbb{R}\\). Aleshores, \\(E(b)=b\\). Si en una classe tothom treu un 8 d’un examen, la nota mitjana és un 8, no? Sí, ja sabem que parlar de variables constants és un oxímoron, però de vegades una variable aleatòria pren el mateix valor sobre tots els subjectes d’una població. Per exemple “Prenc un estudiant de Biologia o Bioquímica del curs 2019/20 i compt el seu nombre de cames”. L’esperança és lineal: Si \\(X\\) és una variable aleatòria i \\(a,b\\in \\mathbb{R}\\), \\(E(aX+b)=aE(X)+b\\) Si en una classe la mitjana d’un examen ha estat un 6 i decidim multiplicar per 1.2 totes les notes i sumar-les 1 punt, la mitjana de la nova nota serà 1.2·6+1=8.2, no? Si \\(X,Y\\) són dues variables aleatòries, \\(E(X+Y)=E(X)+E(Y)\\). Si en una classe la mitjana de la part de qüestions d’un examen ha estat un 3.5 (sobre 5) i la de la part d’exercicis ha estat un 3 (sobre 5), la nota mitjana de l’examen serà un 3.5+3=6.5, no? Combinant les dues propietats anteriors, si \\(X_1,\\ldots,X_n\\) són variables aleatòries i \\(a_1,\\ldots,a_n,b\\in \\mathbb{R}\\), \\[ E(a_1X_1+\\cdots+a_nX_n+b)=a_1E(X_1)+\\cdots+a_nE(X_n)+b \\] L’esperança és monòtona creixent: Si \\(X\\leq Y\\) (en el sentit que el valor de \\(X\\) sobre cada subjecte de la població \\(\\Omega\\) és més petit o igual que el valor de \\(Y\\) sobre ell), llavors \\(E(X)\\leq E(Y)\\). Si tots traieu millor nota de Matemàtiques II que de Matemàtiques I, la nota mitjana de Matemàtiques II serà més gran que la de Matemàtiques I, no? 1.2.3 Variància i desviació típica La variància d’una variable aleatòria discreta \\(X\\) és \\[ \\sigma(X)^2 =E((X-\\mu_X)^2) =\\sum_{x\\in D_X} (x-\\mu_X)^2\\cdot f_X(x) \\] És a dir, és el valor mitjà del quadrat de la diferència entre \\(X\\) i la seva mitjana \\(\\mu_X\\). També la indicarem amb \\(\\sigma_X^2\\). Fixau-vos que es tracta de la traducció “poblacional” de la definició de variància per a una mostra, i per tant serveix per mesurar el mateix que aquella: la dispersió dels resultats de \\(X\\) respecte de la mitjana. Només que ara és per a tota la població, i no per a una mostra. La identitat següent vos pot ser útil quan hàgiu de calcular variàncies “a mà”. Teorema 1.1 \\(\\sigma(X)^2=E(X^2)-\\mu_X^2\\). Operem (i recordau que \\(E(X)=\\mu_X\\)) \\[ \\begin{array}{rl} \\sigma(X)^2\\!\\!\\!\\!\\! &amp; =E((X-\\mu_X)^2)=E(X^2-2\\mu_X\\cdot X+\\mu_X^2)\\\\ &amp; = E(X^2)-2\\mu_X\\cdot E(X)+\\mu_X^2\\\\ &amp; \\text{(per la linealitat d&#39;$E$)}\\\\ &amp; = E(X^2)-2\\mu_X^2+\\mu_X^2=E(X^2)-\\mu_X^2 \\end{array} \\] La desviació típica (o desviació estàndard) d’una variable aleatòria discreta \\(X\\) és l’arrel quadrada positiva de la seva variància: \\[ \\sigma(X)=+\\sqrt{\\sigma(X)^2} \\] Com la variància, mesura la dispersió dels valors de \\(X\\) respecte de la mitjana. També la indicarem amb \\(\\sigma_X\\). En el context de les variables aleatòries, no hi ha “variància” i “variància mostral”, només “variància”. El mateix nom us hauria de donar la pista que la “variància mostral” està definida només per a mostres. El motiu per introduir la variància i la desviació típica per mesurar la dispersió dels valors de \\(X\\) és la mateixa que en estadística descriptiva: la variància és més fàcil de manejar (no involucra arrels quadrades) però les seves unitats són les de \\(X\\) al quadrat, mentre que les unitats de la desviació típica són les de \\(X\\), i per tant el seu valor és més fàcil d’interpretar. Exemple 1.5 Seguim amb la variable aleatòria \\(X\\) “Llançam una moneda equilibrada 3 vegades i comptam les cares”. Recordem que \\(\\mu_X=E(X)=1.5\\). Aleshores, la seva variància és: \\[ \\begin{array}{rl} \\sigma(X)^2 \\!\\!\\!\\!\\! &amp; \\displaystyle=(0-1.5)^2\\cdot \\frac{1}{8}+(1-1.5)^2\\cdot \\frac{3}{8}\\\\ &amp;\\displaystyle\\qquad +(2-1.5)^2\\cdot \\frac{3}{8}+(3-1.5)^2\\cdot \\frac{1}{8}=0.75 \\end{array} \\] Si recordam que \\(E(X^2)=3\\), podem veure que \\[ E(X^2)-\\mu_X^2=3-1.5^2=0.75=\\sigma(X)^2 \\] La seva desviació típica és \\[ \\sigma(X) =\\sqrt{\\sigma(X)^2}=\\sqrt{0.75}= 0.866 \\] Vegem algunes propietats de la variància i la desviació típica: Si \\(b\\) és una variable aleatòria constant que sobre tots els individus de la població pren el valor \\(b\\in \\mathbb{R}\\), aleshores \\(\\sigma(b)^2=\\sigma(b)=0\\). Una variable aleatòria constant té zero dispersió. \\(\\sigma(aX+b)^2=a^2\\cdot \\sigma(X)^2\\). En efecte \\[ \\begin{array}{l} \\sigma(aX+b)^2 =E((aX+b)^2)-E(aX+b)^2\\\\ \\quad = E(a^2X^2+2abX+b^2)-(aE(X)+b)^2\\\\ \\quad \\text{(per la linealitat de $E$)}\\\\ \\quad = a^2E(X^2)+2abE(X)+b^2-a^2E(X)^2-2abE(X)-b^2\\\\ \\quad \\text{(una altre cop, per la linealitat de $E$)}\\\\ \\quad = a^2(E(X^2)-E(X)^2)=a^2\\sigma(X)^2 \\end{array} \\] \\(\\sigma(aX+b)=|a|\\cdot \\sigma(X)\\) (recordau que la desviació típica és positiva, i \\(+\\sqrt{a^2}=|a|\\)). Si \\(X,Y\\) són variables aleatòries independents, \\[ \\sigma(X+Y)^2=\\sigma(X)^2+\\sigma(Y)^2 \\] i per tant \\[ \\sigma(X+Y)=\\sqrt{\\sigma(X)^2+\\sigma(Y)^2} \\] Si no són independents, en general aquesta igualtat és falsa. Per posar un exemple extrem, \\[ \\sigma(X+X)^2=4\\sigma(X)^2 \\neq \\sigma(X)^2+\\sigma(X)^2. \\] Més en general, si \\(X_1,\\ldots,X_n\\) són variables aleatòries independents (i, en principi, només en aquest cas) i \\(a_1,\\ldots,a_n,b\\in \\mathbb{R}\\), \\[ \\begin{array}{l} \\sigma(a_1X_1+\\cdots+a_nX_n+b)^2=a_1\\cdot\\sigma(X_1)^2+\\cdots+a_n\\cdot\\sigma(X_n)^2\\\\ \\sigma(a_1X_1+\\cdots+a_nX_n+b)=\\sqrt{a_1\\cdot\\sigma(X_1)^2+\\cdots+a_n\\cdot\\sigma(X_n)^2} \\end{array} \\] 1.2.4 Quantils Sigui \\(p\\in [0,1]\\). El quantil d’ordre \\(p\\) (o \\(p\\)-quantil) d’una variable aleatòria discreta \\(X\\) és el valor \\(x_p\\in D_X\\) tal que \\(P(X\\leq x_p)\\geq p\\) però \\(P(X&lt; x_p)&lt;p\\). És a dir, el valor \\(x_p\\in D_X\\) més petit tal que \\(P(X\\leq x_p)\\geq p\\). Per exemple, que el 0.25-quantil d’una variable aleatòria discreta \\(X\\) sigui, jo què sé, 8, significa que almenys un 25% de la població té un valor de \\(X\\) més petit o igual que 8, però menys d’un 25% de la població té un valor de \\(X\\) estrictament més petit que 8. És a dir, 8 és el valor més petit per al qual la probabilitat acumulada arriba al 25%. Si existeix algun \\(x_p\\in D_X\\) tal que \\(P(X\\leq x_p)=p\\), llavors el \\(p\\)-quantil és aquest \\(x_p\\), perquè, per a tot un altre \\(x\\in D_x\\): Si \\(x&lt;x_p\\), \\(P(X\\leq x)&lt;P(X\\leq x_p)=F_X(x_p)=p\\) i per tant \\(x\\) no pot ser el \\(p\\)-quantil de \\(X\\). Si \\(x&gt;x_p\\), \\(p=P(X\\leq x_p)\\leq P(X&lt;x)\\), i per tant \\(x\\) tampoc no pot ser el \\(p\\)-quantil de \\(X\\). Com en estadística descriptiva, alguns quantils de variables aleatòries tenen noms propis. Per exemple: La mediana de \\(X\\) és el seu 0.5-quantil. El primer i el tercer quartils de \\(X\\) són els seus \\(0.25\\)-quantil i \\(0.75\\)-quantil, respectivament. Etc. Exemple 1.6 Seguim amb la variable aleatòria \\(X\\) “Llançam una moneda equilibrada 3 vegades i comptam les cares”. Recordem que la seva funció de distribució és \\[ F_X(x)=\\left\\{ \\begin{array}{ll} 0 &amp; \\text{ si $x&lt;0$}\\\\ 0.125 &amp; \\text{ si $0\\leq x&lt;1$}\\\\ 0.5 &amp; \\text{ si $1\\leq x&lt;2$}\\\\ 0.875 &amp; \\text{ si $2\\leq x&lt;3$}\\\\ 1 &amp; \\text{ si $3\\leq x $} \\end{array} \\right. \\] Llavors, per exemple: El seu 0.125-quantil és 0 El seu 0.25-quantil és 1 La seva mediana és 1 El seu 0.75-quantil és 2 1.3 Famílies importants de variables aleatòries discretes En aquesta secció descriurem tres famílies de variables aleatòries “distingides” que heu de conèixer: Binomial Hipergeomètrica Poisson Cadascuna d’aquestes famílies tenen un tipus específic de funció de densitat que depèn d’un o diversos paràmetres. D’aquestes famílies de variables heu de saber: Distingir-les: saber quan una variable aleatòria és d’una família d’aquestes. La seva densitat, el seu valor esperat i la seva variància. Emprar R per calcular coses amb elles quan sigui necessari. 1.3.1 Variables aleatòries binomials Un experiment de Bernoulli és una acció amb només dos resultats possibles, que identificam amb “Èxit” (\\(E\\)) i “Fracàs” (\\(F\\)), i de la qual, en principi, no podem predir el seu resultat per mor de la influència de l’atzar. Per exemple, llançar un dau cúbic i mirar si ha sortit un 6 (\\(E\\): treure un 6; \\(F\\): qualsevol altre resultat). La probabilitat d’èxit \\(p\\) d’un experiment de Bernoulli és la probabilitat d’obtenir un èxit \\(E\\). És a dir, \\(P(E)=p\\). Naturalment, llavors, \\(P(F)=1-p\\). Per exemple, són experiments de Bernoulli Llançar una moneda equilibrada i mirar si dóna cara. \\(E\\): donar cara \\(p=1/2\\) Realitzar un test PCR de COVID-19 a una persona i mirar si dóna positiu \\(E\\): donar positiu \\(p\\): la proporció de persones de la població de la qual hem extret el nostre subjecte que donen positiu en el test Que no heu de confondre amb la proporció de persones de la població de la qual hem extret el nostre subjecte que tenen la COVID-19. Una variable aleatòria de Bernoulli de paràmetre \\(p\\) (abreujadament, \\(Be(p)\\)) és una variable aleatòria \\(X\\) que consisteix a efectuar un experiment de Bernoulli i donar 1 si s’obté un èxit i 0 si s’obté un fracàs. Una variable aleatòria binomial de paràmetres \\(n\\) i \\(p\\) (abreujadament, \\(B(n,p)\\)) és una variable aleatòria \\(X\\) que compta el nombre d’èxits \\(E\\) en una seqüència de \\(n\\) repeticions independents d’un mateix experiment de Bernoulli de probabilitat d’èxit \\(p\\). Independents significa que les \\(n\\) variables aleatòries de Bernoulli, una per a cada repetició de l’experiment de Bernoulli, són independents; és a dir, que el resultat de cada experiment en la seqüència no depèn dels resultats dels altres. Direm a \\(n\\) la mida de les mostres i a \\(p\\) la probabilitat (poblacional) d’èxit. De vegades també direm d’una variable \\(X\\) de tipus \\(B(n,p)\\) que té distribució binomial de paràmetres \\(n\\) i \\(p\\). Per exemple: Una variable de Bernoulli \\(Be(p)\\) és una variable binomial \\(B(1,p)\\). Llançar una moneda equilibrada 10 vegades i comptar les cares és una variable binomial \\(B(10,0.5)\\) Triar 20 estudiants de la UIB a l’atzar, l’un rere l’altre, permetent repeticions i cada tria independent de les altres, i mirar si al primer semestre han aprovat totes les assignatures o no, és una variable binomial \\(B(20,p)\\) amb \\(p\\) la proporció d’estudiants de la UIB que han aprovat totes les assignatures del primer semestre. El tipus més comú de variables binomials que ens interessaran és aquest darrer: Tenim un subconjunt \\(A\\) d’una població \\(\\Omega\\) (per exemple, els estudiants de la UIB que han aprovat totes les assignatures del primer semestre). Sigui \\(p\\) la proporció poblacional d’individus de la població que pertanyen a \\(A\\), és a dir \\(p=P(A)\\). Prenem mostres aleatòries simples de mida \\(n\\) de la població i comptam quants subjectes de la mostra són de \\(A\\). Aquesta variable aleatòria és binomial \\(B(n,p)\\). Tenim el resultat següent. Teorema 1.2 Si \\(X\\) és una variable \\(B(n,p)\\): El seu domini és \\(D_X=\\{0,1,\\ldots,n\\}\\) La seva funció de densitat és \\[ f_X(k)=\\left\\{\\begin{array}{ll} \\displaystyle\\binom{n}{k}p^k(1-p)^{n-k} &amp; \\text{ si $k\\in D_X$}\\\\ 0 &amp; \\text{ si $k \\notin D_X$} \\end{array} \\right. \\] El seu valor esperat és \\(E(X)=np\\) La seva variància és \\(\\sigma(X)^2=np(1-p)\\) Recordau que: El factorial \\(m!\\) d’un nombre natural \\(m\\) és \\(m!=m(m-1)\\cdots 2\\cdot 1\\) si \\(m\\geq 1\\). Si \\(m=0\\), es pren \\(0!=1\\). El nombre combinatori \\(\\binom{n}{k}\\) és \\[ \\binom{n}{k}=\\frac{\\overbrace{n\\cdot (n-1)\\cdots (n-k+1)}^k}{k\\cdot (k-1)\\cdots 2\\cdot 1}=\\frac{n!}{k!(n-k)!} \\] i ens dóna el nombre de subconjunts de \\(k\\) elements de \\(\\{1,\\ldots,n\\}\\). Suposem que efectuam \\(n\\) repeticions consecutives i independents d’un experiment de Bernoulli de probabilitat d’èxit \\(p\\) i comptam el nombre d’èxits \\(E\\); direm \\(X\\) a la variable aleatòria resultant. Per seguir la demostració, si no us sentiu molt còmodes amb el raonament amb enes i kas abstractes, anau repetint-lo prenent, per exemple, \\(n=4\\). Els possibles resultats són totes les paraules possibles de \\(n\\) lletres formades per \\(E\\)’s i \\(F\\)’s. Com que els experiments successius són independents, la probabilitat de cadascuna d’aquestes paraules és el producte de les probabilitats dels seus resultats individuals. Per tant, si una paraula concreta té \\(k\\) lletres \\(E\\) i \\(n-k\\) lletres \\(F\\) (s’han obtingut \\(k\\) èxits i \\(n-k\\) fracassos), la seva probabilitat és \\(p^k(1-p)^{n-k}\\), independentment de l’ordre en el qual hàgim obtingut els resultats. Per calcular la probabilitat d’obtenir una seqüència amb \\(k\\) èxits, sumarem les probabilitats d’obtenir cadascuna de les seqüències de \\(n\\) lletres amb \\(k\\) \\(E\\)’s. Com que totes tenen la mateixa probabilitat, el resultat serà la probabilitat d’una paraula amb \\(k\\) \\(E\\)’s i \\(n-k\\) \\(F\\)’s multiplicada pel nombre total de paraules diferents amb \\(k\\) \\(E\\)’s i \\(n-k\\) \\(F\\)’s. Quantes paraules hi ha amb \\(k\\) \\(E\\)’s i \\(n-k\\) \\(F\\)’s? Cada una d’elles queda caracteritzada per les posicions de les \\(k\\) \\(E\\)’s, per tant és el nombre de possibles eleccions de conjunts de \\(k\\) posicions per a les \\(E\\)’s. Això darrer és el nombre de possibles subconjunts de \\(k\\) elements (les posicions on hi haurà les \\(E\\)’s) de \\(\\{1,\\ldots,n\\}\\), que és el nombre combinatori \\(\\binom{n}{k}\\). Per tant ja tenim \\[ P(X=k)=\\binom{n}{k}p^k(1-p)^{n-k}. \\] A partir d’aquí, el càlcul del valor esperat i la variància és sumar \\[ \\begin{array}{l} \\displaystyle E(X)=\\sum_{k=0}^n k\\cdot \\binom{n}{k}p^k(1-p)^{n-k}\\\\ \\displaystyle \\sigma(X)^2=\\sum_{k=0}^n k^2\\cdot \\binom{n}{k}p^k(1-p)^{n-k}-\\Big(\\sum_{k=0}^n k\\cdot \\binom{n}{k}p^k(1-p)^{n-k})^2 \\end{array} \\] Us podeu fiar de nosaltres, donen \\(np\\) i \\(np(1-p)\\), respectivament. Si ho pensau, veureu que el valor de \\(E(X)\\) és l’“esperat”. Vegem, si preneu una mostra aleatòria de \\(n\\) subjectes d’una població en la qual la proporció de subjectes \\(E\\) és \\(p\\), quants subjectes \\(E\\) “esperau” obtenir en la vostra mostra? Doncs una proporció \\(p\\) de la mostra, és a dir \\(p\\cdot n\\), no? La funció de distribució d’una variable binomial no té una fórmula explícita. Només podem dir que si \\(X\\) és \\(B(n,p)\\), \\[ F_X(x)=\\sum_{k=0}^{\\min\\{n,x\\}} \\binom{n}{k}p^k(1-p)^{n-k} \\] És un doi, però, per si de cas, us volem fer observar que si \\(X\\) és \\(B(n,p)\\), \\(P(X=k)\\) no només depèn de \\(k\\) sinó també dels paràmetres \\(n\\) i \\(p\\). Això serà general. Totes les variables aleatòries d’una mateixa família tenen la mateixa funció de densitat, llevat dels valors dels paràmetres, que poden variar d’una variable a una altra. El tipus de teorema anterior és el que fa que ens interessi conèixer algunes famílies distingides freqüents de variables aleatòries. Si, per exemple, reconeixem que una variable aleatòria és binomial i coneixem els seus valors de \\(n\\) i \\(p\\) i sabem el teorema anterior, automàticament sabem la seva funció de densitat, i amb ella la seva funció de distribució, el seu valor esperat, la seva variància etc., sense necessitat de deduir tota aquesta informació cada vegada que trobem una variable d’aquestes. Naturalment, conèixer les propietats de les variables aleatòries binomials només és útil si sabem reconèixer quan estam davant d’una. Fixau-vos que en una variable aleatòria binomial: Comptam quantes vegades ocorre un esdeveniment (l’èxit \\(E\\)) en una seqüència d’intents. En cada intent, l’esdeveniment que ens interessa passa o no passa, sense grisos. El nombre d’intents és fix, \\(n\\). Cada intent és independent dels altres. En cada intent, la probabilitat que passi l’esdeveniment que ens interessa és sempre la mateixa, \\(p\\). Així, per exemple: Una dona té 4 fills. La probabilitat que un fill sigui nina és fixa, 0.51. El sexe de cada fill és independent dels altres. Comptam quantes filles té. És una variable binomial \\(B(4,0.51)\\). En una aula hi ha 5 homes i 45 dones. Triam 10 estudiants, un darrere l’altre i sense repetir-los, per fer-los una pregunta. Cada elecció és independent de les altres. Comptam quants homes hem interrogat. No és una variable binomial: com que no podem repetir estudiants, en cada ronda la probabilitat de triar un home depèn del sexe dels estudiants triats abans que ell. Per tant la \\(p\\) no és la mateixa en cada elecció. Per exemple, en la primera ronda la probabilitat de triar un home és 5/50=0.1. Ara, si en la primera ronda surt triat un home, la probabilitat que en la segona ronda tornem a triar un home es redueix a 4/49=0.0816, mentre que si en la primera elecció surt una dona, la probabilitat de triar un home en la segona ronda puja a 5/49=0.102. En una aula hi ha 5 homes i 45 dones. Triam 10 estudiants, un darrere l’altre però cada estudiant pot ser triat més d’una vegada, per a fer-los una pregunta. Cada elecció és independent de les altres. Comptam quants homes hem interrogat. Ara sí que és una variable binomial \\(B(10,0.9)\\). En una aula hi ha 5 homes i 45 dones. Triam estudiants un darrere l’altre i cada estudiant pot ser triat més d’una vegada, per fer-los una pregunta. Cada elecció és independent de les altres. Comptam quants estudiants hem hagut de triar per arribar a interrogar 5 homes. No és una variable binomial: no compta el nombre d’èxits en una seqüència d’un nombre fix d’intents, sinó quants intents hem necessitat per arribar a un nombre fix d’èxits. En una aula hi ha 5 homes i 45 dones. Llançam una moneda equilibrada: si surt cara triam 10 estudiants i si surt creu en triam 20, per a fer-los una pregunta. Tant en un cas com en l’altre, els triarem un darrere l’altre, cada estudiant podrà ser triat més d’una vegada i cada elecció serà independent de les altres. Comptam quants homes hem interrogat. No és una variable binomial: el nombre d’intents no és fix. La probabilitat que un dia de novembre plogui és d’un 32%. Triam una setmana de novembre i comptam quants dies ha plogut. No és d’una variable binomial. Encara que a priori cada dia tengui la mateixa probabilitat de pluja, que plogui un dia no és independent que plogui l’anterior. Per què fos binomial, hauríem d’haver triat 7 dies de novembre a l’atzar, permetent que sortissin repetits. A Espanya hi ha 46,700,000 persones, de les quals un 11.7% són diabètics. Triam 100 espanyols diferents a l’atzar (de manera independent els uns dels altres) i comptam quants són diabètics. No és binomial, però pràcticament sí que ho és, perquè les probabilitats gairebé no varien d’una elecció a la següent. En aquest cas farem la trampa de considerar-la binomial. Exemple 1.7 Tenim una població de 46,700,000 persones i en volem extreure una mostra aleatòria de 100. Llavors, per exemple, quan ja portau 99 individus escollits, la probabilitat de triar un individu concret dels que queden és 1/(46700000-99) ## [1] 2.14133e-08 mentre que si permetem repeticions, aquesta probabilitat és 1/46700000 ## [1] 2.14133e-08 Vegem alguns gràfics de la funció densitat de variables aleatòries binomials. Primer, per a \\(n=10\\) i diferents valors de \\(p\\). Ara per a \\(n=100\\): Podreu observar que si \\(p=0.5\\), la funció densitat és simètrica respecte de \\(n/2\\): com que \\(E\\) i \\(F\\) tenen la mateixa probabilitat, 0.5, la probabilitat de treure \\(k\\) \\(E\\)’s és la mateixa que la de treure \\(k\\) \\(F\\)’s, és a dir, la de treure \\(n-k\\) \\(E\\)’s. Per a agilitar els tests de COVID-19, s’ha proposat l’estratègia següent (anomenada pooled sample testing o simplement pooling). Unim grups de 10 mostres en una sola mostra i l’analitzam. Si dóna negatiu, serà senyal que totes la mostres originals eren negatives. Declararem llavors negatius els 10 subjectes de les mostres originals. Si dóna positiu, serà perquè almenys una de les mostres originals era positiva. En aquest cas, analitzarem les 10 mostres per separat. Observau llavors que si les 10 mostres eren negatives, fem un sol test, mentre que si alguna mostra és positiva, en fem 11. Amb l’enfocament tradicional, un test per mostra, sense complicacions, faríem sempre 10 tests. Suposem que el test té una especificitat i una sensibilitat del 100%. Sigui \\(p\\) la prevalença de la COVID-19 en un moment i població donats. Donades 10 mostres preses en aquest moment en aquesta població, quin és el valor esperat de tests que hem de realitzar? Per a \\(p\\) petita, de l’ordre de l’1% al 5%, significaria el pooling un estalvi “esperat” considerable de tests? Com efectuar càlculs amb una variable aleatòria d’una família donada? Una possibilitat és usar una aplicació de mòbil o tauleta. La nostra preferida és Probability distributions, disponible tant per a Android com per a iOS. Figura 1.3: L’apli Probability Distributions. Una altra possibilitat és usar R. R coneix totes la distribucions de variables aleatòries importants; per exemple, per a R la binomial és binom. Aleshores Afegint al nom de la distribució el prefix d, tenim la seva funció de densitat: de la binomial serà dbinom. Afegint al nom de la distribució el prefix p, tenim la seva funció de distribució: de la binomial, pbinom. Afegint al nom de la distribució el prefix q, tenim els seus quantils: per a la binomial, qbinom. Afegint al nom de la distribució el prefix r, tenim una funció que produeix mostres aleatòries de nombres amb aquesta distribució de probabilitat: per a la binomial, rbinom. Aquestes funcions s’apliquen a l’argument de la funció i els paràmetres de la variable aleatòria en la seva ordre usual. Per exemple, per a la binomial, s’apliquen a (argument, \\(n\\), \\(p\\)). Per a més detalls sobre tot això, consultau la lliçó de R sobre el tema. Vegem alguns exemples. Si llançam 20 vegades un dau cúbic equilibrat, quina és la probabilitat de treure exactament 5 uns? Si diem \\(X\\) a la variable aleatòria que compta el nombre d’uns en seqüències de 20 llançaments d’un dau equilibrat, es tracta d’una variable binomial \\(B(20,1/6)\\). Ens demanen \\(P(X=5)\\), i aquesta probabilitat ens la dóna la funció de densitat de \\(X\\). És \\(f_X(5)\\): dbinom(5,20,1/6) ## [1] 0.12941 Si llançam 20 vegades un dau cúbic equilibrat, quina és la probabilitat de treure com a màxim 5 uns? Amb les notacions anteriors, ens demanen \\(P(X\\leq 5)\\), i aquesta probabilitat ens la dóna la funció de distribució de \\(X\\). És \\(F_X(5)\\): pbinom(5,20,1/6) ## [1] 0.89816 Si llançam 20 vegades un dau cúbic equilibrat, quina és la probabilitat de treure menys de 5 uns? Amb les notacions anteriors, ens demanen \\(P(X&lt; 5)\\), és a dir, \\(P(X\\leq 4)=F_X(4)\\): pbinom(4,20,1/6) ## [1] 0.768749 Si llançam 20 vegades un dau cúbic equilibrat, quina és la probabilitat de treure 5 uns o més? Amb les notacions anteriors, ens demanen \\(P(X\\geq 5)\\). Com que el contrari de treure 5 uns o més és treure 4 uns o menys, tenim que \\(P(X\\geq 5)=1-P(X\\leq 4)=1-F_X(4)\\): 1-pbinom(4,20,1/6) ## [1] 0.231251 Si llançam 20 vegades un dau equilibrat, quin és el més petit nombre \\(N\\) d’uns per al qual la probabilitat de treure com a màxim \\(N\\) uns arriba al 25%? Ens demanen el més petit valor \\(N\\) tal que \\(P(X\\leq N)\\geq 0.25\\), i això per definició és el 0.25-quantil de \\(X\\): qbinom(0.25,20,1/6) ## [1] 2 Vegem que en efecte \\(N=2\\) compleix el demanat: la probabilitat de treure com a màxim 2 uns és pbinom(2,20,1/6) ## [1] 0.328659 i la probabilitat de treure com a màxim 1 un és pbinom(1,20,1/6) ## [1] 0.13042 Veiem per tant que amb 1 un no arribam al 25% de probabilitat i amb 2 sí. Volem simular 50 rondes de llançar 20 vegades un dau equilibrat i comptar els uns, és a dir, volem una mostra aleatòria de mida 50 de la nostra variable \\(X\\): rbinom(50,20,1/6) ## [1] 2 6 1 4 3 4 2 4 6 3 3 3 2 3 4 4 4 1 4 3 2 5 4 4 2 2 4 0 1 3 0 2 5 7 2 6 3 0 ## [39] 5 0 2 3 2 3 2 3 3 4 2 3 Cada vegada que repetim aquesta instrucció segurament obtendrem una mostra aleatòria nova: rbinom(50,20,1/6) ## [1] 2 1 2 4 2 7 2 3 2 2 5 3 2 6 4 3 2 4 5 2 3 5 3 3 8 0 3 4 3 3 5 1 2 0 2 3 1 2 ## [39] 3 2 5 3 1 3 0 4 4 5 6 3 rbinom(50,20,1/6) ## [1] 5 3 5 3 2 5 0 3 2 9 4 2 1 4 5 1 5 5 3 4 4 3 3 4 2 6 3 4 3 6 3 2 4 2 2 5 4 3 ## [39] 3 5 1 3 4 4 3 2 2 3 5 5 rbinom(50,20,1/6) ## [1] 4 5 2 2 3 3 3 4 7 2 1 2 4 6 2 4 6 1 2 3 4 4 2 1 9 1 3 3 4 3 3 3 2 3 1 6 2 5 ## [39] 0 2 1 3 4 3 1 4 3 2 3 3 1.3.2 Variables aleatòries hipergeomètriques Recordau que el paradigma de variable aleatòria binomial és: tenc una població amb una proporció \\(p\\) de subjectes que satisfan una condició \\(E\\), prenc una mostra aleatòria simple de mida \\(n\\) i compt el nombre de subjectes \\(E\\) en la meva mostra. Si canviam “mostra aleatòria simple” per “mostra aleatòria sense reposició”, la distribució de la variable aleatòria que obtenim és una altra: és hipergeomètrica. Una variable aleatòria és hipergeomètrica (o té distribució hipergeomètrica) de paràmetres \\(N\\), \\(M\\) i \\(n\\) (abreujadament, \\(H(N,M,n)\\)) quan es pot identificar amb el procés següent: Tenim una població formada per \\(N\\) subjectes que satisfan una condició \\(E\\) i \\(M\\) subjectes que no la satisfan (per tant, en total, \\(N+M\\) subjectes en la població), prenem una mostra aleatòria sense reposició de mida \\(n\\) i comptam el nombre de subjectes \\(E\\) en aquesta mostra. Direm a \\(N\\) el nombre poblacional d’èxits, a \\(M\\) el nombre poblacional de fracassos i a \\(n\\) la mida de les mostres. Fixau-vos llavors que \\(N+M\\) és la mida total de la població i que \\(N/(N+M)\\) és la probabilitat poblacional d’èxit (la fracció de subjectes que satisfan \\(E\\) en el total de la població). Amb R, igual que la distribució binomial era binom, la distribució hipergeomètrica és hyper. Tenim el resultat següent: Teorema 1.3 Si \\(X\\) és una variable \\(H(N,M,n)\\): El seu domini és \\(D_X=\\{0,1,\\ldots,\\text{min}(N,n)\\}\\) La seva funció de densitat és \\[ f_X(k)=\\left\\{\\begin{array}{ll} \\displaystyle\\dfrac{\\binom{N}{k}\\cdot \\binom{M}{n-k}}{\\binom{N+M}{n}} &amp; \\text{ si $k\\in D_X$}\\\\ 0 &amp; \\text{ si $k\\notin D_X$} \\end{array} \\right. \\] El seu valor esperat és \\(E(X)=\\dfrac{nN}{N+M}\\) La seva variància és \\(\\sigma(X)^2=\\dfrac{nNM(N+M-n)}{(N+M)^2(N+M-1)}\\) Fixau-vos que si diem \\(p\\) a la probabilitat poblacional d’èxit, \\(p=N/(N+M)\\), llavors \\[ E(X)=np. \\] És la mateixa fórmula que per a les variables binomials \\(B(n,p)\\) (i si ho pensau una estona veureu que, un altre cop i pel mateix argument, és el que toca). D’altra banda, si diem \\(\\mathbf{P}\\) a la mida total de la població, \\(\\mathbf{P}=N+M\\), llavors \\[ \\sigma(X)^2=n\\cdot\\dfrac{N}{N+M}\\cdot\\dfrac{M}{N+M}\\cdot\\frac{N+M-n}{N+M-1}=np(1-p)\\cdot\\dfrac{\\mathbf{P}-n}{\\mathbf{P}-1} \\] que és la variància d’una variable \\(B(n,p)\\) multiplicada per un factor de correcció a causa del fet que ara prenem mostres sense repetició i la variància és més petita que si les prenem amb repetició. A aquest factor \\((\\mathbf{P}-n)/(\\mathbf{P}-1)\\) se’n diu factor de població finita. Fixau-vos que si \\(\\mathbf{P}\\) és moltíssim més gran que \\(n\\), tendrem que \\(\\mathbf{P}-n\\approx \\mathbf{P}-1\\) i per tant \\((\\mathbf{P}-n)/(\\mathbf{P}-1)\\approx 1\\) i la variància de la hipergeomètrica serà aproximadament la de la binomial. Això és consistent amb el que ja hem comentat: si la població és molt més gran que la mostra, prendre les mostres amb o sense reposició no afecta massa a les mostres obtingudes, per la qual cosa la distribució de probabilitat ha de ser molt semblant. Recordau els exemples següents: A Espanya hi ha 46,700,000 persones, de les quals un 11.7% són diabètics. Triam 100 espanyols i comptam quants són diabètics. Aquesta variable és, en realitat, hipergeomètrica amb \\(N=0.117\\cdot 46700000=5463900\\), \\(M=46700000-N=41236100\\) i \\(n=100\\), però en la pràctica la consideram binomial \\(B(100,0.117)\\). El factor de població finita és \\[ \\frac{46700000-100}{46700000-1}=0.9999979 \\] Pràcticament 1. En canvi: En una aula hi ha 5 homes i 45 dones. Triam 10 estudiants, un darrere l’altre i sense repetir-los, per fer-los una pregunta. Cada elecció és independent de les altres. Comptam quants homes hem interrogat. Aquesta variable és hipergeomètrica \\(H(5,45,10)\\). El factor de població finita en aquesta cas no és aproximadament 1: dóna \\[ \\frac{50-10}{50-1}=0.8163 \\] No és correcte aproximar-la per una binomial \\(B(10,0.1)\\). El gràfic següent compara la funció de densitat d’una variable \\(B(10,0.1)\\) amb les de variables hipergeomètriques \\(H(5,45,10)\\), \\(H(50,450,10)\\) i \\(H(5000,45000,10)\\) perquè vegeu com a mesura que la mida de la població creix (mantenint constant la proporció poblacional d’èxits), la distribució hipergeomètrica s’aproxima a la binomial. 1.3.3 Variables aleatòries de Poisson Una variable aleatòria \\(X\\) és de Poisson (o té distribució de Poisson) de paràmetre \\(\\lambda&gt;0\\) (abreujadament, \\(Po(\\lambda)\\)) quan: El seu domini és \\(D_X=\\mathbb{N}\\), el conjunt de tots els nombres naturals (és a dir, pot prendre com a valor qualsevol nombre natural). La seva funció de densitat és \\[ f_X(k)=\\left\\{\\begin{array}{ll} e^{-\\lambda}\\cdot \\dfrac{\\lambda^k}{k!} &amp; \\text{ si $k\\in \\mathbb{N}$}\\\\ 0 &amp; \\text{ si $k \\notin \\mathbb{N}$} \\end{array} \\right. \\] Per a R, la distribució de Poisson és pois. Teorema 1.4 Si \\(X\\) és una variable \\(Po(\\lambda)\\), aleshores \\(E(X)= \\sigma(X)^2= \\lambda\\). És a dir, el paràmetre \\(\\lambda\\) d’una variable de Poisson és el seu valor esperat, i coincideix amb la seva variància. Us deveu estar demanant: per a què ens serveix definir una variable de Poisson mitjançant la seva densitat, si el que ens interessa és poder classificar una variable com a Poisson (o binomial, o hipergeomètrica etc.) per a així saber “gratis” la seva densitat? La resposta és que la família de Poisson inclou un tipus de variables aleatòries molt freqüent Suposem que tenim un tipus d’objectes que poden donar-se en una regió contínua de temps o espai. Per exemple, defuncions de persones per una determinada malaltia en el decurs del temps, exemplars d’una espècie de planta en un terreny, o nombres de bacteris en bocins d’una superfície. Suposem a més que les aparicions d’aquests objectes satisfan les propietats següents (per simplificar el llenguatge, hi suposarem que observam aparicions d’aquests objectes en el temps; si es tracta d’una variable que compta objectes en regions de l’espai, canviau-hi “instant” per “punt”): Les aparicions dels objectes són aleatòries: en cada instant, un objecte es dóna, o no, a l’atzar, amb una probabilitat fixa i constant. Les aparicions dels objectes són independents: que es doni un objecte en un instant concret, no depèn per a res que s’hagi donat o no un objecte en un altre instant. Les aparicions dels objectes no són simultànies: és pràcticament impossible que dos objectes d’aquests es donin en el mateix instant exacte, mesurat amb precisió infinita. En aquesta situació, la variable \\(X_t\\) que pren un interval de temps de durada \\(t\\) i compta el nombre d’objectes que es donen en ell és de Poisson \\(Po(\\lambda_t)\\), amb \\(\\lambda_t\\) el nombre esperat d’objectes en aquest interval de temps (és a dir, el nombre mitjà d’objectes en intervals de temps d’aquesta mida). Per exemple, quan el que compten ocorre a l’atzar, són variables de Poisson: El nombre de malalts admesos en urgències en un dia (o en 12 hores, o en una setmana…) El nombre de defuncions per una malaltia concreta en un dia (o en una setmana, o en un any…) El nombre de bacteris en un quadrat d’1 cm de costat (o d’1 m de costat…) Fixau-vos que aquest tipus de coneixement ens serveix per a dues coses: Si sabem que aquestes variables són de Poisson, coneixem la seva densitat i per tant podem calcular el que volguem per a elles. Si les dades que observam tocarien seguir una distribució de Poisson però sembla que no (per exemple, perquè la seva variància sigui molt diferent de la seva mitjana, tan diferent que sigui difícil de creure que la mitjana i la variància poblacionals siguin iguals), llavors és senyal que qualque cosa “estranya” està passant que desbarata la seva aparició. Exemple 1.8 Observau la diferència entre les dues variables següents: Nombres mensuals de defuncions per un tipus de càncer en un país. El moment exacte de les defuncions es produeix a l’atzar, segurament mai no es donen dues defuncions exactament en el mateix instant, si els poguéssim mesurar amb precisió infinita, i les defuncions es produeixen de manera independent. És de Poisson. Nombres mensuals de defuncions per una malatia infecciosa en un país. Un altre cop, el moment exacte de les defuncions es produeix a l’atzar i segurament mai no es donen dues defuncions exactament en el mateix instant, si els poguéssim mesurar amb precisió infinita. Però les infeccions no són independents, precisament perquè es tracta d’una malaltia infecciosa, i per tant les defuncions tampoc: com ens hem cansat d’observar amb la COVID-19, en un mateix cluster de la malaltia es poden produir diverses morts associades. No és de Poisson. Com que les aparicions dels objectes que compta una variable de Poisson són aleatòries i independents, el nombre mitjà d’objectes és lineal en la mida de la regió. És a dir, per exemple, en un interval de dos dies esperam veure el doble d’objectes que en un dia. O per exemple, si es diagnostiquen de mitjana 32,240 casos de càncer de còlon anuals a Espanya (i segueixen una llei de Poisson), esperam que de mitjana es diagnostiquin 32240/52=620 casos setmanals. 1.4 Variables aleatòries contínues Una variable aleatòria és contínua quan els seus possibles valors són dades quantitatives contínues. Per exemple: Pes Nivell de colesterol en sang Diàmetre d’un tumor En aquest curs ens restringirem a variables aleatòries contínues \\(X: \\Omega\\to \\mathbb{R}\\) que satisfan la propietat extra següent: la seva funció de distribució \\[ \\begin{array}{rcl} F_X: \\mathbb{R} &amp; \\to &amp; [0,1]\\\\ x &amp;\\mapsto &amp;P(X\\leq x) \\end{array} \\] és contínua. Totes les variables aleatòries contínues que us puguin interessar en algun moment satisfan aquesta propietat, així que no perdem res imposant-la. Si \\(X\\) és una variable aleatòria contínua amb funció de distribució contínua, la probabilitat que prengui cada valor concret és 0: \\[ P(X=a)=0 \\text{ per a tot $a \\in \\mathbb{R}$}. \\] Per si passa per aquí qualcú que en necessiti una demostració: \\[ \\begin{array}{l} \\displaystyle P(X=a) = P(X\\leq a)-P(X&lt;a)=P(X\\leq a)-P\\Big(\\bigcup_{n\\geq 1} \\Big(X\\leq a-\\frac{1}{n}\\Big)\\Big)\\\\ \\displaystyle \\qquad= P(X\\leq a)-\\lim_{n\\geq 1}P\\Big(X\\leq a-\\frac{1}{n}\\Big)\\\\ \\displaystyle \\qquad= F_X(a)-\\lim_{n\\geq 1}F_X\\Big(a-\\frac{1}{n}\\Big)=0 \\end{array} \\] perquè \\(F_X\\) és contínua. En particular, per a una variable aleatòria contínua: Probabilitat 0 no significa impossible. Cada valor de \\(X\\) té probabilitat 0, però si prenem un subjecte de la població, \\(X\\) tendrà qualque valor sobre ell, no? Per tant, aquest valor de \\(X\\) és possible, malgrat tengui probabilitat 0. De \\(P(X=a)=0\\) es dedueix que la probabilitat d’un esdeveniment definit amb una desigualtat és exactament la mateixa que la de l’esdeveniment corresponent definit amb una desigualtat estricta. En particular, contràriament al que passava a les variables aleatòries discretes, per a una variable aleatòria contínua sempre tenim que \\[ P(X\\leq a)=P(X&lt;a) \\] perquè \\[ P(X\\leq a)=P(X&lt;a)+P(X=a)=P(X&lt;a)+0=P(X&lt;a). \\] Més exemples: \\(P(X\\geq a)=P(X&gt; a)+P(X=a)=P(X&gt; a)\\) \\(P(a \\leq X\\leq b)=P(a&lt;X &lt;b)+P(X=a)+P(X=b)\\) \\(=P(a&lt;X &lt;b)\\) 1.4.1 Densitat i distribució Sigui \\(X\\) una variable aleatòria contínua. Com ja hem dit, la seva funció de distribució \\(F_X\\) torna a ser \\[ x\\mapsto F_X(x)=P(X\\leq x) \\] Però com que ara tenim que \\(P(X=x)=0\\) per a tot \\(x\\in \\mathbb{R}\\), no podem definir la funció de densitat de \\(X\\) com a \\(f_X(x)=P(X=x)\\). Què podem fer? Recordau que, a les variables aleatòries discretes, \\[ F_X(a)=\\sum_{x\\leq a} f_X(x) \\] En el context de matemàtiques “contínues”, la suma \\(\\sum\\) es tradueix en una integral \\(\\int\\). Definim aleshores la funció de densitat d’una variable aleatòria contínua \\(X\\) com la funció \\(f_X:\\mathbb{R}\\to \\mathbb{R}\\) tal que: \\(f_X(x)\\geq 0\\), per a tot \\(x\\in \\mathbb{R}\\) \\(\\displaystyle F_X(a)=\\int_{-\\infty}^a f_{X}(x)\\, dx\\) per a tot \\(a \\in \\mathbb{R}\\). Recordau que la integral té una interpretació senzilla en termes d’àrees. En concret, donats \\(a \\in \\mathbb{R}\\) i una funció \\(f(x)\\), la integral \\[ \\int_{-\\infty}^a f(x)\\, dx \\] és igual a l’àrea de la regió compresa entre la corba \\(y=f(x)\\) i l’eix d’abscisses \\(y=0\\) a l’esquerra de la recta vertical \\(x=a\\). Per tant, la funció de densitat \\(f_X\\) de \\(X\\) és la funció positiva tal que, per a tot \\(a\\in \\mathbb{R}\\), \\(F_X(a)\\) és igual a l’àrea sota la corba \\(y=f_X(x)\\) (és a dir, entre aquesta corba i l’eix d’abscisses) a l’esquerra de \\(x=a\\). Quina és la idea intuïtiva que hi ha al darrere d’aquesta definició de densitat? Suposau que dibuixam histogrames de freqüències relatives dels valors de \\(X\\) sobre tota la població. Recordau que, en un histograma de freqüències relatives, la freqüència relativa de cada classe (ara la probabilitat, ja que parlam de tota la població) és l’àrea de la seva barra, és a dir, l’amplada de la classe per l’alçada de la barra. I que diem a aquesta alçada la densitat de la classe (i per tant, qualque cosa tendrà a veure amb la densitat de \\(X\\), no trobau?). Si dibuixam els histogrames de \\(X\\) prenent classes cada vegada més estretes, els seus polígons de freqüències tendeixen a dibuixar una corba, que hem acolorit en vermell en el darrer histograma de la seqüència següent: Quan l’amplada de les classes tendeix a 0, obtenim una corba que és el límit d’aquests polígons de freqüències: Aquesta corba és precisament \\(y=f_X(x)\\). La funció de densitat \\(f_X\\) d’una variable aleatòria contínua \\(X\\) és la funció límit dels polígons de freqüències d’histogrames de \\(X\\) quan l’amplada de les classes tendeix a 0. Vegem algunes propietats que es dedueixen del fet que \\(F_X(a)=P(X\\leq a)\\) sigui igual a l’àrea sota la corba \\(y=f_X(x)\\) a l’esquerra de \\(x=a\\): Com que \\(P(X&lt;\\infty)=P(\\Omega)=1\\), l’àrea total sota la curva \\(y=f_X(x)\\) és 1. \\(P(a\\leq X\\leq b)=P(X\\leq b)-P(X&lt;a)\\) és l’àrea sota la corba \\(y=f_X(x)\\) a l’esquerra de \\(x=b\\) menys l’àrea sota la corba \\(y=f_X(x)\\) a l’esquerra de \\(x=a\\). Per tant, \\(P(a\\leq X\\leq b)\\) és igual a l’àrea sota la corba \\(y=f_X(x)\\) entre \\(x=a\\) i \\(x=b\\). Si \\(\\varepsilon&gt;0\\) és molt, molt petit, l’àrea sota la corba \\(y=f_X(x)\\) entre \\(a-\\varepsilon\\) i \\(a+\\varepsilon\\) és aproximadament \\(2\\varepsilon\\cdot f_X(a)\\) (vegeu la Figura 1.4). És a dir, \\[ P(a-\\varepsilon\\leq X\\leq a+\\varepsilon)\\approx 2\\varepsilon\\cdot f_X(a). \\] Per tant, \\(f_X(a)\\) ens dóna una indicació de la probabilitat que \\(X\\) valgui aproximadament \\(a\\) (però no és \\(P(X=a)\\), que val 0). És a dir, per exemple, si \\(f_X(a)=0.1\\) i \\(f_X(b)=0.5\\), la probabilitat que \\(X\\) prengui un valor al voltant de \\(b\\) és 5 vegades més gran que la probabilitat que prengui un valor al voltant d’\\(a\\). Figura 1.4: Àrea sota la corba al voltant d’\\(a\\) Però \\(P(X=a)=P(X=b)=0\\), així que, per favor, evitau dir que “la probabilitat que \\(X\\) valgui \\(b\\) és 5 vegades més gran que la probabilitat que valgui \\(a\\)”. Sí, ja sabem que \\(5\\cdot 0=0\\), però la frase és enganyosa: la probabilitat que \\(X\\) valgui \\(b\\) no més gran que la probabilitat que valgui \\(a\\). A les variables aleatòries discretes, definíem la moda com el valor (o els valors) més probable. Però ara no té sentit definir la moda d’una variable contínua \\(X\\) com el valor \\(x_0\\) tal que \\(P(X=x_0)\\) sigui màxim, perquè \\(P(X=x)=0\\) per a tot \\(x\\in \\mathbb{R}\\). Aleshores, es defineix la moda d’una variable aleatòria contínua \\(X\\) com el valor (o els valors) \\(x_0\\) tal que \\(f_X(x_0)\\) és màxim. Com que \\(f_X(x_0)\\) mesura la probabilitat que \\(X\\) valgui “aproximadament” \\(x_0\\), tenim que la moda de \\(X\\) és el valor prop del qual és més probable que caigui el valor de \\(X\\). Unes consideracions finals: Ho hem dit en la definició, i ho hem emprat implícitament en tota la secció, però ho tornam a repetir: \\(f_X(x)\\geq 0\\) per a tot \\(x\\in \\mathbb{R}\\). En realitat, que \\(f_X(x)\\) sigui \\(\\geq 0\\) per a tot \\(x\\in \\mathbb{R}\\) és conseqüència del fet que la funció \\(F_X(x)\\) sigui positiva i creixent (les funcions de distribució són sempre creixents, perquè si \\(x&lt;y\\), \\(F_X(x)=P(X\\leq x)\\leq P(X\\leq i)=F_X(y)\\)) i coincideixi amb \\(\\int_{-\\infty}^x f_X(x)\\,dx\\). Però és més senzill donar-ho com a part de la definició i així ens estalviam la demostració. \\(f_X(x)\\) no és una probabilitat, i per tant pot ser més gran que 1. Per exemple, el gràfic següent mostra la densitat d’una variable normal \\(N(0,0.01)\\) (vegeu la Secció 1.5), que arriba a valer gairebé 40. La funció de densitat \\(f_X\\) no té per què ser contínua, malgrat la funció de distribució \\(F_X\\) ho sigui. 1.4.2 Esperança, variància, quantils… L’esperança i la variància d’una variable aleatòria contínua \\(X\\), amb funció de densitat \\(f_X\\), es defineixen com en el cas discret, substituint la suma \\(\\sum_{x\\in D_x}\\) per una integral, i tenen les mateixes propietats. La mitjana, o esperança (o valor mitjà, valor esperat…), de \\(X\\) és \\[ E(X)=\\int_{-\\infty}^{\\infty}x \\cdot f_{X}(x)\\, dx \\] És a dir, és l’àrea compresa entre l’eix d’abscisses i la corba \\(y=xf_X(x)\\). Com en el cas discret, també la indicarem de vegades amb \\(\\mu_X\\). Aquest valor té la mateixa interpretació que en el cas discret: Representa el valor mitjà de \\(X\\) sobre el total de la població. És (amb probabilitat 1) el límit de les mitjanes aritmètica de mostres aleatòries de mida \\(n\\) de valors de \\(X\\), quan \\(n\\to \\infty\\). Si \\(g:\\mathbb{R}\\to \\mathbb{R}\\) és una funció contínua, l’esperança de \\(g(X)\\) és \\[ E(g(X))=\\int_{-\\infty}^{+\\infty} g(x) f_X(x)dx \\] La variància de \\(X\\) és \\[ \\sigma(X)^2=E((X-\\mu_X)^2)=\\int_{-\\infty}^{+\\infty} (x-\\mu_X)^2 f_X(x)dx \\] i es pot demostrar que és igual a \\[ \\sigma(X)^2=E(X^2)-\\mu_X^2. \\] També la indicarem de vegades amb \\(\\sigma_X^2\\). La desviació típica de \\(X\\) és \\[ \\sigma(X)=+\\sqrt{\\sigma(X)^2} \\] i també la indicarem de vegades amb \\(\\sigma_X\\). Com en el cas discret, la variància i la desviació típica quantifiquen la variabilitat dels resultats de \\(X\\) respecte del seu valor mitjà \\(\\mu_X\\). Aquests paràmetres de \\(X\\) tenen les mateixes propietats en el cas continu que en el discret. Les recordam: Si \\(b\\) és una variable aleatòria constant, \\(E(b)=b\\) i \\(\\sigma(b)^2=0\\). Si \\(X_1,\\ldots,X_n\\) són variables aleatòries i \\(a_1,\\ldots,a_n,b\\in \\mathbb{R}\\), \\[ E(a_1X_1+\\cdots+a_nX_n+b)=a_1E(X_1)+\\cdots+a_nE(X_n)+b \\] Si \\(X\\leq Y\\), aleshores \\(E(X)\\leq E(Y)\\). Si \\(a,b\\in \\mathbb{R}\\), \\(\\sigma(aX+b)^2=a^2 \\sigma(X)^2\\) i \\(\\sigma(aX+b)=|a|\\cdot \\sigma(X)\\). Si \\(X_1,\\ldots,X_n\\) són variables aleatòries independents (i, en principi, només en aquest cas) i \\(a_1,\\ldots,a_n,b\\in \\mathbb{R}\\), \\[ \\begin{array}{l} \\sigma(a_1X_1+\\cdots+a_nX_n+b)^2=a_1\\cdot\\sigma(X_1)^2+\\cdots+a_n\\cdot\\sigma(X_n)^2\\\\ \\sigma(a_1X_1+\\cdots+a_nX_n+b)=\\sqrt{a_1\\cdot\\sigma(X_1)^2+\\cdots+a_n\\cdot\\sigma(X_n)^2} \\end{array} \\] Si no són independents, aquestes igualtats poden ser falses. El quantil d’ordre \\(p\\) (o \\(p\\)-quantil) d’una variable aleatòria contínua \\(X\\) és el valor \\(x_p\\in \\mathbb{R}\\) més petit tal que \\[ F_X(x_p)=P(X\\leq x_p)=p \\] Observau que, com que \\(F_X(x)\\) és contínua, tendeix a 0 (la probabilitat del conjunt buit) quan \\(x\\to -\\infty\\), i tendeix a 1 (la probabilitat de tot \\(\\mathbb{R}\\)) quan \\(x\\to +\\infty\\), pel Teorema del Valor Mitjà de les funcions contínues (que diu, bàsicament, que les funcions contínues no peguen bots) pren tots els valors de l’interval \\((0,1)\\) i per tant, per a qualsevol \\(p\\in (0,1)\\), existeix qualque \\(x\\) tal que \\(F_X(x)=p\\). La mediana de \\(X\\) és el seu 0.5-quantil, el primer i tercer quartils són el seu 0.25-quantil i el seu 0.75-quantil, etc. 1.5 Variables aleatòries normals Una variable aleatòria contínua \\(X\\) és normal (o té distribució normal) de paràmetres \\(\\mu\\) i \\(\\sigma\\) (per abreujar, \\(N(\\mu,\\sigma)\\)) quan la seva funció de densitat és \\[ f_{X}(x)=\\frac{1}{\\sqrt{2\\pi}\\sigma} e^{{-(x-\\mu)^2}/{2\\sigma^{2}}} \\] Naturalment, no us heu de saber aquesta fórmula. Però sí que heu de saber que: Una variable aleatòria normal \\(X\\) és contínua, i per tant \\(P(X=x)=0\\), \\(P(X\\leq x)=P(X&lt;x)\\) etc. Si \\(X\\) és normal, la seva funció de distribució \\(F_X\\) és injectiva i creixent: si \\(x&lt;y\\), \\(F_X(x)&lt;F_X(y)\\). Si \\(X\\) és \\(N(\\mu,\\sigma)\\), aleshores \\(\\mu_X=\\mu\\) i \\(\\sigma_X=\\sigma\\). Una variable aleatòria normal diem que és estàndard (o típica) quan és \\(N(0,1)\\). Normalment indicarem les variables normals estàndard amb \\(Z\\). Observau, doncs, que si \\(Z\\) és normal estàndard, \\(\\mu_Z=0\\) i \\(\\sigma_Z=1\\). La gràfica de la densitat d’una variable aleatòria normal és la famosa campana de Gauss: Figura 1.5: Densitat d’una variable normal estàndard La distribució normal és una distribució teòrica, no la trobareu exacta en la vida real. I malgrat el seu nom, no és més “normal” que altres distribucions contínues. Però és molt important, pel fet que moltes distribucions de la vida real són aproximadament normals. El motiu és que: Si una variable aleatòria consisteix a prendre un nombre molt gran \\(n\\) de mesures independents d’una o diverses variables aleatòries i sumar-les, aleshores té distribució aproximadament normal, encara que les variables aleatòries de partida no ho siguin. Exemple 1.9 Una variable binomial \\(B(n,p)\\) s’obté prenent \\(n\\) mesures independents d’una variable Bernoulli \\(Be(p)\\) i sumant-les. Per tant, per la “regla” anterior, una \\(B(n,p)\\) hauria de ser aproximadament normal si \\(n\\) és gran. Doncs sí, si \\(n\\) és gran (posem més gran que 40, encara que si \\(p\\) és molt propera a 0 o 1, la mida de les mostres ha de ser més gran), una variable \\(X\\) binomial \\(B(n,p)\\) és aproximadament normal \\(N(np,\\sqrt{np(1-p)})\\), on, recordau que si \\(X\\) és \\(B(n,p)\\), aleshores \\(\\mu_X=np\\) i \\(\\sigma_X=\\sqrt{np(1-p)}\\). Aquest “aproximadament” significa que la densitat i la distribució de \\(X\\) són aproximadament les de la normal. Per exemple, el gràfic següent compara les funcions de distribució d’una binomial \\(B(40,0.3)\\) i una normal \\(N(40\\cdot 0.3,\\sqrt{40\\cdot 0.3\\cdot 0.7})\\). Figura 1.6: Funcions de distribució de B(40,0.3) i N(400.3,sqrt(500.30.7) En els propers temes emprarem sovint que una variable \\(B(n,p)\\) amb \\(n\\) és gran és aproximadament \\(N(np,\\sqrt{np(1-p)})\\). Exemple 1.10 Podem entendre que, amb una variable de Poisson, observam tots els punts d’un espai o tots els instants d’un període de temps i sumam tots els Èxits que hi trobam. Doncs, un altre cop, si \\(X\\) és una variable aleatòria de Poisson \\(Po(\\lambda)\\) i \\(\\lambda\\) és gran, aleshores \\(X\\) és aproximadament \\(N(\\lambda,\\sqrt{\\lambda})\\). Per exemple, el gràfic següent compara les funcions de distribució d’una Poisson \\(Po(70)\\) i una normal \\(N(70,\\sqrt{70})\\). Figura 1.7: Funcions de distribució de Pois(70) i N(70,sqrt(70)) Quan s’aproxima una variable discreta \\(X\\), com ara una binomial o una Poisson, per mitjà d’una variable normal \\(Y\\), és convenient aplicar l’anomenada correcció de continuïtat: per a cada \\(n\\in \\mathbb{N}\\), aproximar: \\(P(X\\leq n)\\) per mitjà de \\(P(Y&lt; n+1/2)\\) \\(P(X=n)\\) per mitjà de \\(P(n-1/2&lt; Y&lt; n+1/2)\\) Vegeu l’Exemple 1.11 més a baix. 1.5.1 Amb R Per calcular probabilitats d’una \\(N(\\mu,\\sigma)\\), cal calcular les integrals a mà. O podeu usar R, per a qui la normal és norm. Per tant, si \\(X\\sim N(\\mu,\\sigma)\\): dnorm(x,mu,sigma) dóna el valor de la densitat \\(f_X(x)\\) pnorm(x,mu,sigma) dóna el valor de la distribució \\(F_X(x)=P(X\\leq x)\\) qnorm(q,mu,sigma) dóna el \\(q\\)-quantil de \\(X\\) rnorm(n,mu,sigma) dóna un vector de \\(n\\) nombres aleatoris generats amb aquesta distribució Així, per exemple, si \\(X\\) és \\(N(1,2)\\) \\(P(X\\leq 1.5)\\) és pnorm(1.5,1,2) ## [1] 0.598706 El 0.4-quantil de \\(X\\), és a dir, el valor \\(q\\) tal que \\(P(X\\leq q)=0.4\\) és qnorm(0.4,1,2) ## [1] 0.493306 \\(P(X=1.5)\\) és dnorm(1.5,1,2) ## [1] 0.193334 No! Com que \\(X\\) és contínua, \\(P(X=1.5)=0\\). El que us dóna dnorm(1.5,1,2) és el valor de la funció de densitat de \\(X\\) en 1.5, que no creiem que us interessi gaire. Si la normal és estàndard, no fa falta entrar la \\(\\mu=0\\) i la \\(\\sigma=1\\) (són els valors per defecte d’aquests paràmetres per a norm). Així, si \\(Z\\) és \\(N(0,1)\\): \\(P(Z\\leq 1.5)\\) és pnorm(1.5) ## [1] 0.933193 El seu 0.95-quantil és qnorm(0.95) ## [1] 1.64485 Què val \\(P(-1\\leq Z\\leq 1)\\)? Com que \\(P(-1\\leq Z\\leq 1)=P(Z\\leq 1)-P(Z\\leq -1)\\), és pnorm(1)-pnorm(-1) ## [1] 0.682689 Exemple 1.11 A la secció anterior, us hem dit que una variable binomial \\(B(n,p)\\) amb \\(n\\) gran s’aproxima per mitjà d’una variable normal \\(N(np,\\sqrt{np(1-p)})\\). Així, per exemple, una variable \\(X\\) binomial \\(B(400,0.2)\\) s’aproxima per mitjà d’una variable \\(Y\\) normal \\(N(400\\cdot 0.2,\\sqrt{400\\cdot 0.2\\cdot 0.8})=N(80,8)\\). Vegem amb alguns exemples que aquesta aproximació és millor aplicant-hi la correcció de continuïtat: \\(F_X(70)=P(X\\leq 70)\\): pbinom(70,400,0.2) ## [1] 0.116392 \\(F_Y(70)=P(Y\\leq 70)\\): pnorm(70,80,8) ## [1] 0.10565 L’aproximació de continuïtat ens diu que és millor aproximar \\(P(X\\leq 70)\\) per mitjà de \\(P(Y&lt; 70+1/2)\\): pnorm(70.5,80,8) ## [1] 0.117515 \\(f_X(70)=P(X=70)\\): dbinom(70,400,0.2) ## [1] 0.0233844 \\(f_Y(70)\\) (que no és \\(P(Y=70)\\): dnorm(70,80,8) ## [1] 0.0228311 L’aproximació de continuïtat ens diu que és millor aproximar \\(P(X=70)\\) per mitjà de \\(P(70-1/2&lt;Y&lt; 70+1/2)\\): pnorm(70.5,80,8) -pnorm(69.5,80,8) ## [1] 0.0228395 Exemple 1.12 La pressió sistòlica, mesurada en mm Hg, es distribueix com una variable normal amb valor mitjà i desviació típica que depenen del sexe i l’edat. Per a la franja d’edat 16-24 anys, aquests valors (s’estima que) són: Per a homes, \\(\\mu=124\\) i \\(\\sigma=13.7\\) Per a dones, \\(\\mu=117\\) i \\(\\sigma=13.7\\) El model d’hipertensió-hipotensió acceptat és el descrit en la Figura 1.8. Volem calcular els límits de cada classe per a cada sexe en aquest grup d’edat. Figura 1.8: Model d’hipertensió-hipotensió. Vegem: El límit superior del grup d’hipotensió serà el valor que deixa a l’esquerra un 5% de les tensions: el 0.05-quantil de la distribució. El límit superior del grup de risc d’hipotensió serà el valor que deixa a l’esquerra un 10% de les tensions: el 0.1-quantil de la distribució. El límit inferior del grup de risc d’hipertensió serà el valor que deixa a l’esquerra un 90% de les tensions: el 0.9-quantil de la distribució. El límit inferior del grup d’hipertensió serà el valor que deixa a l’esquerra un 95% de les tensions: el 0.95-quantil de la distribució. En els homes, la tensió sistòlica és una variable aleatòria \\(N(124,13.7)\\). Aleshores, aquests quantils són: El 0.05-quantil: qnorm(0.05,124,13.7) ## [1] 101.466 El 0.1-quantil: qnorm(0.1,124,13.7) ## [1] 106.443 El 0.9-quantil: qnorm(0.9,124,13.7) ## [1] 141.557 El 0.95-quantil: qnorm(0.95,124,13.7) ## [1] 146.534 En resum, per als homes de 16 a 24 anys tenim els límits de la Taula 1.1. Taula 1.1: Límits d’hipotensió-hipertensió en homes joves. Grup Interval Hipotens &lt;101.5 Prehipotens 101.5 a 106.4 Normotens 106.4 a 141.6 Prehipertens 141.6 a 146.5 Hipertens &gt; 146.5 Calculau els límits per a les dones. 1.5.2 Propietats bàsiques Una de les propietats clau de la distribució normal és la seva simetria: Si \\(X\\) és \\(N(\\mu,\\sigma)\\), la seva densitat \\(f_X\\) és simètrica respecte de \\(\\mu\\), és a dir, \\[ f_{X}(\\mu-x)=f_{X}(\\mu+x), \\] i pren el valor màxim a \\(x=\\mu\\). És a dir, \\(\\mu\\) és la moda de \\(X\\). Per tant, el valor al voltant del qual és més probable que una variable normal \\(N(\\mu,\\sigma)\\) caigui és el seu valor esperat \\(\\mu\\). En particular, si \\(Z\\) és \\(N(0,1)\\), llavors \\(f_Z\\) és simètrica al voltant de 0, és a dir, \\(f_{Z}(-x)=f_{Z}(x)\\), i la moda de \\(Z\\) és \\(x=0\\). Recordau que la funció de distribució d’una variable aleatòria contínua \\(X\\), \\[ F_X(x)=P(X\\leq x) \\] és l’àrea compresa entre la densitat \\(y=f_X(x)\\) i l’eix d’abscisses a l’esquerra de \\(x\\). Llavors, la simetria de \\(f_X\\) fa que, per a tot \\(x\\geq 0\\), les àrees a l’esquerra de \\(\\mu-x\\) i a la dreta de \\(\\mu+x\\) siguin iguals. És a dir, \\[ P(X\\leq \\mu-x)=P(X\\geq \\mu+x)=1-P(X\\leq \\mu+x) \\] En particular (prenent \\(x=0\\)) \\[ P(X\\leq \\mu)=1-P(X\\leq \\mu)\\Rightarrow P(X\\leq \\mu)=0.5 \\] i per tant, \\(\\mu\\) és també la mediana de \\(X\\). Si \\(X\\) és \\(N(\\mu,\\sigma)\\), \\(\\mu\\) és la mitjana, la mediana i la moda de \\(X\\). En el cas concret de la normal estàndard \\(Z\\), per a qualsevol \\(z\\geq 0\\) es té que les àrees a l’esquerra de \\(-z\\) i a la dreta de \\(z\\) són iguals \\[ P(Z\\leq -z)=P(Z\\geq z)=1-P(Z\\leq z) \\] i la mediana de \\(Z\\) és 0. Ara que sabem més coses de la normal, a l’Exemple 1.12 ens haguéssim pogut estalviar la meitat de la feina: per la simetria, el 0.95-quantil ha d’estar a la mateixa distància de \\(\\mu\\) que el 0.05-quantil, però a la dreta. És a dir, com que \\(\\mu=124\\) i el 0.05-quantil havia estat 101.4655, el 0.95-quantil ha de ser el valor a la dreta de 124 i a la mateixa distància d’aquest que 101.4655: \\[ 124+(124-101.4655)=126.5345 \\] El mateix passa amb el 0.9-quantil i el 0.1-quantil, comprovau-ho. Si \\(\\mu\\) creix, desplaça a la dreta l’eix vertical de simetria de la densitat, i amb ell tota la corba. Si \\(\\sigma\\) creix, la corba s’aplana: en augmentar la desviació típica, els valors són més variats i augmenta la probabilitat que prenguin valors més llunays de \\(\\mu\\). El gràfic següent mostra l’efecte combinat: Indicarem amb \\(z_q\\) el \\(q\\)-quantil d’una variable normal estàndard \\(Z\\). És a dir, \\(z_q\\) és el valor tal que \\(P(Z\\leq z_q)=q\\). A banda del fet que \\(z_{0.5}=0\\) (la mediana de \\(Z\\) és 0), hi ha dos quantils més de la normal estàndard \\(Z\\) que hauríeu de recordar: \\(z_{0.95}=1.64\\); és a dir, \\(P(Z\\leq 1.64)=0.95\\) i per tant \\(P(Z\\leq -1.64)=P(Z\\geq 1.64)=0.05\\) i \\[ P(-1.64\\leq Z\\leq 1.64)=0.9. \\] \\(z_{0.975}=1.96\\); és a dir, \\(P(Z\\leq 1.96)=0.975\\) i per tant \\(P(Z\\leq -1.96)=P(Z\\geq 1.96)=0.025\\) i \\[ P(-1.96\\leq Z\\leq 1.96)=0.95. \\] Molt sovint el valor 1.96 de \\(z_{0.975}\\) s’aproxima per 2. Teniu permís per a fer-ho quan no disposeu de mitjans (R, aplis de mòbil) per a calcular quantils i us considereu incapaços de recordar “1.96”. Però només en aquest cas. Una de les propietats de la distribució normal que ens faciliten molt la vida és que tota combinació lineal de variables aleatòries normals independents és normal. En concret, tenim els dos resultats següents: Teorema 1.5 Sigui \\(X\\) una variable \\(N(\\mu,\\sigma)\\). Per a tots \\(a,b\\in \\mathbb{R}\\), \\(aX+b\\) és normal \\(N(a\\mu+b,|a|\\cdot\\sigma)\\). En particular, la tipificada de \\(X\\) \\[ Z=\\dfrac{X-\\mu}{\\sigma} \\] és normal estàndard. Més en general: Teorema 1.6 Si \\(X_1,\\ldots,X_n\\) són variables aleatòries normals independents i \\(a_1,\\ldots,a_n,b\\in \\mathbb{R}\\), llavors \\(a_1X_1+\\cdots +a_nX_n+b\\) és \\(N(\\mu,\\sigma)\\) amb \\[ \\mu=a_1\\mu_1+\\cdots +a_n\\mu_n+b,\\ \\sigma=\\sqrt{a_1^2\\sigma^2_1+\\cdots +a_n^2\\sigma^2_n} \\] Que tota combinació lineal de variables normals torni a ser del mateix tipus, és a dir, normal, és una propietat molt útil de les variables normals que poques famílies de distribucions comparteixen. Per exemple, si \\(X\\) és una variable binomial \\(B(n,p)\\) amb \\(p\\neq 0\\), la variable \\(2X\\) no és binomial, perquè només pren valors parells, mentre que una variable binomial \\(B(m,q)\\) ha de poder prendre tots els valors entre 0 i \\(m\\). Les probabilitats de la normal tipificada determinen les de la normal original, perquè si \\(X\\) és \\(N(\\mu,\\sigma)\\): \\[ \\begin{array}{rl} P(a\\leq X\\leq b)\\!\\!\\!\\!\\! &amp; \\displaystyle =P\\Big( \\frac{a-\\mu}{\\sigma}\\leq \\frac{X-\\mu}{\\sigma}\\leq \\frac{b-\\mu}{\\sigma}\\Big)\\\\ &amp; \\displaystyle =P\\Big(\\frac{a-\\mu}{\\sigma}\\leq Z\\leq \\frac{b-\\mu}{\\sigma}\\Big) \\end{array} \\] Això serveix per deduir fórmules, i els vostres pares ho empraven per calcular probabilitats de normals (amb taules de probabilitats de la normal estàndard); ara és més còmode usar una apli. 1.5.3 Intervals de referència Un interval de referència del \\(100q\\%\\) per a una variable aleatòria \\(X\\) és un interval \\([a,b]\\) tal que \\[ P(a\\leq X\\leq b)=q. \\] És a dir, un interval de referència del \\(100q\\%\\) per a \\(X\\) és un interval que conté els valors de \\(X\\) del \\(100q\\%\\) dels subjectes de la població. Per exemple, hem vist en la secció anterior que [-1.64,1.64] i [-1.96,1.96] són intervals de referència del 90% i del 95%, respectivament, per a una variable normal estàndard \\(Z\\). Els més comuns són els intervals de referència del 95% (\\(q=0.95\\)), que satisfan que \\[ P(a\\leq X\\leq b)=0.95 \\] i són els, que per exemple, us donen com a valors de referència en les analítiques: Quan es parla d’un interval de referència sense donar la probabilitat, se sobreentén sempre que és l’interval de referència del 95%. Quan \\(X\\) és \\(N(\\mu,\\sigma)\\), aquests intervals de referència es prenen sempre centrats en la mitjana \\(\\mu\\), és a dir, de la forma \\[ [\\mu-\\text{alguna cosa},\\mu+\\text{aquesta mateixa cosa}]. \\] Es calculen amb el resultat següent: Teorema 1.7 Si \\(X\\) és \\(N(\\mu,\\sigma)\\), un interval de referència del \\(100q\\%\\) per a \\(X\\) és \\[ [\\mu- z_{(1+q)/2}\\cdot \\sigma, \\mu+ z_{(1+q)/2}\\cdot \\sigma] \\] on \\(z_{(1+q)/2}\\) indica el \\((1+q)/2\\)-quantil de la normal estàndard \\(Z\\). Normalment escriurem aquest interval \\[ \\mu\\pm z_{(1+q)/2}\\cdot \\sigma. \\] La demostració és un exemple d’ús de la tipificació de la normal: \\[ \\begin{array}{l} P(\\mu-x\\leq X\\leq \\mu+x)=q\\\\ \\qquad \\Longleftrightarrow \\displaystyle P\\Big(\\frac{\\mu-x-\\mu}{\\sigma}\\leq \\frac{X-\\mu}{\\sigma}\\leq \\frac{\\mu+x-\\mu}{\\sigma}\\Big)=q\\\\ \\qquad \\Longleftrightarrow \\displaystyle P(-x/{\\sigma}\\leq Z\\leq {x}/{\\sigma})=q\\\\ \\qquad \\Longleftrightarrow \\displaystyle P(Z\\leq {x}/{\\sigma})-P(Z\\leq -{x}/{\\sigma})=q\\\\ \\qquad \\Longleftrightarrow \\displaystyle P(Z\\leq {x}/{\\sigma})-(1-P(Z\\leq {x}/{\\sigma}))=q\\\\ \\qquad \\text{(per la simetria de $f_Z$ al voltant de 0)}\\\\ \\qquad \\Longleftrightarrow \\displaystyle 2P(Z\\leq {x}/{\\sigma})=q+1\\\\ \\qquad \\Longleftrightarrow P(Z\\leq {x}/{\\sigma})=(1+q)/2\\\\ \\qquad \\Longleftrightarrow x/\\sigma= z_{(1+q)/2}\\\\ \\qquad \\Longleftrightarrow x=z_{(1+q)/2}\\cdot \\sigma \\end{array} \\] Si \\(q=0.95\\), llavors \\((1+q)/2=0.975\\) i \\(z_{0.975}=1.96\\). Per tant, l’interval de referència del 95% per a una variable \\(X\\) normal \\(N(\\mu,\\sigma)\\) és \\[ \\mu\\pm 1.96\\sigma. \\] I com que aquest 1.96 sovint s’aproxima per 2, l’interval de referència del 95% d’una \\(N(\\mu,\\sigma)\\) se sol simplificar a \\[ \\mu\\pm 2\\sigma. \\] Això diu, bàsicament, que Si una població segueix una distribució normal \\(N(\\mu,\\sigma)\\), un 95% dels seus individus tenen el seu valor de \\(X\\) a distància com a màxim \\(2\\sigma\\) (“a dues sigmes”) de \\(\\mu\\). Exemple 1.13 Segons l’OMS, les altures (en cm) de les dones europees de 18 anys segueixen una llei \\(N(163.1,18.53)\\). Quin és l’interval d’altures centrat en la mitjana que conté a la meitat les europees de 18 anys? Fixau-vos que, si diem \\(X\\) a la variable aleatòria “Altura d’una dona europea de 18 anys en cm”, el que volem saber és l’interval centrat en la seva mitjana, 163.1, tal que la probabilitat que l’alçada d’una europea de 18 anys triada a l’atzar pertanyi a aquest interval sigui 0.5. És a dir, l’interval de referència del 50% per a \\(X\\). Ens diuen que \\(X\\) és \\(N(163.1,18.53)\\). Si \\(q=0.5\\), llavors \\((1+q)/2=0.75\\). El 0.75-quantil \\(z_{0.75}\\) d’una normal estàndard és qnorm(0.75) ## [1] 0.67449 Per tant, l’interval de referència demanat és \\(163.1\\pm 0.6745\\cdot 18.53\\), és a dir, arrodonint a mm, \\([150.6, 175.6]\\). Això ens diu que la meitat de les dones europees de 18 anys fan entre 150.6 i 175.6 cm. El z-score d’un valor \\(x_0\\in \\mathbb{R}\\) respecte d’una distribució \\(N(\\mu,\\sigma)\\) és \\[ \\frac{x_0-\\mu}{\\sigma} \\] És a dir, el z-score de \\(x_0\\) és el resultat de “tipificar” \\(x_0\\) en el sentit del Teorema 1.5.2. Si la variable poblacional és normal, com més gran és el valor absolut del z-score de \\(x_0\\), més “rar” és \\(x_0\\); el signe ens diu si és més gran o més petit que el valor esperat \\(\\mu\\). Exemple 1.14 Recordau que, segons l’OMS, les altures de les dones europees de 18 anys segueixen una llei \\(N(163.1,18.53)\\). Quin seria el z-score d’una jugadora de bàsquet de 18 anys que fes 191 cm? Seria \\[ \\frac{191-163.1}{18.53}=1.5 \\] Això se sol llegir dient que l’alçada d’aquesta jugadora està 1.5 sigmes per sobre de l’alçada mitjana. 1.5.4 Variables log-normals Direm que \\(X\\) és una variable quan el seu logaritme \\(\\ln(X)\\) és una variable normal. O, si ho preferiu, és una variable de la forma \\(e^Y\\) amb \\(Y\\) normal. Moltes concentracions d’enzims o anticossos tenen distribució aproximadament log-normal. La densitat d’una variable log-normal és asimètrica, amb una cua a la dreta, com mostra la Figura 1.9. Figura 1.9: Densitat de \\(e^Z\\) amb \\(Z\\) normal estàndard. Recíprocament, molt sovint una variable la densitat de la qual mostri una pujada ràpida des del 0 a la moda i després una cua a la dreta, satisfà que el seu logaritme segueix una distribució aproximadament normal. Això serà útil més endavant. Amb R, la distribució log-normal és lognorm. Els paràmetres que s’empren per descriure-la són els de la variable normal definida pel seu logaritme: La mitjana en escala logarítmica de \\(X\\): \\(\\mu_{\\ln(X)}\\) La desviació típica en escala logarítmica de \\(X\\): \\(\\sigma_{\\ln(X)}\\) 1.6 Test de la lliçó 1 1.6.1 Variables aleatòries discretes (1) Sigui \\(X\\) una variable aleatòria discreta de mitjana \\(\\mu\\) i desviació típica \\(\\sigma\\). Quina o quines de les afirmacions següents són sempre vertaderes? \\(E(X+2)=\\mu+2\\). \\(\\sigma(X+2)=\\sigma+2\\). \\(\\sigma(-X)=-\\sigma\\). \\(\\sigma(-X)=\\sigma\\). \\(\\sigma(X/2)=\\sigma/2\\). Cap de les altres afirmacions és vertadera. (2) La funció de distribució \\(F_X(x)\\) d’una variable aleatòria \\(X\\) ens dóna: La probabilitat d’obtenir el valor \\(x\\). La probabilitat d’obtenir un valor entre \\(-x\\) i \\(x\\), tots dos extrems inclosos. La probabilitat d’obtenir un valor entre \\(0\\) i \\(x\\), tots dos extrems inclosos. La probabilitat d’obtenir un valor més petit o igual que \\(x\\). La probabilitat d’obtenir un valor estrictament més petit que \\(x\\). (3) El nombre anual d’accidents laborals d’un tipus concret segueix una distribució de Poisson. Al llarg del temps s’ha observat que el 55% dels anys no es produeix cap accident d’aquests. Quin valor estimes que té el paràmetre \\(\\lambda\\) d’aquesta distribució de Poisson? 0.55 \\(e^{-0.55}\\) \\(\\ln(0.55)\\) \\(-\\ln(0.55)\\) Un valor que no és cap dels proposats en les altres respostes. (4) Quina o quines de les variables següents tenen distribució binomial? El pes d’una persona triada a l’atzar. Triam un nombre de llançaments a l’atzar, llançam aquest nombre de vegades una moneda, i comptam el nombre de cares. El nombre de glòbuls vermells en 1 mm3 de sang. La proporció d’hipertensos en una mostra aleatòria de 50 individus. Triam 10 estudiants diferents en una classe de 20, i comptam quantes dones han sortit. Cap d’elles. (5) Quina o quines de les variables següents tenen una distribució de Poisson? El pes d’una persona triada a l’atzar. El nombre de casos diaris de COVID-19 a Mallorca. El nombre de glòbuls vermells en 1 mm3 de sang. La proporció d’hipertensos en una mostra aleatòria de 50 individus. Triam 10 estudiants diferents en una classe de 20, i comptam quantes dones han sortit. 1.6.2 Variables aleatòries contínues (6) Sigui \\(X\\) una variable aleatòria contínua de funció de densitat: \\[ f_X(x)=\\left\\{\\begin{array}{ll} 0 &amp; \\mbox{si $x&lt;0$}\\\\ \\frac{2\\sqrt{2}}{\\sqrt{\\pi}} e^{-2x^2} &amp; \\mbox{si $x\\geq 0$} \\end{array} \\right. \\] És cert que \\(P(X=1)=2\\sqrt{2}e^{-2}/\\sqrt{\\pi}\\)? Sí No: en realitat \\(P(X=1)=\\int_{-\\infty}^1 \\frac{2\\sqrt{2}}{\\sqrt{\\pi}} e^{-2x^2}\\,dx\\) però no sé calcular aquesta integral, o sí que sé calcular-la, però em fa mandra fer-ho. Això no és la funció de densitat d’una variable aleatòria contínua, perquè no és una funció contínua (en el 0 bota de 0 a \\(2\\sqrt{2}/\\sqrt{\\pi}\\)) Totes les altres respostes són incorrectes (7) Sigui \\(X\\) una variable aleatòria contínua de mitjana \\(\\mu\\). Què val \\(P(X=\\mu)\\)? 0.5 \\(\\mu\\) 0 Depèn de la variable aleatòria Totes les altres respostes són falses (8) Sigui \\(X\\) una variable aleatòria contínua de moda \\(M\\). Què val \\(P(X=M)\\)? 1 0.5 0 Depèn de la variable aleatòria, però és el valor màxim de \\(P(X=x)\\) Depèn de la variable aleatòria, però és el valor màxim de la funció de densitat de \\(X\\). Totes les altres respostes són falses (9) Sigui \\(Z\\) una variable aleatòria normal estàndard. Marca les afirmacions vertaderes. És asimètrica a l’esquerra. La seva mitjana és 1. La seva desviació típica és 0. La seva variància és 1. La seva mitjana és 0. (10) Sigui \\(X\\) una variable aleatòria \\(N(\\mu,\\sigma)\\) i \\(f_X\\) la seva funció de densitat. Què val l’àrea entre la corba \\(y=f_X(x)\\) i l’eix d’abscisses? 0 \\(\\mu\\) \\(\\sigma\\) 1 Totes les altres respostes són falses (11) Siguin \\(X\\) una variable aleatòria \\(N(\\mu,\\sigma)\\) i \\(f_X\\) la seva funció de densitat. Quina de les afirmacions següents és vertadera? \\(\\mu\\) és la mitjana de \\(X\\), però no la seva mediana \\(\\mu\\) és la mitjana i la mediana de \\(X\\), però no la seva moda \\(\\mu\\) és la mitjana, la mediana i la moda de \\(X\\), però no és veritat que \\(P(X=\\mu)&gt;P(X=a)\\) per a tot \\(a\\neq \\mu\\) \\(\\mu\\) és la mitjana, la mediana i la moda de \\(X\\) i \\(P(X=\\mu)&gt;P(X=a)\\) per a tot \\(a\\neq \\mu\\) (12) El FME (Flux Màxim d’Expiració) de les al·lotes d’11 anys segueix una distribució aproximadament normal de mitjana 300 l/min i desviació típica 20 l/min. Marca les afirmacions vertaderes: Aproximadament la meitat de les al·lotes d’11 anys tenen un FME entre 280 l/min i 320 l/min. Al voltant del 95% de les al·lotes d’11 anys tenen un FME entre 280 l/min i 320 l/min. Al voltant del 95% de les al·lotes d’11 anys tenen un FME entre 260 l/min i 340 l/min. Al voltant del 5% de les al·lotes d’11 anys tenen un FME inferior a 260 l/min. Cap al·lota d’11 anys té FME superior a 360 l/min. (13) En una mostra aleatòria extreta de població sana es troba que una variable bioquímica té com a mitjana 90 i desviació típica 10. Si prenem una mostra d’individus sans, és raonable esperar que aproximadament el 95% d’ells tenguin un valor d’aquesta variable comprès entre 70 i 110? (marca totes les respostes correctes): Sí, sempre. No, mai. Si la variable té distribució normal, sí. Si la mostra és prou gran, sí. Si la variable té distribució normal i la mostra és prou gran, sí. (14) En una variable aleatòria contínua, la seva funció de densitat (marca una sola resposta): És sempre contínua Mesura el dens que és el seu domini. Aplicada a un nombre real, ens dóna dóna la probabilitat d’obtenir aquest número. Aplicada a un nombre real, ens dóna la probabilitat d’obtenir un valor menor o igual que aquest número. Totes les altres respostes són falses (15) Sigui \\(X\\) una variable aleatòria contínua de desviació típica \\(\\sigma\\). Què val la variància de la variable aleatòria \\(-X/2\\)? \\(\\sigma(-X/2)^2=-\\sigma^2/2\\). \\(\\sigma(-X/2)^2=\\sigma^2/2\\). \\(\\sigma(-X/2)^2=-\\sigma^2/4\\). \\(\\sigma(-X/2)^2=\\sigma^2/4\\). Totes les altres respostes són falses (16) Sigui \\(Z\\) una variable aleatòria normal estàndard. Marca totes les afirmacions vertaderes. És asimètrica a l’esquerra. La seva mitjana és 1. La seva desviació típica és 0. La seva variància és 1. La seva mediana és 0. (17) El temps que tarda a produir-se una determinada reacció bioquímica es distribueix segons una variable normal de mitjana 17 minuts i desviació típica 3 minuts. Què podem deduir d’aquesta afirmació? Marca totes les respostes correctes: Tots aquests temps se situen entre 8 i 26 minuts. Gairebé tots aquests temps se situen entre 11 i 23 minuts. És estrictament més probable que una reacció d’aquestes tardi entre 16 i 18 minuts que tardi entre 18 i 20 minutos. És estrictament més probable que una reacció d’aquestes tardi entre 18 i 20 minutos que tardi entre 16 i 18 minuts. És estrictament més probable que una reacció d’aquestes tardi entre 18 i 20 minutos que tardi entre 14 i 16 minuts. Cap de les afirmaciónes anteriors és correcta. (18) El temps que tarda a produir-se una determinada reacció bioquímica es distribueix segons una variable normal de mitjana 17 minuts i desviació típica 3 minuts. Quina és la probabilitat que tardi menys de 17 minuts? 0 0.5 1 17/3 17/2 Cap de les afirmaciónes anteriors és correcta. (19) El temps que tarda a produir-se una determinada reacció bioquímica es distribueix segons una variable normal de mitjana 17 minuts i desviació típica 3 minuts. Quina o quines de les afirmacions següents són vertaderes? Si poguéssim mesurar els temps amb precisió infinita, observaríem que el temps que tarda més sovint és exactament 17 minuts. Arrodonint a segons, el temps que tarda més sovint és 17 minuts. En un 95% de les ocasions tarda aproximadament entre 14 i 20 minutos Tarda més de 20 minutos amb la mateixa freqüència amb la qual tarda menys de 14 minuts Tarda més de 20 minutos amb la mateixa freqüència amb la qual tarda menys de 20 minutos En un 95% de les ocasions tarda 23 minuts o menys (20) Quina de les tres afirmacions és vertadera per a les tres distribucions normals de la figura inferior? (\\(\\sigma_1\\), \\(\\sigma_2\\) i \\(\\sigma_3\\) indiquen les desviacions típiques de les corbes 1, 2 i 3, respectivament). \\(\\sigma_1&gt; \\sigma_2&gt; \\sigma_3\\) \\(\\sigma_1&lt; \\sigma_2&lt; \\sigma_3\\) \\(\\sigma_1= \\sigma_2= \\sigma_3\\) Del gràfic no es pot deduir la relació entre les tres desviacions típiques Cap de les altres afirmacions és veritable. (21) El pes mitjà d’una bossa de patates d’una determinada marca és de 150 grams amb una desviació típica de 5.6 grams. Quin és el z-score d’una bossa que pesa 147 grams (arrodonit a 2 xifres decimals)? \\(-0.54\\) 0.30% 0.54% 0.70% Cap de les respostes anteriors és correcta (22) Si una v.a. normal té mitjana 18.1 i desviació típica 1.2, què val el seu 3er quartil (arrodonit a una xifra decimal)? (Pots usar R per calcular-lo) 18.1% 18.9 19.3% 20.5% Cap de les respostes anteriors és correcta (23) L’interval de referència (del 95%) de la concentració de creatinina en sèrum és 0.66-1.09 mg/dl. Què en podem deduir? (Marca només una resposta.) Que la probabilitat que la concentració mitjana de creatinina en sèrum estigui entre 0.66 i 1.09 mg/dl és del 95%. Que si prenem una mostra aleatòria d’individus i calculem la mitjana de les seves concentracions de creatinina, en un 95% de les ocasions aquesta mitjana estarà entre 0.66 i 1.09 mg/dl. Que un 5% dels individus tenen una concentració de creatinina en sèrum superior a 1.09 mg/dl. Que un 95% dels individus tenen una concentració de creatinina en sèrum entre 0.66 i 1.09 mg/dl. Que si prenem una mostra aleatòria d’individus, en un 95% de les ocasions tots els valors estaran entre 0.66 i 1.09 mg/dl. Cap de les altres respostes és correcta. "],
["chap-conceptes.html", "Tema 2 Alguns conceptes bàsics 2.1 Unitat d’observació 2.2 Població 2.3 Variable aleatòria 2.4 Mostra 2.5 Mostreig aleatori 2.6 Mostres de conveniència 2.7 Test de la lliçó 2", " Tema 2 Alguns conceptes bàsics 2.1 Unitat d’observació En un estudi estadístic, la unitat d’observació és, per entendre’ns, el tipus d’entitats que mesuram. En ciències de la vida solen ser éssers vius, però no sempre: Poden ser esdeveniments que els passin a éssers vius, de manera que un mateix subjecte pot ser mesurat diverses vegades: per exemple, embarassos, o les conseqüències de diferents accions sobre un subjecte. Poden ser parts d’éssers vius. Per exemple, si volem estudiar si l’ús del telèfon mòbil augmenta el risc de càncer de pell en les orelles, en els participants de l’estudi compararem l’orella dominant en aquest sentit amb l’altra, de manera que la unitat d’observació són les orelles de les persones, no les persones. Poden ser comunitats d’éssers vius, des de cultius de microorganismes a ecosistemes. Fins i tot poden ser altres estudis científics, en les revisions sistemàtiques on es resumeix tot el que s’ha publicat sobre un tema concret i s’analitzen conjuntament les dades recollides en totes aquestes publicacions. 2.2 Població En general, una població és simplement un conjunt d’individus o objectes sobre els quals volem conèixer alguna informació. Una població pot estar perfectament definida en un lloc i temps: per exemple, els habitants d’Espanya just avui. Però normalment la seva definició serà difusa. Si, per exemple, volem estimar alguna cosa sobre una espècie de plantes, de qui estam parlant exactament? De les plantes que estan vives just ara? De totes les plantes d’aquesta espècie de la història del món? Incloem les que encara no han nascut? Tranquils, no ens trencarem gens el cap amb això. Però almenys heu de ser conscients que una població pot contenir objectes que en realitat no existeixen ni hagin existit ni vagin a existir, sinó simplement que “podrien existir”. Parlarem llavors d’una població virtual (en altres llocs la qualifiquen de població metafòrica). Per exemple, quan diem que “La probabilitat que surti cara en llançar una moneda equilibrada és 1/2”, el que significa és que “Si prenem la població formada per tots els possibles llançaments de totes les possibles monedes equilibrades, en la meitat dels seus membres el resultat és Cara.” Els membres d’aquesta població són tots els “possibles” llançaments de monedes equilibrades, els que s’han realitzat al llarg de la història, els que es realitzaran en el futur, i els que es podrien haver realitzat o es podrien realitzar en el futur però en realitat no s’han fet ni es faran mai. 2.3 Variable aleatòria Recordau que una variable aleatòria mesura una característica dels subjectes d’una població. És convenient que adquiriu la disciplina de descriure sempre les variables aleatòries mitjançant una plantilla de l’estil de “Prenem … i mesuram …” perquè us quedi clar quina és la població i què mesurau. A més, afegiu-hi les unitats si és necessari. Per exemple: “Prenem una persona de Mallorca i mesuram la seva alçada (en cm)”. Fixau-vos que aquesta variable aleatòria no és la mateixa que “Prenem una persona de Mallorca i mesuram la seva alçada (en m)” perquè, encara que totes dues mesuren el mateix sobre els mateixos subjectes, els assignen números diferents. I també és diferent de “Prenem una persona de Suècia i mesuram la seva alçada (en cm)” perquè ha canviat la població. En canvi a “Llançam una moneda 3 vegades i comptam les cares” no hi ha cap necessitat d’especificar unitats, tret que volgueu emprar una unitat inesperada (jo què sé, que compteu les cares en fraccions de dotzena). Per a més informació sobre variables aleatòries, consultau la Lliçó 1. 2.4 Mostra En un estudi inferencial, volem deduir (inferir) informació sobre una o diverses variables aleatòries definides sobre una població a partir d’una mostra: La població objectiu, o d’interès és el conjunt de subjectes sobre les quals desitjam obtenir informació. La mostra de la població es el grup de subjectes concrets en els quals mesuram les característiques d’interès, usualment molt petit per comparació amb la població. Una mostra d’una variable aleatòria és el conjunt de valors obtinguts prenent una mostra de la població i mesurant la variable sobre aquests subjectes. Exemple 2.1 Si volem saber si un brou és fat, no ens el bebem tot, perquè ens quedaríem sense brou i ja tant faria si era fat o salat. El que fem és tastar-ne només una cullerada. El brou és la població, la cullarada la mostra. Exemple 2.2 Una sèrie de 10 llançaments d’una moneda equilibrada concreta és una mostra de la població del “possibles llançaments de monedes equilibrades”. Si podem mesurar tots els individus de la població, no ens fa falta emprar estadística inferencial per mirar d’endevinar el que volem saber sobre la població: ho mesuram i per avall. Però el més normal és que no poguem mesurar tots els seus individus de la població. La població pot ser massa gran: per exemple, si volem calcular l’alçada mitjana dels europeus que avui tenen 18 anys, és pràcticament impossible amidar-los tots. Com ja hem comentat, la població pot ser virtual o metafòrica en el sentit que pot contenir membres que en aquest moment ni existeixin: per exemple, si volem saber qualque cosa sobre els diabètics, això hauria d’incloure els passats, que ja són morts, els presents, que n’hi haurà molts que ni saben que ho són, i els futurs, que encara no ho són o per ventura no hagin ni nascut. Pot ser que per obtenir la informació d’un subjecte l’hàgim de sacrificar. En aquest cas, per mesurar tota la població l’hauríem d’exterminar. Pot ser simplement que sigui difícil accedir a tota la població: per exemple, els estudiants de la UIB són relativament pocs, uns 12000, però seria complicat aconseguir amidar-los tots. Exemple 2.3 Vosaltres què sou: una població o una mostra? Doncs depèn: Sou una població quan el que interessa és saber qualque cosa sobre vosaltres i només vosaltres. Sou una mostra si a partir d’informació sobre vosaltres miram d’inferir informació sobre un grup més gran de subjectes: sobre els estudiants de primer curs de Biologia i Bioquímica d’Espanya, o sobre els estudiants de la UIB d’aquest curs, o sobre els joves europeus, o sobre els mamífers bípedes, o… Encara que emprem “mitjana”, “variància”, “quantils”, etc. tant per a variables aleatòries com per a mostres, no heu de confondre-les. Una variable aleatòria representa una característica numèrica dels subjectes d’una població: “Prenem un estudiant de la UIB i mesuram la seva alçada en m.” La mitjana i la variància d’aquesta variable són les de tota la població d’estudiants de la UIB i descriuen propietats de tota la població d’estudiants de la UIB. Una mostra d’una variable aleatòria són els valors de la variable sobre un subconjunt de la població. Mesuram les alçades (en m) de 50 estudiants de la UIB d’aquest curs. La mitjana i la variància d’aquesta mostra són només les d’aquestes 50 alçades, i poden servir per descriure aquest conjunt de 50 alçades o per estimar els valors de la mitjana i la variància de la població d’estudiants de la UIB Quan volguem destacar que una mitjana, una variància etc. són les d’una variable aleatòria sobre tota una població, els qualificarem de poblacionals. 2.5 Mostreig aleatori Com hem dit, en un estudi estadístic inferencial, es pren una mostra d’individus d’una població i s’estimen algunes característiques de la població a partir de les de la mostra. Perquè això tengui sentit, és necessari que la mostra sigui raonablement representativa de la població. Però, és clar, sense conèixer les característiques de la població, no podem saber si una mostra és representativa o no. Per sortir d’aquest atzucac, la solució acceptada és prendre una mostra aleatòria, és a dir, triant els seus subjectes a l’atzar. En fer-ho així: S’eviten preferències en l’elecció, per la qual cosa és més probable que la mostra sigui representativa de la població. Naturalment, això no està garantit: per pura mala sort ens pot sortir una mostra súper rara, és el que té l’atzar. Però almenys hem fet “el que tothom considera que és el que toca” per intentar que sigui representativa. Es poden usar tècniques estadístiques que permetran delimitar errors en l’estimació i la seva probabilitat; per exemple, podrem calcular la probabilitat que la nostra mostra sigui súper rara en algun sentit concret. Per exemple, per tastar el brou, abans de prendre’n una cullarada el remenam bé. D’aquesta manera esperam que les molècules del brou s’organitzin de manera aleatòria dins l’olla i que la cullerada que en prenguem sigui representativa del brou. Específicament, el mostreig aleatori consisteix a seleccionar una mostra de la població de manera que totes les mostres de la mateixa mida siguin equiprobables; és a dir, que si fixam el nombre de subjectes de la mostra, tots els conjunts d’aquest nombre de subjectes tenguin la mateixa probabilitat de ser seleccionats. Hi ha dos tipus bàsics de mostreig aleatori que hem de distingir: amb i sense reposició. Per fixar idees, suposem que disposam d’una població de la qual volem extreure una mostra de mida \\(n\\). Una manera de fer-ho seria repetir \\(n\\) vegades el procés d’escollir un individu de la població, anotar qui és i “retornar-lo a la població”, de manera que pugui tornar a ser escollit dins la mateixa mostra. El tipus de mostra obtenguda d’aquesta manera rep el nom de mostra aleatòria amb reposició, o mostra aleatòria simple. Observau que amb aquest procediment un mateix individu pot aparèixer diverses vegades en una mostra, i que tots els subconjunts “amb possibles repeticions” (el seu nom tècnic és multiconjunts) de \\(n\\) individus de la població tenen la mateixa probabilitat d’obtenir-se. El mostreig aleatori simple és l’estándard d’excel·lència entre els mètodes de mostreig, i gairebé tots els resultats que explicarem en aquest curs pressuposen que la mostra és aleatòria simple. Una altra manera d’extreure la nostra mostra seria repetir \\(n\\) vegades el procés d’escollir un individu de la població, anotar qui és i “retirar-lo de la població”, de manera que ja no pugui tornar a ser escollit dins la mateixa mostra. Això és equivalent a extreure de cop \\(n\\) individus diferents de la població. Aquestes mostres no tenen individus repetits, i qualsevol selecció de \\(n\\) individus diferents té la mateixa probabilitat de ser l’obtinguda. En aquest cas es parla d’una mostra aleatòria sense reposició. Quan la mida de la població és MOLT gran per comparació amb la mostra, com sol ser el cas en ciències de la vida, la probabilitat que hi hagi repeticions en una mostra aleatòria simple és molt petita. Recordau que si una població té \\(N\\) individus, la probabilitat que una mostra aleatòria simple de mida \\(n\\) tingui tots els seus membres diferents és \\[ \\frac{N(N-1)\\cdots (N-n+1)}{N^n} \\] i per tant la probabilitat que tengui qualque membre repetit és \\[ 1-\\frac{N(N-1)\\cdots (N-n+1)}{N^n}. \\] Amb R: La funció pbirthday(n,N) ens dóna la probabilitat que en una mostra aleatòria simple de mida \\(n\\) d’una població de mida \\(N\\) hi hagi algun element repetit. La funció qbirthday(p,N) ens dóna la mida mínima d’una mostra aleatòria simple d’una població de mida \\(N\\) perquè la probabilitat que hi hagi algun element repetit sigui com a mínim \\(p\\). El nom birthday fa referència a la paradoxa de l’aniversari: el típic problema de calcular la probabilitat que dos estudiants d’una classe celebrin l’aniversari el mateix dia i sorprendre’s que en una classe de 50 estudiants hi hagi més d’un 95% de probabilitats que hi hagi algun aniversari repetit. En efecte, podem entendre una classe de 50 estudiants com una mostra aleatòria simple de 50 dates de naixement, triades d’un conjunt de 366 possibles dates (els 366 dies d’un any de traspàs). La probabilitat que almenys 2 estudiants celebrin l’aniversari el mateix dia és la probabilitat que es doni almenys una repetició en aquesta mostra. R ho calcula amb: pbirthday(50,366) ## [1] 0.970073 Quin és el nombre mínim d’estudiants que hi ha d’haver en una classe perquè la probabilitat que es repeteixi una data d’aniversari sigui del 95% o més? Per exemple, si triam 100 individus de les Balears (que tenen al voltant de 1,150,000 habitants) a l’atzar permetent repeticions, la probabilitat que surti qualque individu repetit és pbirthday(100,1150000) ## [1] 0.00429522 Només en 1 de cada 250 mostres de 100 individus de les Balears triats a l’atzar permetent repeticions hi hauria qualque repetició. En canvi, si triam 100 estudiants de la UIB (que té al voltant de 12000 estudiants) a l’atzar permetent repeticions, la probabilitat que surti qualque estudiant repetit és de pbirthday(100,12000) ## [1] 0.338764 En 1 de cada 3 mostres de 100 estudiants de la UIB triats a l’atzar permetent repeticions hi hauria qualque repetició. Però si triam 10 estudiants de la UIB a l’atzar permetent repeticions, la probabilitat que surti qualque estudiant repetit ja és pbirthday(10,12000) ## [1] 0.00374396 Exemple 2.4 El gràfic següent mostra la probabilitat que si prenem una mostra aleatòria simple de \\(n\\) estudiants d’una població de 12000 individus, com ara els estudiants de la UIB, siguin tots diferents, en funció de \\(n\\): f=function(n,N){1-pbirthday(n,N)} prob=sapply(1:300,f,N=12000) plot(1:300, prob, type=&quot;l&quot;, lwd=2, xlab=&quot;n&quot;, ylab=&quot;probabilitat&quot;, xaxp=c(0,300,30),yaxp=c(0,1,10)) El gràfic següent mostra la mida màxima \\(n\\) d’una mostra aleatòria simple extreta d’una població de mida \\(N\\) perquè la probabilitat de repeticions sigui menor que 0.01 (és a dir, perquè més del 99% de les mostres aleatòries simples tenguin tots els seus elements diferents), en funció de \\(N\\): fites=sapply(500+100*(0:150), qbirthday, prob=0.01) plot(500+100*(0:150), fites, pch=20, xlab=&quot;N&quot;, ylab=&quot;n&quot;, cex=0.5, xaxp=c(500,15500,30),yaxp=c(0,20,20)) Així doncs, si la mida de la població és molt gran en relació a la de la mostra, és molt probable que els elements d’una mostra aleatòria simple siguin tots diferents. Això implica que, quan la població és molt gran en relació a la mostra, els mostrejos aleatoris amb i sense reposició són aproximadament equivalents en el sentit següent: com que, si la població és molt, molt gran, un mostreig amb reposició donaria gairebé segur una mostra amb tots els seus elements diferents, podem prendre directament la mostra sense reposició i suposar que permetíem repeticions, però que no s’han donat, i que per tant la mostra és simple. Una mostra aleatòria de 100 individus diferents de les Balears, o de 10 estudiants diferents de la UIB, pot passar perfectament per una mostra presa permetent repeticions, perquè encara que les permetéssim, només obtendríem qualque repetició en 1 de cada 250 vegades. Però en canvi ja és més mal de creure que una mostra aleatòria de 100 estudiants diferents de la UIB hagi estat presa permetent repeticions, perquè si les permetem, en 1 de cada 3 vegades surt qualcú repetit. A més, si la mida de la població és molt més gran que \\(n\\), quan construïu una mostra aleatòria de mida \\(n\\) escollint els individus un a un a l’atzar sense repeticions, la probabilitat a cada moment d’escollir un individu concret dels que quedin és gairebé la mateixa que si permetéssiu repeticions. Exemple 2.5 Imaginau que teniu una població de 106 individus i en voleu extreure una mostra aleatòria de 10. Llavors, per exemple, quan ja portau 9 individus escollits, la probabilitat de triar un individu concret dels que queden és 1/999991=10-6+9·10-12, mentre que si permeteu que surti qualcun dels ja escollits és 1/106=10-6. En resum: Si prenem una mostra aleatòria sense reposició de mida \\(n\\) d’una població de mida \\(N\\) MOLT més gran que n, la tractarem com si fos una mostra aleatòria simple (i direm sense manies que és una mostra aleatòria simple). Per fixar una fita, en aquest curs entendrem que \\(N\\) és prou MOLT més gran que \\(n\\) com per poder aplicar aquesta regla quan \\(N\\) és com a mínim unes 1000 vegades més gran que \\(n\\). Hi ha un tipus de mostreig aleatori que caldrà tenir present més endavant i volem esmentar ara. Es tracta del mostreig aleatori estratificat. S’utilitza quan la població està classificada en estrats que són d’interès per a la propietat estudiada. Aquests estrats seran grups d’individus definits per una característica concreta, de manera que individus del mateix estrat tenguin aquesta característica en comú i individus d’estrats diferents tenguin aquesta característica diferent. Per exemple: sexes, franges d’edat, províncies… En aquest cas, es pren una mostra aleatòria (amb o sense repetició) d’una mida prefixada de cada estrat i s’uneixen en una mostra global: el resultat és una mostra aleatòria (amb repetició o sense) estratificada. Pel que fa a les mides de les mostres de cada estrat, se sol optar per una de les dues estratègies següents: Imposar que la composició per estrats de la mostra global mantengui les proporcions de la població original, de manera que la mida de la mostra de cada estrat representi el mateix percentatge del total de la mostra que l’estrat corresponent en la població completa. Prendre les mides de manera que els estrats que representin una fracció molt petita de la població (tan petita que no esperaríem que tenguessin representació en una mostra aleatòria transversal de la població, és a dir, presa del total de la població sense tenir en compte la seva composició en estrats) tenguin una representació en la mostra molt més gran que la que els tocaria. Per exemple, els estrats podrien ser grups d’edat i podríem prendre la mostra de cada grup d’edat de mida proporcional a la fracció que representa aquest grup d’edat en la població total. O podrien ser els sexes i procuraríem que la nostra mostra estigués formada per un 50% d’homes i un 50% de dones. O, a les Illes Balears, els estrats podrien ser les illes, i llavors podríem imposar que el nombre de representants de cada illa en la mostra fos proporcional a la seva població relativa dins del conjunt total de la comunitat autònoma, o podríem triar la mateixa quantitat d’individus de cada illa, independentment de la seva població. L’avantatge del mostreig aleatori estratificat respecte del transversal és que, com que l’investigador pren una mostra de cada estrat de la mida que desitja: Permet estimar la informació d’interès per a cada estrat per separat, com si es tractàs d’estudis independents. Permet estimar la informació sobre subpoblaciones minoritàries que en una mostra aleatòria transversal apareixerien subrepresentades. L’inconvenient és que, òbviament, si preneu una mostra amb nombres prefixats i artificials de subjectes de cada estrat, amb aquesta mostra no podeu estimar la proporció de subjectes de cada estrat dins el total de la població. El que volem dir és que si, per exemple, construïu una mostra escollint a l’atzar 100 mallorquins, 100 menorquins i 100 pitiüsos, no la podeu emprar per estimar la proporció de mallorquins en el total de la població de les Balears. Gairebé mai és factible efectuar un mostreig aleatori. El motiu és que, per poder prendre una mostra aleatòria d’una població en el sentit d’aquest apartat, amb o sense reposició, és necessari disposar d’una llista completa de tots els seus individus per poder sortejar a qui seleccionarem. Això sol ser impossible, o almenys difícil d’aconseguir. Algú té la llista completa de, per exemple, tots els diabètics d’Espanya? Que inclogui els que no saben que ho són? Per tant, gairebe mai no podrem prendre mostres aleatòries en aquest sentit. Tenim una població classificada en dos estrats, A i B. La subpoblació A representa un 20% de la població i la B el 80% restant. Hem pres una mostra aleatòria estratificada formada per 100 subjectes de cada subpoblació. Hem mesurat una certa característica X d’aquests subjectes. La mitjana dels valors de X dels subjectes d’A ha donat 5 i la mitjana dels valors de X dels subjectes de B ha donat 10. (a) Què val la mitjana dels valors de X de tota la mostra de 200 subjectes? (b) A partir d’aquestes dades, què estimau que val la mitjana de X en el total de la població? Trobareu més tipus de tècniques de mostreig aleatori i les funcions de R relacionades amb mostrejos a la lliçó sobre mostreig del manual de R. 2.6 Mostres de conveniència Malgrat tots els resultats que donarem seran per a mostres aleatòries, a la vida real les mostres gairebé mai no ho són, aleatòries: gairebé sempre ens hem de conformar amb els subjectes disponibles, que formen una mostra de conveniència. Per exemple, en la UIB, per estimar l’opinió que d’un professor tenen els alumnes d’una classe, només es té en compte les respostes dels estudiants que voluntàriament emplenen l’enquesta d’opinió, que de cap manera formen una mostra aleatòria: el perfil de l’estudiant que contesta voluntàriament una enquesta d’aquest tipus és molt específic i no ve determinat per l’atzar. En aquest cas es tractaria d’una mostra auto-seleccionada. Un altre tipus de mostres no aleatòries són les oportunistes. Aquest és el cas, per exemple, si per estimar l’opinió que d’un professor tenen els alumnes d’una assignatura es visita un dia la classe i es passa l’enquesta als estudiants que aquest dia van assistir a classe. De nou, pot ser que els alumnes presents no siguin representatius de l’alumnat de l’assignatura (poden ser els més aplicats, o els que no tenen el grip, o els no repetidors). Les tècniques d’estadística inferencial no es poden aplicar a mostres no aleatòries. Però normalment només podem aconseguir mostres no aleatòries. En aquest cas, el que s’ha de fer és descriure detalladament les característiques de la mostra per justificar que, malgrat no ser aleatòria, és raonablement representativa de la població i podria passar per aleatòria. Exemple 2.6 No perquè sigui oportunista una mostra deixa forçosament de ser vàlida. El nostre exemple preferit és el d’Abraham Wald i els forats que faltaven. Figura 2.1: Abraham Wald. Durant la Segona Guerra Mundial es va fer palesa la necessitat de reforçar el blindatge dels bombarders aliats, però un blindatge excessiu augmentaria el pes del bombarder i faria que consumís més carburant i perdés autonomia de vol o fins i tot que no pogués enlairar-se. Per tant calia blindar només les parts més delicades de l’avió. El problema es passà llavors al Statistical Research Group (SRG), un grup “secret” d’estadístics que assessorava els militars nordamericans i que molts historiadors comparen amb el projecte Manhattan (només que produïen equacions, i no bombes). Els militars els passaren gràfics dels bombarders que tornaven de missions per Europa amb les marques dels forats de bala que duien. Aquests impactes no estaven uniformement distribuïts pel fuselatge, com podeu veure a l’exemple de la Figura 2.2 que recull els forats d’alguns avions que tornaren d’una missió concreta. La idea dels militars era reforçar les zones més castigades, i el que volien que el SRG els calculàs era quant reforç havien d’afegir a cada zona. Figura 2.2: Diagrama dels impactes de projectil sobre el fuselatge d’un bombarder en tornar d’una missió. La resposta d’Abraham Wald, un dels estadístics més brillants del SRG, va ser “Gentlemen, you need to add armor-plate where the holes aren’t, because that’s where the holes were on the airplanes that didn’t return” Vaja, que no havien de reforçar les zones amb més impactes: havien de reforçar les zones amb molt pocs impactes. El seu raonament era que els avions rebien els impactes distribuïts de manera uniforme per tot el seu fuselatge. Si els avions que tornaven sans i estalvis eren els que no tenien impactes a determinades zones, o n’hi tenien molt pocs, era perquè els avions que rebien molt càstig en aquestes zones no havien tornat. En canvi, els impactes a les zones que mostraven més càstig no impedien que l’avió tornàs. Naturalment, tot això justificat amb un càlcul molt enginyós de la probabilitat que un avió fos derribat en funció del nombre d’impactes de bala rebuts a les diferents zones del fuselatge: enginyós, perquè només podia emprar la informació dels avions que no havien estat derribats. Si us interessen les butzes matemàtiques del seu treball, les trobareu en aquest article. El que us volem vendre és que la mostra d’avions era oportunista: els que retornaven de les seves missions. Però fins i tot d’aquesta mostra es pogué obtenir informació amb les tècniques adients. 2.7 Test de la lliçó 2 (1) Què sou vosaltres? Marcau l’única resposta correcta. Una mostra aleatòria simple dels estudiants de 1r curs d’algun grau de ciències d’Espanya. Una mostra aleatòria sense reposició dels estudiants de 1r curs d’algun grau de ciències d’Espanya. Una mostra de conveniència dels estudiants de 1r curs d’algun grau de ciències d’Espanya. Cap de les altres respostes és correcta. (2) Quan diem que una mostra aleatòria d’una població és simple? Marcau una sola resposta. Quan la prenem de cop. Quan és l’única mostra aleatòria que prenem. Quan la prenem de manera que els subjectes no es poden repetir. Quan la prenem de manera que els subjectes es poden repetir. Quan no conté subjectes repetits (encara que l’hàgim pres de manera que es puguin repetir). Cap de les altres respostes és correcta. (3) En termes estadístics, una població (marcau totes les respostes correctes): Està formada només per persones Pot ser finita Pot ser infinita Pot ser qualsevol conjunt de coses en les quals estiguem interessats Pot estar formada per coses que no existeixin Les altres respostes són totes falses (4) En un mostreig aleatori simple (marcau totes les respostes correctes): Cada membre de la població té la mateixa probabilitat de ser triat Els membres adjacents de la població no han de ser triats No es pot estimar la probabilitat que la mostra triada sigui molt diferent del típic en la població Cada mostra possible d’una grandària donada té la mateixa probabilitat de ser triada La decisió d’incloure o no un individu en una mostra depèn només de les característiques de l’individu Les altres respostes són totes falses (5) Els avantatges del mostreig aleatori inclouen (marcau totes les respostes correctes): Que es pot aplicar a qualsevol població Que permet estimar la probabilitat que la mostra triada sigui molt diferent del típic en la població Que no hi ha cap subpoblació els subjectes de la qual tenguin major probabilitat de ser triats Que és fàcil de dur a terme Que garanteix que la mostra triada serà representativa de la població original Les altres respostes són totes falses (6) En un estudi sobre pacients d’hospitals, 20 hospitals diferents van ser triats a l’atzar d’una llista de tots els hospitals d’un país. A continuació, en cadascun d’aquests 20 hospitals, es va triar a l’atzar un 10% dels pacients hospitalitzats en un dia concret. Quina, o quines, de les afirmacions següents són vertaderes en aquesta situació? Tots els hospitals tenen la mateixa probabilitat de ser triats Tots els pacients hospitalitzats aquest dia tenien la mateixa probabilitat de ser triats Totes les possibles mostres de pacients hospitalitzats aquest dia tenien la mateixa probabilitat de ser triades La mostra de pacients és estratificada Les altres respostes són totes falses (7) En un estudi sobre pacients d’hospitals, 20 hospitals diferents van ser triats a l’atzar d’una llista de tots els hospitals d’un país. A continuació, en cadascun d’aquests 20 hospitals, es va triar a l’atzar 10 pacients diferents d’entre els hospitalitzats en un dia concret. Quina, o quines, de les afirmacions següents són vertaderes en aquesta situació? Tots els hospitals tenen la mateixa probabilitat de ser triats Tots els pacients hospitalitzats aquest dia tenien la mateixa probabilitat de ser triats des del principi Totes les possibles mostres de 200 pacients hospitalitzats aquest dia tenien la mateixa probabilitat de ser triades La mostra de pacients és estratificada Les altres respostes són totes falses "],
["estimació-puntual.html", "Tema 3 Estimació puntual 3.1 Definicions bàsiques 3.2 Mitjana mostral 3.3 Proporció mostral 3.4 Variància mostral 3.5 La distribució t de Student 3.6 “Bons” estimadors 3.7 Estimació de poblacions 3.8 Test de la lliçó 3", " Tema 3 Estimació puntual L’objectiu principal de la inferència estadística és obtenir informació sobre tota una població a partir de només una mostra, com quan volem saber si un brou és fat o salat tastant-ne només una cullerada. El primer tipus d’informació que ens sol interessar és què val qualque paràmetre d’alguna variable aleatòria poblacional (una proporció, una mitjana…), per exemple per poder escriure un titular com el següent: Figura 3.1: https://www.efesalud.com/miopia-estudio-universitarios Aquest 60% no s’ha obtingut fent passar a tots els universitaris espanyols un test de miopia, ni tan sols demanant-los a tots si són miops o no, sinó que simplement s’ha pres una mostra d’universitaris, s’hi ha observat un 60% de miops i s’ha extrapolat aquesta proporció a tot el col·lectiu d’universitaris espanyols. El procés d’intentar endevinar el valor d’un paràmetre d’una població a partir d’una mostra se’n diu estimació puntual, i és el que tractarem en aquest tema. Al tema següent ens centrarem en intentar endevinar el valor d’un paràmetre amb un cert marge d’error i de seguretat. En aquest curs, sempre suposarem que empram mostres aleatòries i gairebé sempre que aquestes mostres aleatòries són a més simples. Per tant, si no diem el contrari, d’ara endavant quan parlem de mostres sempre suposarem que són mostres aleatòries simples, encara que no ho diguem explícitament per no carregar massa el text. 3.1 Definicions bàsiques Per estimar el valor d’un paràmetre d’una variable aleatòria poblacional, en prenem una mostra (aleatòria simple) i calculam qualque cosa amb els valors que la formen. Què calculam? Doncs un estimador: alguna funció adequada aplicada als valors de la mostra, i que dependrà del que volguem estimar. Figura 3.2: Població versus mostra Per exemple: Si volem estimar l’alçada mitjana dels estudiants de la UIB, prendrem una mostra d’estudiants de la UIB, els amidarem i calcularem la mitjana aritmètica de les seves alçades. Si volem estimar la proporció d’estudiants de la UIB que han passat la COVID-19, prendrem una mostra d’estudiants de la UIB, els farem un test d’anticossos i calcularem la proporció mostral de positius en la mostra. Formalment: Tenim una variable aleatòria poblacional \\(X\\), definida sobre una població. Una mostra aleatòria simple de mida \\(n\\) de \\(X\\) és un vector \\((X_1,\\ldots,X_n)\\) format per \\(n\\) còpies independents de \\(X\\). Cada variable \\(X_i\\) és una còpia de “Prenem un subjecte de la població i hi mesuram \\(X\\)”. Una realització de la mostra aleatòria simple \\(X_1,\\ldots,X_n\\) és un vector \\((x_1,\\ldots,x_n)\\in \\mathbb{R}^n\\) de valors presos per aquestes variables aleatòries. És a dir, amb \\((X_1,\\ldots,X_n)\\) repetim \\(n\\) vegades (independents les unes de les altres) el procés de prendre un subjecte de la població i mesurar-hi \\(X\\). Cada vegada que ho fem, obtenim un conjunt de números, al que formalment diem una realització de la mostra. A la lliçó anterior a aquestes realitzacions les déiem directament “mostres aleatòries simples de valors de \\(X\\)”; no passeu ànsia, en sortir d’aquest “formalment” els hi tornarem a dir. Un estimador és una variable aleatòria \\(f(X_1,\\ldots,X_n)\\) obtinguda aplicant una funció \\(f\\) a una mostra aleatòria simple \\((X_1,\\ldots,X_n)\\). Aquest estimador s’aplica a les realitzacions de la mostra i dóna nombres reals. Un estimador és una variable aleatòria, definida sobre la població formada per les mostres aleatòries simples de la població de partida. Per tant, té funció de densitat, funció de distribució (que genèricament anomenarem distribució mostral, per indicar que refereix a la probabilitat que li passi qualque cosa al valor del estimador sobre una mostra), esperança, desviació típica, etc. Com ja us hem dit, i com que no hi ha necessitat de filar tan prim, d’ara endavant cometrem l’abús de llenguatge de dir mostra aleatòria simple tant al vector de variables aleatòries \\((X_1,\\ldots,X_n)\\) com a una realització \\((x_1,\\ldots,x_n)\\); i hi ometrem els parèntesis. Com ja hem comentat a la Secció 2.5, si la mida \\(N\\) de la població és MOLT més gran que la mida \\(n\\) de la mostra (per fixar idees, si \\(N\\geq 1000n\\)), els resultats per a mostres aleatòries simples valen (aproximadament) per a mostres aleatòries sense reposició, perquè les variables aleatòries que formen la mostra sense reposició són gairebé idèntiques i independents i les repeticions són improbables. Els estimadors tenen sempre sentit per a mostres en general, però gairebé tots els teoremes que estableixen les seves propietats són vertaders només sota determinades restriccions (mostra aleatòria simple, condicions extra sobre \\(X\\), …), per la qual cosa les seves conseqüències tan sols són segures sota aquestes restriccions. 3.2 Mitjana mostral Quan volem estimar el valor mitjà d’una variable sobre una població, en prenem una mostra de valors i calculam la seva mitjana aritmètica, no és ver? Doncs això és la mitjana mostral. Donada una variable aleatòria \\(X\\), diem mitjana mostral de (mostres de) mida \\(n\\) a la variable aleatòria \\(\\overline{X}\\) “Prenem una mostra aleatòria simple de mida \\(n\\) de \\(X\\) i calculam la mitjana aritmètica dels seus valors”. És a dir, formalment, la mitjana mostral de mida \\(n\\) de \\(X\\) és la variable aleatòria obtinguda prenent \\(n\\) còpies independents \\(X_1,\\ldots,X_n\\) de la variable aleatòria \\(X\\) i calculant \\[ \\overline{X}=\\frac{X_1+\\cdots+X_n}{n} \\] Fixau-vos que definim la mitjana mostral només per a mostres aleatòries simples. Naturalment, té sentit definir-la per a mostres qualssevol, però llavors la seva distribució mostral deixaria de complir les propietats que donem en aquesta secció. El mateix advertiment val per als estimadors que definim en les pròximes seccions. Com a conseqüència del comportament d’esperances i variàncies de combinacions lineals, tenim el següent resultat: Teorema 3.1 Siguin \\(X\\) una variable aleatòria d’esperança \\(\\mu_X\\) i desviació típica \\(\\sigma_X\\), \\(X_1,\\ldots,X_n\\) una mostra aleatòria de \\(X\\) i \\(\\overline{X}\\) la seva mitjana mostral. Aleshores El valor esperat de \\(\\overline{X}\\) és \\(\\mu_{\\overline{X}}=\\mu_X\\). Si la mostra aleatòria és simple, la desviació típica de \\(\\overline{X}\\) és \\(\\sigma_{\\overline{X}}={\\sigma_X}/{\\sqrt{n}}\\). En efecte, com que \\[ \\overline{X}=\\frac{1}{n}X_1+\\cdots +\\frac{1}{n}X_n \\] i les variables \\(X_1,\\ldots,X_n\\) són còpies de \\(X\\), i per tant tenen totes esperança \\(\\mu_X\\) i variància \\(\\sigma^2_X\\), tenim que \\[ \\mu_{\\overline{X}}=\\overbrace{\\frac{1}{n}\\mu_X+\\cdots +\\frac{1}{n}\\mu_X}^n=\\mu_X \\] i, si \\(X_1,\\ldots,X_n\\) són independents, \\[ \\sigma_{\\overline{X}}=\\sqrt{\\overbrace{\\frac{1}{n^2}\\sigma^2_X+\\cdots+ \\frac{1}{n^2}\\sigma^2_X}^n}=\\sqrt{\\frac{n}{n^2}\\sigma^2_X}=\\frac{\\sigma_X}{\\sqrt{n}} \\] Per tant: \\(\\overline{X}\\) és un estimador puntual de \\(\\mu_X\\). \\(\\mu_{\\overline{X}}=\\mu_X\\) (), la qual cosa significa que: La mitjana de les mitjanes mostrals de totes les mostres de mida \\(n\\) de \\(X\\) torna a ser la mitjana de \\(X\\). Esperam que la mitjana mostral doni, de mitjana, \\(\\mu_X\\): si repetíssim moltes vegades el procés de prendre una mostra aleatòria simple de mida \\(n\\) i calcular-ne la mitjana mostral, molt probablement el valor mitjà d’aquestes mitjanes s’acostaria molt a \\(\\mu_X\\). \\(\\sigma_{\\overline{X}}= \\sigma_X/\\sqrt{n}\\) indica que la dispersió dels resultats de \\(\\overline{X}\\) creix amb la variabilitat de \\(X\\) i decreix amb la mida \\(n\\) de la mostra, tendint a 0 quan \\(n\\to\\infty\\). A la desviació típica de \\(\\overline{X}\\) li diem l’error estàndard, o típic, de \\(\\overline{X}\\). Exemple 3.1 El fitxer tests.txt que trobareu a l’url https://raw.githubusercontent.com/AprendeR-UIB/MatesII/master/Dades/tests.txt conté les notes (sobre 100) de tests dels estudiants de Matemàtiques I de fa uns cursos. El guardam en un vector anomenat tests: tests=scan(&quot;https://raw.githubusercontent.com/AprendeR-UIB/MatesII/master/Dades/tests.txt&quot;) head(tests) ## [1] 70 44 90 64 76 68 la mida de la població és N=length(tests) N ## [1] 185 La seva mitjana, que és la mitjana poblacional, és mu=mean(tests) mu ## [1] 55.4324 Si en prenem una mostra aleatòria simple, per exemple de mida \\(n=40\\), la seva mitjana mostral no té per què coincidir amb la mitjana poblacional: n=40 MAS=sample(tests,n,replace=TRUE) # Una mostra aelatòria simple x.barra=mean(MAS) # La mitjana mostral x.barra ## [1] 53.5 Però si prenem moltes mostres aleatòries simples, la mitjana de les seves mitjanes és molt probable que sí que s’acosti a la mitjana poblacional. Vegem si tenim sort: mitjanes=replicate(10^5,mean(sample(tests,n,replace=TRUE))) mean(mitjanes) ## [1] 55.4187 Vegem ara que la desviació típica d’aquesta mostra de mitjanes s’acosta a l’error típic de la mitjana mostral, no a la desviació típica de la població: La desviació típica poblacional: sigma=sd(tests) sigma ## [1] 21.4404 La desviació típica de la mostra de mitjanes: sd(mitjanes) ## [1] 3.38468 L’error típic de la mitjana mostral: sigma/sqrt(n) ## [1] 3.39003 Recordau del Teorema 1.6 que una combinació lineal de variables aleatòries normals independents torna a ser normal. Com que la mitjana mostral d’una mostra aleatòria simple és una combinació lineal de variables aleatòries independents, obtenim el resultat següent: Teorema 3.2 Siguin \\(X\\) una variable aleatòria normal \\(N(\\mu_X,\\sigma_X)\\) i \\(X_1,\\ldots, X_n\\) una mostra aleatòria simple de \\(X\\). Aleshores, la seva mitjana mostral \\(\\overline{X}\\) és normal, i en concret \\[ \\overline{X}\\sim N\\Big(\\mu_X,\\frac{\\sigma_X}{\\sqrt{n}}\\Big). \\] El teorema següent diu que la conclusió del teorema anterior és aproximadament vertadera si la mida \\(n\\) de les mostres aleatòries simples és gran: Teorema 3.3 (Teorema Central del Límit) Siguin \\(X\\) una variable aleatòria qualsevol d’esperança \\(\\mu_X\\) i desviació típica \\(\\sigma_X\\) i \\(X_1,\\ldots, X_n\\) una mostra aleatòria simple de \\(X\\). Quan \\(n\\to \\infty\\), la distribució de probabilitats de la seva mitjana mostral \\(\\overline{X}\\) tendeix a la d’una variable normal \\[ N\\Big(\\mu_X,\\frac{\\sigma_X}{\\sqrt{n}}\\Big). \\] Com us podeu imaginar, quan un resultat l’anomenen Teorema Central de qualque cosa és perquè és molt important. Normalment aplicarem el Teorema Central del Límit de la manera següent: Siguin \\(X\\) una variable aleatòria qualsevol d’esperança \\(\\mu_X\\) i desviació típica \\(\\sigma_X\\) i \\(X_1,\\ldots, X_n\\) una mostra aleatòria simple de \\(X\\). Si la mida \\(n\\) de la mostra és gran, la seva mitjana mostral \\(\\overline{X}\\) és aproximadament normal \\(N(\\mu_X,\\sigma_X/\\sqrt{n})\\). En aquest curs, entendrem que \\(n\\) és prou gran com per poder aplicar aquest “resultat” si és més gran o igual que 30, potser menys com més se sembli \\(X\\) a una normal i potser més si la \\(X\\) és molt diferent d’una normal. A partir d’ara, sovint cometrem l’abús de llenguatge d’ometre l’adverbi “aproximadament” de l’expressió anterior, i direm simplement que si \\(n\\) és gran, \\(\\overline{X}\\) és normal. Però heu de tenir present que aquest “és normal” en realitat vol dir “la seva distribució és aproximadament la d’una variable normal”. Exemple 3.2 Suposem que tenim una variable aleatòria \\(X\\) de mitjana poblacional \\(\\mu_X=3\\) i desviació típica poblacional \\(\\sigma_X=0.2\\) i que en prenem mostres aleatòries simples de mida 100. Pel Teorema Central del Límit, la distribució de la mitjana mostral \\(\\overline{X}\\) és \\[ N\\Big(3,\\frac{0.2}{\\sqrt{100}}\\Big)=N(3,0.02) \\] Exemple 3.3 Tornem a la situació de l’Exemple 3.1. Teníem les notes guardades en un vector anomenat tests. Amb l’histograma següent podem veure que aquestes notes no tenen pinta de seguir una distribució normal. fact.trans=hist(tests,plot=FALSE)$counts[1]/hist(tests,plot=FALSE)$density[1] hist(tests,col=&quot;light blue&quot;,xlab=&quot;Notes dels tests&quot;, ylab=&quot;Freqüències&quot;,main=&quot;Histograma de notes de tests&quot;) curve(fact.trans*dnorm(x,mean(tests),sd(tests)),col=&quot;red&quot;,lwd=2,add=TRUE) A l’Exemple 3.1 també hem construit un vector anomenat mitjanes format per 105 mitjanes mostrals de mostres aleatòries simples de notes de mida 40. Pel Teorema Central del Límit, aquestes mitjanes mostrals haurien de seguir aproximadament una distribució normal, malgrat que la “població original” (les notes dels tests) no sigui normal. Vegem-ho amb un histograma, on hem afegit la densitat de la normal \\(N(\\mu_X,\\sigma_X/\\sqrt{n})\\) predita pel Teorema Central del Límit. fact.trans.m=hist(mitjanes,plot=FALSE)$counts[1]/hist(mitjanes,plot=FALSE)$density[1] hist(mitjanes,col=&quot;light blue&quot;,xlab=&quot;Mitjanes&quot;, ylab=&quot;Freqüències&quot;,main=&quot;Histograma de la mostra de mitjanes&quot;) curve(fact.trans.m*dnorm(x,mu,sigma/sqrt(n)),col=&quot;red&quot;,lwd=2,add=TRUE) L’exemple següent és un tipus de pregunta que més endavant ens preocuparà molt. Exemple 3.4 L’alçada d’una espècie de matolls té valor mitjà 115 cm, amb una desviació típica de 25 cm. Si prenem una mostra aleatòria simple de 100 matolls d’aquesta espècie, quina és la probabilitat que la mitjana mostral de les alçades sigui més petita que 110 cm? Diguem \\(X\\) a la variable aleatòria definida per les alçades d’aquests matolls. Pel Teorema Central del Límit, la mitjana mostral \\(\\overline{X}\\) de mostres aleatòries simples de 100 alçades segueix una distribució \\(N(115,25/\\sqrt{100})=N(115,2.5)\\). Llavors, la probabilitat que ens demanen és \\[ P(\\overline{X}&lt; 110) \\] que podem calcular amb round(pnorm(110,115,2.5),4) ## [1] 0.0228 Un 2.28% de les mostra aleatòries simples de 100 matolls d’aquesta espècie tenen la mitjana de les alçades més petita que 110 cm. 3.3 Proporció mostral Suposem que ara tenim una variable aleatòria poblacional \\(X\\) que és Bernoulli amb probabilitat d’èxit \\(p_X\\). \\(X\\) pren els valors 1 (èxit) o 0 (fracàs). Recordau que \\(E(X)=p_X\\) i \\(\\sigma_X=\\sqrt{p_X(1-p_X)}\\). Sigui \\(X_1,\\ldots,X_n\\) una mostra aleatòria simple de mida \\(n\\) de \\(X\\) i sigui \\(S_n=\\sum_{i=1}^n X_i\\) el nombre d’èxits observats en aquesta mostra. La proporció mostral d’èxits de la nostra mostra és \\[ \\widehat{p}_X=\\frac{S_n}{n}=\\frac{\\sum_{i=1}^n X_i}{n}. \\] Recordau que si prenem mostres aleatòries simples, \\(S_n\\) és una variable aleatòria binomial \\(B(n,p_X)\\). Però és un doi dir que la proporció mostral \\(\\widehat{p}_X\\) és una variable aleatòria binomial, ni que només sigui perquè les variables aleatòries binomials prenen valors nombres naturals i els valors que pot prendre \\(\\widehat{p}_X\\) són fraccions entre 0 i 1. Fixau-vos que \\(\\widehat{p}_X\\) és un cas particular de la mitjana mostral \\(\\overline{X}\\), per tant per a les proporcion mostrals val tot el que hem dit fins ara per a mitjanes mostrals: Teorema 3.4 Si \\(X\\) és una variable aleatòria Bernoulli amb probabilitat d’èxit \\(p_X\\) i \\(X_1,\\ldots,X_n\\) és una mostra aleatòria de mida \\(n\\) de \\(X\\), de proporció mostral \\(\\widehat{p}_X\\), aleshores \\(\\mu_{\\widehat{p}_X}=p_X\\) \\(\\sigma_{\\widehat{p}_X}=\\sqrt{\\dfrac{p_X(1-p_X)}{n}}\\) Pel Teorema Central del Límit, si la mida \\(n\\) de la mostra és gran, la distribució de \\(\\widehat{p}_X\\) és aproximadament la d’una variable normal \\[ N\\left({p}_X,\\sqrt{\\frac{{p}_X(1-{p}_X)}{n}}\\right) \\] i per tant \\[ \\frac{\\widehat{p}_X-p_X}{\\sqrt{\\frac{{p}_X(1-{p}_X)}{n}}} \\] és aproximadament \\(N(0,1)\\). Alguns comentaris: \\(\\mu_{\\widehat{p}_X}=p_X\\): Si repetíssim moltes vegades el procés de prendre una mostra aleatòria simple de mida \\(n\\) d’una variable aleatòria de Bernoulli \\(X\\) i calcular-ne la proporció mostral d’èxits, molt probablement la mitjana d’aquestes proporcions mostrals s’acostaria molt a \\(p_X\\) En particular, \\(\\widehat{p}_X\\) serveix per estimar \\(p_X\\) \\(\\sigma_{\\widehat{p}_X}= \\sqrt{{p_X(1-p_X)}/{n}}\\): la variabilitat dels resultats de \\(\\widehat{p}_X\\) decreix amb \\(n\\) i tendeix a 0 quan \\(n\\to \\infty\\). Pel que fa a la dependència de \\(\\sigma_{\\widehat{p}_X}\\) respecte de \\(p_X\\) si la \\(n\\) és fixada, observau al gràfic següent que \\(\\sqrt{p_X(1-p_X)}\\) creix entre 0 i 0.5 i decreix entre 0.5 i 1, assolint el valor màxim a \\(p_X=0.5\\). curve(sqrt(x*(1-x)),xlab=&quot;p&quot;,ylab=&quot;sqrt(p*(1-p))&quot;,lwd=2) \\(\\sqrt{{p_X(1-p_X)}/{n}}\\) és l’error estándard, o típic, de \\(\\widehat{p}_X\\). L’estimam amb l’error estándard, o típic, de la mostra \\(\\sqrt{{\\widehat{p}_X(1-\\widehat{p}_X)}/{n}}\\). A partir d’ara, sovint cometrem l’abús de llenguatge d’ometre l’adverbi “aproximadament” de l’apartat (3) del teorema anterior, i direm simplement que si \\(n\\) és gran, \\(\\widehat{p}_X\\) és normal. Però, repetim, hem de recordar que aquest “és normal” en realitat vol dir “la seva distribució és aproximadament la d’una variable normal”. Exemple 3.5 Tornem una altra vegada a la situació dels Exemples 3.1 i 3.3. Traduïm el fitxer de notes de tests en un vector binari: 0 per suspens (haver tret menys de 50) i 1 per aprovat (haver tret 50 o més): # Iniciam totes les notes a 1 aprovs=rep(1,length(tests)) # Posam 0 on la nota del test és suspesa aprovs[which(tests&lt;50)]=0 Aquest vector aprovs el podem entendre com una població de Bernoulli de probabilitat poblacional d’èxit (aprovat) \\(p_X\\). Les proporcions de suspesos i aprovats són: round(prop.table(table(aprovs)),4) ## aprovs ## 0 1 ## 0.4054 0.5946 Per tant, \\(p_X\\) és: p_X=as.numeric(prop.table(table(aprovs))[2]) round(p_X,4) ## [1] 0.5946 Ara n’extreurem 105 mostres aleatòries simples de mida 40, en calcularem les proporcions mostrals d’aprovats i comprovarem si es confirmen les conclusions del teorema anterior. set.seed(100) props.mostrals=replicate(10^5,mean(sample(aprovs,40,rep=TRUE))) La mitjana d’aquest vector de proporcions hauria de ser propera a la proporció poblacional d’aprovats \\(p_X=0.5946\\). round(mean(props.mostrals),4) ## [1] 0.5942 Vegem ara la seva desviació típica: round(sd(props.mostrals),4) ## [1] 0.0774 Pel Teorema 3.4, sabem que això hauria de ser proper a \\(\\sqrt{p_X(1-p_X)/n}\\) round(sqrt(p_X*(1-p_X)/40),4) ## [1] 0.0776 I pel Teorema Central del Límit, aquestes proporcions mostrals haurien de seguir aproximadament una distribució normal $N(p_X,). Vegem-ho amb un histograma: fact.trans.p=hist(props.mostrals,plot=FALSE)$counts[1]/hist(props.mostrals,plot=FALSE)$density[1] hist(props.mostrals,col=&quot;light blue&quot;,xlab=&quot;Proporcions mostrals&quot;, ylab=&quot;Freqüències&quot;,main=&quot;Histograma de la mostra de proporcions&quot;) curve(fact.trans.p*dnorm(x,p_X,sqrt(p_X*(1-p_X)/40)), col=&quot;red&quot;,lwd=2,add=TRUE) I això que la mida de les mostres, 40, no és especialment gran. Exemple 3.6 Un 59.1% dels estudiants de la UIB són dones. Hem pres una mostra més o menys aleatòria de 60 estudiants de la UIB i hi hem trobat 40 dones, un 66.67%. Ens demanam si 40 de 60 és una quantitat raonable de dones en una mostra aleatòria simple d’estudiants de la UIB, o si són moltes (atès que hi esperaríem al voltant d’un 59% de dones). Aquesta pregunta, que serà molt típica d’aquí a pocs temes, la traduïm en la següent pregunta: Si prenem una mostra aleatòria simple de 60 estudiants, quina és la probabilitat que la proporció mostral de dones sigui superior al 66.67%? La manera més correcta de resoldre respondre aquesta qüestió és emprar que el nombre \\(S_{60}\\) de dones en mostres aleatòries simples de 60 estudiants de la UIB segueix de manera exacta una distribució binomial \\(B(60,0.591)\\). Com que el 66.67% de la pregunta en realitat representa 40 dones, la probabilitat demanada és exactament round(1-pbinom(39,60,0.591),4) ## [1] 0.1441 Recordau que si \\(X\\) és una variable aleatòria discreta que pren valors enters, com ara la binomial, \\(P(X\\geq 40)=1-P(X\\leq 39)\\). Això ens diu que, de mitjana, 1 de cada 7 mostres aleatòries simples de 60 estudiants de la UIB conté almenys 40 dones. Una altra opció seria aprofitar el Teorema Central del Límit, segons el qual la proporció mostral \\(\\widehat{p}_X\\) de dones en mostres aleatòries simples de 60 estudiants de la UIB segueix una distribució aproximadament normal amb \\(\\mu=0.591\\) i \\[ \\sigma=\\sqrt{\\dfrac{0.591(1-0.591)}{60}}=0.0635 \\] Per tant, la probabilitat que \\(\\widehat{p}_X\\geq 0.6667\\) és (recordau, aproximadament) round(1-pnorm(0.6667,0.591,0.0635),4) ## [1] 0.1166 Hauria estat més astut emprar a més la correcció de continuïtat. Com que \\(\\widehat{p}_X=S_{60}/60\\), seria millor aproximar \\[ P(S_{60}\\geq 40)=1-P(S_{60}\\leq 39) \\] per, si diem \\(Y\\) a la normal \\(N(0.591,0.0635)\\), \\[ 1-P(Y\\leq 39.5/60) \\] round(1-pnorm(39.5/60,0.591,0.0635),4) ## [1] 0.1445 En el cas de la proporció mostral, de vegades permetrem prendre mostres aleatòries sense reposició. En aquest cas, la distribució del nombre d’èxits en una mostra segueix una distribució hipergeomètrica. D’aquí deduïm que seguim tenint que \\(E(\\widehat{p}_X)=p_X\\), però ara, si \\(N\\) és la mida de la població, \\[ \\sigma({\\widehat{p}_X})=\\sqrt{\\frac{p_X(1-p_X)}{n}}\\cdot \\sqrt{\\frac{\\vphantom{(p_X}N-n}{N-1}}. \\] Recordau que al factor \\[ \\sqrt{\\frac{N-n}{N-1}} \\] que transforma \\(\\sigma({\\widehat{p}_X})\\) per a mostres aleatòries simples en la desviació típica de \\({\\widehat{p}_X}\\) per a mostres aleatòries sense reposició li diem el factor de població finita, i és el que transformava la desviació típica d’una variable binomial (que compta èxits en mostres aleatòries simples) en la desviació típica d’una variable hipergeomètrica (que compta èxits en mostres aleatòries sense reposició). Però recordau que si la mida de la població \\(N\\) és molt gran comparat amb \\(n\\), podem suposar que una mostra aleatòria sense reposició és simple. Exemple 3.7 Tornem a la situació de l’Exemple 3.5. Què passa si prenem les mostres aleatòries de notes de tests sense reposició? Prenguem ara 105 mostres aleatòries sense reposició de 40 notes de tests. props.norep=replicate(10^5,mean(sample(aprovs,40))) Un altre cop, la mitjana d’aquest vector de proporcions mostrals hauria de ser propera a la proporció poblacional d’aprovats \\(p_X=0.5946\\). round(mean(props.norep),4) ## [1] 0.5942 Calculem ara la desviació típica d’aquest vector: round(sd(props.norep),4) ## [1] 0.0691 Pel que acabam d’explicar, la desviació típica d’aquest vector de proporcions mostrals de mostres sense reposició hauria de ser molt propera a \\[ \\sqrt{\\frac{p_X(1-p_X)}{n}}\\cdot\\sqrt{\\frac{\\vphantom{(p_X}N-n}{N-1}} \\] on \\(N\\) és la mida de la població, és a dir, la longitud del vector aprovs, i \\(n\\) la mida de les mostres. Vegem si és veritat: N=length(aprovs) n=40 round(sqrt(p_X*(1-p_X)/n)*sqrt((N-n)/(N-1)),4) ## [1] 0.0689 3.4 Variància mostral Donada una variable aleatòria \\(X\\), direm: Variància mostral de (mostres de) mida \\(n\\), \\(\\widetilde{S}_{X}^2\\), a la variable aleatòria que consisteix a prendre una mostra aleatòria simple de mida \\(n\\) de \\(X\\) i calcular la variància mostral dels seus valors. Desviació típica mostral de (mostres de) mida \\(n\\), \\(\\widetilde{S}_{X}\\), a la variable aleatòria que consisteix a prendre una mostra aleatòria simple de mida \\(n\\) de \\(X\\) i calcular la desviació típica mostral dels seus valors. Formalment, sigui \\(X_1,\\ldots, X_n\\) una mostra aleatòria simple de mida \\(n\\) d’una variable aleatòria \\(X\\) d’esperança \\(\\mu_X\\) i desviació típica \\(\\sigma_X\\). Aleshores \\[ \\widetilde{S}_{X}^2=\\frac{\\sum_{i=1}^n (X_{i}-\\overline{X})^2}{n-1},\\quad \\widetilde{S}_{X}=+\\sqrt{\\widetilde{S}_{X}^2} \\] A més, de tant en tant també farem servir la variància i la desviació típica “a seques”: \\[ \\begin{array}{l} \\displaystyle S^2_{X}=\\frac{\\sum_{i=1}^n (X_{i}-\\overline{X})^2}{n}=\\frac{(n-1)}{n}\\widetilde{S}^2_{X}\\\\ \\displaystyle S_X=+\\sqrt{S_X^2} \\end{array} \\] La variància (a seques) admet la següent expressió senzilla: \\[ S^2_X=\\frac{\\sum_{i=1}^n X_{i}^2}{n}-\\overline{X}^2 \\] En efecte: \\[ \\begin{array}{l} \\displaystyle \\frac{\\sum_{i=1}^n (X_{i}-\\overline{X})^2}{n}=\\frac{1}{n}\\sum_{i=1}^n (X_{i}^2-2\\overline{X}X_i+\\overline{X}^2)\\\\ \\displaystyle\\qquad = \\frac{1}{n}\\Big(\\sum_{i=1}^n X_{i}^2-2\\overline{X}\\sum_{i=1}^n X_{i}+n\\overline{X}^2\\Big)\\\\ \\displaystyle\\qquad =\\frac{\\sum_{i=1}^n X_{i}^2}{n}-2\\overline{X}\\frac{\\sum_{i=1}^n X_{i}}{n}+\\frac{n\\overline{X}^2}{n}\\\\ \\displaystyle\\qquad =\\frac{\\sum_{i=1}^n X_{i}^2}{n}-2\\overline{X}\\cdot\\overline{X} + \\overline{X}^2=\\frac{\\sum_{i=1}^n X_{i}^2}{n}- \\overline{X}^2 \\end{array} \\] Tenim els dos resultats següents. El primer ens diu que esperam que la variància mostral d’una mostra aleatòria simple de \\(X\\) valgui \\(\\sigma_{X}^2\\), en el sentit usual que si prenem mostres aleatòries simples de \\(X\\) de mida \\(n\\) gran i calculam les seves variàncies mostrals, molt probablement obtenim de mitjana un valor molt proper a \\(\\sigma_{X}^2\\). Teorema 3.5 Si \\(X\\) és una variable aleatòria de desviació típica \\(\\sigma_X\\) \\[ E(\\widetilde{S}_{X}^2})=\\sigma_{X}^2 \\] I per tant **no esperam* que la variància “a seques” d’una mostra aleatòria simple valgui \\(\\sigma_{X}^2\\). Això ho podeu comprovar fàcilment, perquè \\(S_X^2\\) s’obté a partir de \\(\\widetilde{S}_{X}^2\\) canviant el denominador, \\[ S_X^2=\\frac{n-1}{n} \\widetilde{S}_{X}^2 \\] i per tant \\[ E(S_X^2)=\\frac{n-1}{n}E(\\widetilde{S}_{X}^2)=\\frac{n-1}{n}\\sigma^2_{X} \\] El segon resultat ens diu que si la variable \\(X\\) és normal, un múltiple adequat de \\(\\widetilde{S}_{X}^2\\) té distribució mostral coneguda, la qual cosa ens permetrà calcular probabilitats d’e successos’esdeveniments relatius a \\(\\widetilde{S}_{X}^2\\).. Teorema 3.6 Si \\(X\\) es \\(N(\\mu_X,\\sigma_X)\\) y prenem mostres de mida \\(n\\), la variable aleatòria \\[ \\frac{(n-1)\\widetilde{S}_{X}^2}{\\sigma_{X}^2} \\] té distribució coneguda: \\(\\chi_{n-1}^2\\) (es llegeix khi quadrat amb \\(n-1\\) graus de llibertat). La lletra \\(\\chi\\) en català es diu khi; en castellà, ji; i en anglès, chi, pronunciat xai. De la distribució \\(\\chi_\\nu^2\\), on \\(\\nu\\) són els graus de llibertat, heu de saber que: Per definició, és la distribució de la suma dels quadrats de \\(\\nu\\) variables aleatòries normals estàndard independents. És a dir, si \\(Z_{1},Z_{2},\\ldots, Z_{\\nu}\\) són variables \\(N(0,1)\\) independents, la variable \\[ Z_{1}^{2}+Z_{2}^{2}+\\cdots +Z_{n}^{2} \\] té distribució \\(\\chi_\\nu^2\\). Per tant, és una distribució contínua La \\(\\nu\\) és el paràmetre del que depèn la seva densitat Amb R és chisq Si \\(X_\\nu\\) és una variable aleatòria amb distribució \\(\\chi_\\nu^2\\), aleshores \\(\\mu_{X_\\nu}=\\nu\\) i \\(\\sigma_{X_\\nu}^2=2 \\nu\\) Per a \\(\\nu\\) petits, la distribució d’una \\(\\chi_{n}^2\\) és asimètrica amb una cua a la dreta, i a mida que \\(\\nu\\) creix, (com que és la distribució d’una suma de \\(\\nu\\) variables aleatòries) pel Teorema Central del Límit es va aproximant a una distribució normal \\(N(n,\\sqrt{2n})\\), com podeu veure als gràfics següents curve(dchisq(x,1),col=1,lwd=2,xlim=c(0,20),xlab=&quot;&quot;,ylab=&quot;&quot;,ylim=c(0,0.3),main=&quot;Algunes khi quadrat&quot;) curve(dchisq(x,2),col=2,lwd=2,add=TRUE) curve(dchisq(x,3),col=3,lwd=2,add=TRUE) curve(dchisq(x,4),col=4,lwd=2,add=TRUE) curve(dchisq(x,5),col=5,lwd=2,add=TRUE) curve(dchisq(x,10),col=6,lwd=2,add=TRUE) legend(&quot;topright&quot;,col=1:6,lty=c(1,1), lwd=c(2,2),legend=paste(&quot;n=&quot;,c(1:5,10),sep=&quot;&quot;),cex=0.8) curve(dchisq(x,300),xlim=c(150,450),lwd=2,xlab=&quot;&quot;,ylab=&quot;&quot;,main=&quot;Khi quadrat vs Normal&quot;) curve(dnorm(x,300,sqrt(600)),lwd=2,col=&quot;red&quot;,add=TRUE) legend(&quot;topleft&quot;,col=c(&quot;black&quot;,&quot;red&quot;),lty=c(1,1), lwd=c(2,2),legend=c(&quot;Khi quadrat amb n=300&quot;,&quot;Normal&quot;),cex=0.7) Tornem un instant a això dels graus de llibertat. Per què diem que la variància (mostral o a seques) té \\(\\nu-1\\) graus de llibertat? Doncs perquè si volem construir un conjunt de \\(n\\) nombres \\(x_1,\\ldots,x_\\nu\\) que tenguin variància un valor donat, posem \\(y_0\\), aleshores en principi podem escollir \\(\\nu-1\\) d’ells, \\(x_1,\\ldots,x_{\\nu-1}\\), com volguem i aleshores el darrer, \\(x_\\nu\\), queda bastant fixat. En matemàtiques això se sol expressar dient que “tenim \\(\\nu-1\\) graus de llibertat a l’hora d’escollir \\(x_1,\\ldots,x_\\nu\\) amb variància fixada \\(y_0\\)”. En efecte, si fixam el valor \\(y_0\\geq 0\\) de la variància i volem trobar \\(x_1,\\ldots,x_{\\nu}\\) tals que \\[ y_0=\\frac{\\sum_{i=1}^\\nu (x_i-\\overline{x})^2}{n}=\\frac{\\sum_{i=1}^\\nu x_i^2}{\\nu}-\\overline{x}^2 \\] vegem que per a qualssevol valors de \\(x_1,\\ldots,x_{\\nu-1}\\), el valor de \\(x_\\nu\\) queda fixat per una equació quadràtica: \\[ \\begin{array}{l} \\nu y_0 &amp; =\\displaystyle \\sum_{i=1}^\\nu x_i^2-\\nu\\overline{x}^2= \\sum_{i=1}^\\nu x_i^2-\\nu\\Big(\\frac{\\sum_{i=1}^\\nu x_i}{\\nu}\\Big)^2\\\\ &amp; =\\displaystyle \\sum_{i=1}^\\nu x_i^2-\\frac{(\\sum_{i=1}^\\nu x_i)^2}{\\nu}\\\\ &amp; \\displaystyle =\\frac{1}{\\nu}\\left(\\nu\\sum_{i=1}^\\nu x_i^2-\\Big(\\sum_{i=1}^{\\nu} x_i\\Big)^2\\right)\\\\ &amp; =\\displaystyle \\frac{1}{\\nu}\\left(\\nu\\sum_{i=1}^{\\nu-1} x_i^2+\\nu\\mathbf{x_\\nu}^2-\\Big(\\sum_{i=1}^{\\nu-1} x_i\\Big)^2\\right.\\\\ &amp; \\displaystyle\\qquad\\qquad \\left. -2\\Big(\\sum_{i=1}^{\\nu-1} x_i\\Big)\\mathbf{x_\\nu}-\\mathbf{x_\\nu}^2\\right)\\\\ &amp; =\\displaystyle \\frac{1}{\\nu}\\left((\\nu-1)\\mathbf{x_\\nu}^2-2\\Big(\\sum_{i=1}^{\\nu-1} x_i\\Big)\\mathbf{x_\\nu}\\right.\\\\ &amp; \\displaystyle\\qquad\\qquad \\left.+\\nu\\sum_{i=1}^{\\nu-1} x_i^2-\\Big(\\sum_{i=1}^{\\nu-1} x_i\\Big)^2 \\right) \\end{array} \\] d’on (multiplicant els dos costats de la igualtat per \\(\\nu\\) i dividint-los per \\(\\nu-1\\)) obtenim, finalment, l’equació de segon grau en \\(\\mathbf{x_\\nu}\\) \\[ \\mathbf{x_\\nu}^2-\\frac{2\\sum_{i=1}^{\\nu-1} x_i}{\\nu-1}\\mathbf{x_\\nu}+\\frac{\\nu\\sum_{i=1}^{\\nu-1} x_i^2-\\Big(\\sum_{i=1}^{\\nu-1} x_i\\Big)^2-\\nu^2y_0^2}{\\nu-1}=0 \\] Per tant, fixat \\(y_0\\) i un cop escollits \\(x_1,\\ldots,x_{\\nu-1}\\), el darrer valor \\(x_\\nu\\) ha de ser per força una solució d’aquesta equació de segon grau. Fixau-vos que aquesta equació no sempre té solució real, perquè pot tenir el discriminant negatiu. Per tant exageràvem un poc dient que podíem triar \\(x_1,\\ldots,x_{\\nu-1}\\) “com volguem”. Per exemple, si voleu que la variància sigui 0 i preneu \\(x_1,\\ldots,x_{\\nu-1}\\) no tots iguals, podeu estar ben segurs que no trobareu cap \\(x_\\nu\\) que satisfaci aquesta equació: per tenir variància 0, \\(x_1,\\ldots,x_\\nu\\) han de ser tots iguals. Però el que ha de quedar clar és que un cop escollits \\(x_1,\\ldots,x_{\\nu-1}\\), el valor de \\(x_\\nu\\) ja no pot ser qualsevol, pot prendre com a màxim dos valors diferents. Anau alerta: Si la variable poblacional \\(X\\) no és normal, la conclusió del Teorema 3.6 no és vertadera. Encara que \\(X\\) sigui normal, \\(E(\\widetilde{S}_{X})\\neq \\sigma_{X}\\). Ja ho hem comentat abans. Si \\(S^2_{X}\\) és la variància “a seques” (dividint per \\(n\\) en comptes de per \\(n-1\\)), \\(E(S^2_{X})\\neq \\sigma^2_{X}\\). Exemple 3.8 Suposem que el pes en néixer dels nadons segueix una distribució normal, i s’estima que la seva desviació típica (en g) és 800. Hem anotat els pesos de tots els recent nats amb SIDA d’una ciutat durant 2 anys. El teniu al vector pesos.SIDA següent: pesos.SIDA=c(2466, 3941, 2807, 3118, 2098, 3175, 3515, 3317, 3742, 3062, 3033, 2353, 2013, 3515, 3260, 2892, 1616, 4423, 3572, 2750, 2807, 2807, 3005, 3374, 2722, 2495, 3459, 3374, 1984, 2495, 3062, 3005, 2608, 2353, 4394, 3232, 2013, 2551, 2977, 3118, 2637, 1503, 2438, 2722, 2863, 2013, 3232, 2863) Quina és la probabilitat que una mostra (aleatòria simple) de pesos de recent nats de la mateixa mida que aquesta tengui una desviació típica mostral més petita que la d’aquesta mostra? La variable d’interès és \\(X\\): Prenem un recent nat i pesam el seu pes en g. Ens diuen que és normal amb \\(\\sigma=800\\). Mirem la nostra mostra de pesos: n=length(pesos.SIDA) n ## [1] 48 DTM=round(sd(pesos.SIDA),1) DTM ## [1] 623.4 Sigui \\(\\widetilde{S}_X\\) la desviació típica mostral de mida 48 de la variable \\(X\\). Ens demanen \\(P(\\widetilde{S}_X&lt;623.4)\\). Això tal qual no ho sabem calcular, perquè no sabem la distribució de probabilitats de \\(\\widetilde{S}_X\\). Però sí que sabem la distribució de \\[ \\frac{(n-1)\\widetilde{S}_{X}^2}{\\sigma_{X}^2}= \\frac{47\\widetilde{S}_{X}^2}{800^2} \\] Aquesta variable té distribució \\(\\chi_{47}^2\\). Per tant el que hem de fer és traduir la probabilitat que volem calcular en termes d’aquesta variable: \\[ P(\\widetilde{S}_X&lt;623.4)=P\\Big(\\frac{47\\widetilde{S}_{X}^2}{800^2}&lt;\\frac{47\\cdot 623.4^2}{800^2}\\Big)=P(\\chi_{47}^2&lt;28.54) \\] i això val round(pchisq(round((n-1)*DTM^2/800^2,2),n-1),4) ## [1] 0.0153 Per tant, només un 1.5% de les mostres de 47 recent nats tenen una desviació típica mostral més petita que la de la nostra mostra de recent nats amb SIDA. 3.5 La distribució t de Student Recordau que si la variable poblacional \\(X\\) és \\(N(\\mu_X,\\sigma_X)\\) i prenem mostres aleatòries simples de mida \\(n\\), la variable \\[ \\frac{\\overline{X}-\\mu_X}{\\sigma_{X}/\\sqrt{n}} \\] és normal estàndard. Des del punt de vista teòric això és útil per obtenir fórmules, però normalment no ens serveix per calcular la probabilitat que a \\(\\overline{X}\\) li passi qualque cosa, perquè gairebé mai sabrem la desviació típica poblacional \\(\\sigma_{X}\\). Què passa si l’estimam per mitjà de \\(\\widetilde{S}_{X}\\) amb la mateixa mostra amb la qual calculam \\(\\overline{X}\\)? Doncs que el resultat següent ens salva el dia, perquè la variable que obtenim té distribució coneguda. Teorema 3.7 Sigui \\(X\\) una variable \\(N(\\mu_X, \\sigma_X)\\). Si prenem mostres aleatòries simples de mida \\(n\\), la variable aleatòria \\[ T=\\frac{\\overline{X}-\\mu_X}{\\widetilde{S}_{X}/\\sqrt{n}} \\] segueix una distribució coneguda, anomenada t de Student amb \\(n-1\\) graus de llibertat, \\(t_{n-1}\\). Al denominador \\(\\widetilde{S}_{X}/\\sqrt{n}\\) li diem l’error estàndard, o típic, de la mostra: estima l’error típic \\(\\sigma_X/\\sqrt{n}\\) de \\(\\overline{X}\\). De la distribució t de Student amb \\(n\\) graus de llibertat, \\(t_{\\nu}\\), heu de saber que: És contínua Amb R és t El nombre de graus de llibertat \\(\\nu\\) és un paràmetre del que depèn la seva distribució Si \\(T_{\\nu}\\) és una variable amb distribució \\(t_{\\nu}\\), aleshores \\(\\mu_{T_{\\nu}}=0\\) i \\(\\sigma_{T_{\\nu}}^2=\\nu/(\\nu-2)\\) (en realitat això només és veritat si \\(\\nu\\geq 3\\), però no fa falta recordar-ho). La funció de densitat d’una variable \\(T_{\\nu}\\) és simètrica al voltant de 0 (com la d’una \\(N(0,1)\\)): \\[ P(T_{\\nu}\\leq -x)=P(T_{\\nu}\\geq x)=1-P(T_{\\nu}\\leq x) \\] Si \\(\\nu\\) és gran, la distribució d’una variable \\(T_{\\nu}\\) és aproximadament la d’una \\(N(0,1)\\) (però amb més variància: un poc més aplatada), com podeu veure als gràfics següents: curve(dnorm(x),col=1,lwd=2,xlim=c(-4,4),xlab=&quot;&quot;,ylab=&quot;&quot;,ylim=c(0,0.4), main=&quot;Algunes t de Student&quot;) curve(dt(x,2),col=2,lwd=2,add=TRUE) curve(dt(x,3),col=3,lwd=2,add=TRUE) curve(dt(x,4),col=4,lwd=2,add=TRUE) curve(dt(x,5),col=5,lwd=2,add=TRUE) curve(dt(x,10),col=6,lwd=2,add=TRUE) legend(&quot;topleft&quot;,col=1:6,lty=rep(1,6), lwd=rep(2,6), legend=c(&quot;N(0,1)&quot;, paste(&quot;t amb g.l.=&quot;,c(2:5,10),sep=&quot;&quot;)),cex=0.7) curve(dnorm(x),col=1,lwd=2,xlim=c(-4,4),xlab=&quot;&quot;,ylab=&quot;&quot;,ylim=c(0,0.4), main=&quot;t vs Normal estàndard&quot;) curve(dt(x,50),col=2,lwd=2,add=TRUE) legend(&quot;topleft&quot;,col=1:2,lty=rep(1,2), lwd=rep(2,2), legend=c(&quot;N(0,1)&quot;, &quot;t amb g.l.=50&quot;),cex=0.7) El fet que una t de Student sigui més aplatada que una normal estàndard \\(Z\\) implica que les cues de la t tenen major probabilitat que les de \\(Z\\) (fixau-vos que als gràfics anteriors els extrems de les densitats de les t estan per damunt dels de la de \\(Z\\)), la qual cosa es tradueix en el fet que és més probable obtenir valors lluny del 0 amb una t de Student que amb una \\(N(0,1)\\). Indicarem amb \\(t_{\\nu,q}\\) el \\(q\\)-quantil d’una variable aleatòria \\(T_{\\nu}\\) que segueix una distribució \\(t_\\nu\\). És a dir, \\(t_{\\nu,q}\\) és el valor tal que \\[ P(T_{\\nu}\\leq t_{\\nu,q})=q \\] Per la simetria de la distribució \\(t_\\nu\\), \\[ t_{\\nu,q}=-t_{\\nu,1-q}. \\] Hi ha algunes propietats dels quantils de la t de Student que heu de saber, per poder aplicar-les quan no tengueu a l’abast R o una apli per calcular quantils: \\(t_{\\nu ,q}\\approx z_{q}\\) si \\(\\nu\\) és molt gran, posem \\(\\nu \\geq 200\\). Per exemple qt(0.975,200) # t_{300,0.975} ## [1] 1.9719 qnorm(0.975) # z_0.975 ## [1] 1.95996 \\(t_{\\nu,0.95}\\) (per a \\(10\\leq \\nu\\leq 200\\)) està entre 1.65 i 1.8; ho podeu aproximar \\(t_{n,0.95}\\approx 1.7\\) \\(t_{n,0.975}\\) (per a \\(10\\leq n\\leq 200\\)) està entre 1.97 i 2.2; ho podeu aproximar \\(t_{n,0.975}\\approx 2\\) Comprovau amb R les afirmacions sobr els quantils de la t de Student dels darrers dos punts. Abans de tancar aquesta secció, recordau que, donada una variable aleatòria \\(X\\), no heu de confondre: Desviació típica (o estàndard) de la variable aleatòria, \\(\\sigma_X\\): El paràmetre poblacional, normalment desconegut Desviació típica (o estàndard) (sigui mostral, \\(\\widetilde{S}_X\\), o a seques, \\(S_X\\)) d’una mostra: L’estadístic que calculam sobre la mostra i que quantifica la dispersió de la mostra Error típic (o estàndard) d’un estimador: La desviació típica de la variable aleatòria que defineix l’estimador, normalment desconeguda Error típic (o estàndard) d’una mostra: Estimació de l’error típic de la mitjana mostral (o de la proporció mostral) a partir d’una mostra; servirà per calcular intervals de confiança. És \\(\\widetilde{S}_X/\\sqrt{n}\\). 3.6 “Bons” estimadors 3.6.1 Estimadors no esbiaixats Un estimador puntual \\(\\widehat{\\theta}\\) d’un paràmetre poblacional \\(\\theta\\) és no esbiaixat (insesgado, en castellà) quan el seu valor esperat és precisament el valor poblacional del paràmetre, és a dir, quan \\[ \\mu_\\widehat{\\theta}=\\theta \\] Es diu aleshores que l’estimació puntual és no esbiaixada. El biaix d’un estimador \\(\\widehat{\\theta}\\) d’un paràmetre \\(\\theta\\) és la diferència \\(\\mu_\\widehat{\\theta}-\\theta\\) Exemples: Ja hem vist a les seccions anteriors que \\(\\mu_{\\overline{X}}=\\mu_X\\). Per tant, \\(\\overline{X}\\) és sempre un estimador no esbiaixat de \\(\\mu_X\\) \\(\\mu_{\\widehat{p}_X}=p_X\\). Per tant, \\(\\widehat{p}_X\\) és sempre un estimador no esbiaixat de \\(p_X\\) \\(\\mu_{\\widetilde{S}_{X}^2}=\\sigma_X^2\\) si \\(X\\) és normal. Per tant, \\(\\widetilde{S}_{X}^2\\) és un estimador no esbiaixat de \\(\\sigma_X^2\\) quan \\(X\\) és normal Com que \\({S}_{X}^2=\\dfrac{n-1}{n}\\widetilde{S}_{X}^2\\), tenim que \\(\\mu_{{S}_{X}^2}=\\dfrac{n-1}{n}\\sigma_X^2\\) si \\(X\\) és normal. Per tant, en aquest cas, \\({S}_{X}^2\\) és un estimador esbiaixat de \\(\\sigma_X^2\\), amb biaix \\[ \\mu_{{S}_{X}^2}-\\sigma_X^2=\\dfrac{n-1}{n}\\sigma_X^2-\\sigma_X^2=-\\dfrac{\\sigma_X^2}{n}\\ \\mathop{\\longrightarrow}_{\\scriptscriptstyle n\\to\\infty}\\ 0 \\] Diem en aquest cas que el biaix tendeix a 0. \\(\\mu_{\\widetilde{S}_{X}}, \\mu_{{S}_{X}}\\neq \\sigma_X\\) ni tan sols quan \\(X\\) és normal. Per tant, \\(\\widetilde{S}_{X}\\) i \\({S}_{X}\\) són estimadors esbiaixats de \\(\\sigma_X\\) 3.6.2 Estimadors eficients Donats dos estimadors \\(\\widehat{\\theta}_1\\), \\(\\widehat{\\theta}_2\\) del mateix paràmetre \\(\\theta\\), direm que \\(\\widehat{\\theta}_1\\) és més eficient, o més precís, que \\(\\widehat{\\theta}_2\\) quan l’error típic de \\(\\widehat{\\theta}_1\\) és més petit que el de \\(\\widehat{\\theta}_2\\): \\[ \\sigma(\\widehat{\\theta}_1)&lt; \\sigma(\\widehat{\\theta}_2). \\] Normalment, només comparam l’eficiència de dos estimadors quan són no esbiaixats (o, com a molt, quan el seu biaix tendeix a 0). En aquest cas, que \\(\\widehat{\\theta}_1\\) sigui més eficient que \\(\\widehat{\\theta}_2\\) significa que la seva variabilitat és menor i que per tant les estimacions amb \\(\\widehat{\\theta}_1\\) es concentren més al voltant del seu valor esperat, que és el paràmetre \\(\\theta\\) que volem estimar, que les estimacions amb \\(\\widehat{\\theta}_2\\). Exemples: Si \\(X\\) és normal, \\(\\overline{X}\\) és l’estimador no esbiaixat més eficient de la mitjana poblacional \\(\\mu_X\\). Si \\(X\\) és Bernoulli, \\(\\widehat{p}_X\\) és l’estimador no esbiaixat més eficient de la proporció poblacional \\(p_X\\). Si \\(X\\) és normal, \\(\\widetilde{S}_X^2\\) és l’estimador no esbiaixat més eficient de la variància poblacional \\(\\sigma_X^2\\). Exemple 3.9 Sigui \\(X\\) una variable aleatòria normal \\(N(\\mu_X,\\sigma_X)\\). Considerem la mediana \\(\\mathit{Me}=Q_{0.5}\\) d’una mostra aleatòria simple de \\(X\\) com a estimador puntual de \\(\\mu_X\\), que coincideix amb la mediana de \\(X\\) per la simetria de les variables normals. Resulta que \\(\\mu_{\\mathit{Me}}=\\mu_X\\) però \\[ \\sigma^2(\\mathit{Me})\\approx \\dfrac{\\pi}{2}\\cdot \\dfrac{\\sigma_{X}^2}{n}\\approx 1.57 \\cdot \\frac{\\sigma_{X}^2}{n}=1.57\\sigma^2_{\\overline{X}} \\] Per tant, si \\(X\\) és normal, la mediana \\(\\mathit{Me}\\) és un estimador no esbiaixat de \\(\\mu_X\\), però menys eficient que \\(\\overline{X}\\). Per això preferim emprar la mitjana mostral per estimar \\(\\mu_X\\). Hem dit que si la població és normal, \\(\\widetilde{S}_X^2\\) és l’estimador no esbiaixat més eficient de la variància poblacional \\(\\sigma_X^2\\). La variància a seques \\[ S_X^2=\\frac{(n-1)}{n} \\widetilde{S}_X^2 \\] és més eficient, perquè \\[ \\sigma(S_X^2)=\\sqrt{\\frac{(n-1)}{n}}\\sigma(\\widetilde{S}_X^2)&lt;\\sigma(\\widetilde{S}_X^2), \\] però és un estimador esbiaixat de \\(\\sigma_X^2\\), amb biaix que tendeix a 0. Si \\(n\\) és petit (per davall de 30), és millor fer servir la variància mostral \\(\\widetilde{S}_X^2\\) per estimar la variància, ja que el biaix pot desplaçar l’estimació, però si \\(n\\) és gran, el biaix de \\(S_X^2\\) ja és petit i es pot fer servir \\(S_X^2\\): de fet, si \\(n\\) és molt gran, dividir per \\(n\\) o per \\(n-1\\) no varia gaire el resultat i per tant \\(\\widetilde{S}_X^2\\) i \\(S_X^2\\) donen valors molt semblants. 3.6.3 Estimadors màxim versemblants Un estimador d’un paràmetre és màxim versemblant quan, aplicat a una mostra aleatòria simple d’una mida \\(n\\) fixada, dóna el valor del paràmetre que fa màxima la probabilitat d’obtenir aquesta mostra. En realitat, el que fa màxim l’estimació màxim versemblant d’un paràmetre és el producte dels valors de la funció densitat de la variable aleatòria poblacional aplicada als elements de la mostra. Quan la variable aleatòria és discreta, això coincideix amb el que hem dit, perquè la probabilitat d’obtenir un valor concret és la funció densitat aplicada a aquest valor. Però quan la variable aleatòria poblacional és contínua, la probabilitat d’obtenir una mostra concreta és sempre 0 i no té sentit parlar de maximitzar aquest 0. Per això es pren la funció densitat. En aquest curs no ens complicarem la vida i entendrem que el que maximitzam és la probabilitat d’obtenir la mostra. Exemple 3.10 Suposem que tenim una variable aleatòria Bernoulli \\(X\\) de probabilitat d’èxit \\(p_X\\) desconeguda. Donada una mostra aleatòria simple \\(x_1,\\ldots,x_n\\) de \\(X\\), siguin \\(\\widehat{p}_x\\) la seva proporció mostral i \\[ P(x_1,\\ldots,x_n\\mid p_X=p) \\] la probabilitat d’obtenir la mostra quan la probabilitat poblacional \\(p_X\\) és igual \\(p\\). Un estimador per a \\(p_X\\) és màxim versemblant quan, aplicat a cada mostra aleatòria simple \\(x_1,\\ldots,x_n\\) de \\(X\\), ens dóna el valor de \\(p\\) que fa que \\[ P(x_1,\\ldots,x_n\\mid p_X=p) \\] sigui el màxim possible. Quin creieu que és l’estimador màxim versemblant de \\(p_X\\)? Doncs sí, la proporció mostral \\(\\widehat{p}_X\\). Teorema 3.8 El valor de \\(p\\) per al qual \\(P(x_1,\\ldots,x_n\\mid p)\\) és màxim és \\(\\widehat{p}_x\\). La demostració és senzilla. Suposau que dins \\(x_1,\\ldots,x_n\\) hi ha \\(m\\) 1s i \\(n-m\\) 0s, de manera que \\(\\widehat{p}_X=m/n\\). Aleshores, la probabilitat d’obtenir \\(x_1,\\ldots,x_n\\) és \\[ P(x_1,\\ldots,x_n\\mid p)=p^m(1-p)^{n-m} \\] Per trobar el valor de \\(p\\) que fa aquest probabilitat màxima, derivau respecte de \\(p\\) i estudiau el signe de la derivada, i concloureu que el màxim es dóna efectivament a \\(p=m/n\\). La proporció \\(\\widehat{p}_x\\) és el valor que fa màxima la probabilitat d’obtenir la nostra mostra, no a l’enrevés: No és el valor més probable de \\(p_X\\) condicionat a la nostra mostra. Vaja, no confongueu \\[ P(x_1,\\ldots,x_n\\mid p_X=p)\\text{ amb }P(p_X=p\\mid x_1,\\ldots,x_n). \\] D’això darrer no en sabem trobar el màxim sense alguna hipòtesi sobre la distribució de probabilitat dels valors possibles de \\(p_X\\). Alguns altres estimadors màxim versemblants: \\(\\overline{X}\\) és l’estimador màxim versemblant del paràmetre \\(\\lambda\\) d’una variable aleatòria Poisson \\(\\overline{X}\\) és l’estimador màxim versemblant de la mitjana \\(\\mu\\) d’una variable aleatòria normal 3.7 Estimació de poblacions 3.7.1 Estimació de poblacions numerades Exemple 3.11 Un dia vaig voler estimar quants taxis hi havia a Palma. Per fer-ho, assegut en un bar del Passeig Marítim vaig apuntar les llicències dels 40 primers taxis que passaren. Els entraré directament en un vector de R. taxis=c(1217,600,883,1026,150,715,297,137,508,134,38,961,538,1154,314,1121,823,158,940,99, 977,286,1006,1207,264,1183,1120,498,606,566,1239,860,114,701,381,836,561,494,858,187) sort(taxis) ## [1] 38 99 114 134 137 150 158 187 264 286 297 314 381 494 498 ## [16] 508 538 561 566 600 606 701 715 823 836 858 860 883 940 961 ## [31] 977 1006 1026 1120 1121 1154 1183 1207 1217 1239 Puc estimar quants taxis hi ha a Palma a partir d’aquesta mostra? Us pot semblar una beneitura de pregunta, però aquest és un problema de rellevància històrica, com podeu consultar en aquest article. La solució d’aquest problema és donada pel resultat següent: Teorema 3.9 Sigui \\(X\\) una variable aleatòria uniforme sobre \\(\\{1,2,\\ldots,N\\}\\), i sigui \\(x_1,\\ldots,x_n\\) una mostra aleatòria de \\(X\\). Sigui \\(m=\\max(x_1,\\ldots,x_n)\\). Aleshores, l’estimador no esbiaixat més eficient de \\(N\\) és \\[ \\widehat{N}=m+\\frac{m-n}{n} \\] La idea que hi ha sota aquesta fórmula és que si suposau que teniu \\(x_1,\\ldots,x_n\\) ordenats en ordre creixent, de manera que \\(x_n=m\\), i calculau la mitjana de la longitud dels “forats” a l’esquerra de cada valor \\(x_i\\), tenim que a l’esquerra de \\(x_1\\) hi ha \\(x_1-1\\) nombres i entre cada \\(x_{i-1}\\) i \\(x_{i}\\) hi ha \\(x_{i}-x_{i-1}-1\\) nombres, i per tant aquesta mitjana és \\[ \\begin{array}{l} \\displaystyle \\frac{(x_1-1)+(x_2-x_1-1)+\\cdots+(x_{n}-x_{n-1}-1)}{n}\\\\ \\displaystyle \\qquad\\quad =\\frac{x_n-n}{n}=\\frac{m-n}{n} \\end{array} \\] i el que fa l’estimador \\(\\widehat{N}\\) és sumar al màxim de la mostra, \\(m\\), la mitjana dels forats entre membres de la mostra. És a dir, estimam que la mida de la població és tal que a la dreta del màxim de la nostra mostra hi ha un “forat” de mida la mitjana dels forats de la mostra. Exemple 3.12 Continuem amb l’Exemple 3.11. Emprant la fórmula anterior, obtenim max(taxis)+(max(taxis)-length(taxis))/length(taxis) ## [1] 1268.97 la qual cosa ens permet estimar que hi havia 1269 taxis a Palma. En realitat, consultant la web de l’Ajuntament, després vaig saber que en aquell moment n’hi havia 1246. Exemple 3.13 Fem un experiment. Generarem a l’atzar una mida N d’una població grandeta, i suposarem que els individus de la població estan numerats de l’1 a l’N. A continuació, prendrem 100 mostres aleaòries sense reposició de la nostra població i amb cada una d’aquestes mostres estimarem la N emprant la fórmula que hem donat. Al final, calcularem la mitjana d’aquestes estimacions i la compararem amb el valor real de N, que no descobrirem fins el final. Perquè l’experiment sigui reproductible, fixarem la llavor d’aleatorietat, però perquè no cregueu que fem trampes amb aquesta llavor, el que farem serà generar a l’atzar la llavor d’aleatorietat amb la funció sample. Llavor=sample(10000,1) Llavor ## [1] 6283 set.seed(Llavor) Ara generam la mida N de la població com un nombre a l’atzar entre 5000 i 10000. N=sample(5000:10000,1) Suposarem per tant que hi ha N individus a la nostra població, numerats de l’1 a l’N. Ara generarem 100 mostres aleatòries sense reposició d’aquesta població, i ens quedarem amb la mida i el valor màxim de cada una d’elles, que és l’únic que necessitam saber. Les mides les generarem a l’atzar entre, posem, 25 i 75: Mostra=function(a,b,P){ #a i b: mides màxima i mínima de la mostra; P: mida de la població n=sample(a:b,1) #Mida de la mostra X=sample(P,n,rep=FALSE) # Mostra aleatòria c(n,max(X)) #Parell (mida, màxim) } Mostres=replicate(100,Mostra(25,75,N)) Mostres ## [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14] ## [1,] 67 42 75 67 39 69 26 30 30 46 34 50 59 65 ## [2,] 6442 6320 6346 6403 5805 6410 6326 6398 6365 6354 6337 6371 5932 6439 ## [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24] [,25] [,26] ## [1,] 55 58 74 41 28 40 39 50 52 46 74 52 ## [2,] 6274 6433 6426 5795 6213 6367 6066 5903 6219 6187 6393 6333 ## [,27] [,28] [,29] [,30] [,31] [,32] [,33] [,34] [,35] [,36] [,37] [,38] ## [1,] 43 31 45 55 63 46 73 74 45 45 53 63 ## [2,] 6243 6295 6406 6409 6308 6421 6327 6354 6319 6282 6255 6430 ## [,39] [,40] [,41] [,42] [,43] [,44] [,45] [,46] [,47] [,48] [,49] [,50] ## [1,] 54 28 36 61 52 53 37 29 65 75 37 43 ## [2,] 6335 6002 6310 6331 6381 6338 6235 6304 6292 6394 6309 6362 ## [,51] [,52] [,53] [,54] [,55] [,56] [,57] [,58] [,59] [,60] [,61] [,62] ## [1,] 73 30 70 55 45 31 62 54 36 50 28 67 ## [2,] 6302 6426 6278 6265 6191 6442 6389 6242 6260 6406 5937 6235 ## [,63] [,64] [,65] [,66] [,67] [,68] [,69] [,70] [,71] [,72] [,73] [,74] ## [1,] 25 71 40 49 65 65 55 67 55 33 39 74 ## [2,] 5673 6285 6269 6200 6381 6414 6183 6304 6433 6426 6442 6372 ## [,75] [,76] [,77] [,78] [,79] [,80] [,81] [,82] [,83] [,84] [,85] [,86] ## [1,] 29 63 39 57 51 55 61 33 33 58 71 44 ## [2,] 5602 6371 6412 6369 6374 6412 6307 5945 6259 6095 6397 6361 ## [,87] [,88] [,89] [,90] [,91] [,92] [,93] [,94] [,95] [,96] [,97] [,98] ## [1,] 62 68 34 68 37 39 63 65 66 68 64 36 ## [2,] 6379 6435 5956 6373 6335 6285 6426 6437 6438 6403 6406 5954 ## [,99] [,100] ## [1,] 55 32 ## [2,] 6271 5993 En aquesta matriu Mostres, cada columna correspon a una mostra aleatòria: la primera filera és la seva mida \\(n\\) i la segona filera el màxim \\(m\\). Ara, amb cada una d’aquestes mostres, podem estimar la mida N de la població per mitjà de la fórmula \\(m+(m-n)/n\\). Donarem aquestes estimacions ordenades de menor a major. Estimacions=Mostres[2,]+(Mostres[2,]-Mostres[1,])/Mostres[1,] round(sort(Estimacions),1) ## [1] 5794.2 5898.9 5935.3 5952.8 6020.1 6031.5 6118.4 6124.2 6130.2 6148.0 ## [11] 6179.3 6199.1 6215.4 6220.5 6294.4 6320.5 6325.5 6327.1 6327.6 6337.6 ## [21] 6356.6 6366.7 6372.0 6372.5 6377.9 6384.0 6387.1 6387.2 6387.3 6387.8 ## [31] 6397.1 6402.5 6407.1 6409.4 6412.7 6420.6 6424.7 6429.6 6432.9 6433.8 ## [41] 6433.9 6438.9 6445.2 6447.7 6451.3 6453.8 6456.6 6457.1 6458.4 6465.7 ## [51] 6469.5 6471.1 6478.2 6478.3 6478.4 6478.5 6479.7 6480.9 6484.3 6486.1 ## [61] 6491.0 6491.1 6496.2 6497.1 6497.4 6497.6 6498.0 6501.9 6502.7 6504.6 ## [71] 6505.1 6505.2 6509.0 6511.7 6511.8 6520.4 6522.4 6524.5 6525.2 6527.0 ## [81] 6527.6 6528.6 6531.1 6533.1 6534.5 6535.0 6537.1 6537.1 6542.9 6547.4 ## [91] 6549.0 6559.6 6568.3 6575.4 6576.2 6606.2 6610.3 6619.7 6639.2 6648.8 hist(Estimacions, breaks=20,col=&quot;light blue&quot;,xlab=&quot;Estimacions de N&quot;,ylab=&quot;Freqüències&quot;,main=&quot;&quot;) Com veieu, obtenim estimacions que van de 5794.2 a 6648.8. La mitjana d’aquestes estimacions és round(mean(Estimacions),1) ## [1] 6415.9 És hora de descobrir el valor de N, per veure si ens hi hem fet a prop: N ## [1] 7134 No hem fet molt enfora, com veieu. 3.7.2 Marca-recaptura Suposem que en una població hi ha \\(N\\) individus, en capturam \\(K\\) (tots diferents), els marcam i els tornam a amollar. Al cap de poc temps, en capturam \\(n\\), dels quals \\(k\\) estan marcats. A partir d’aquestes dades, volem estimar \\(N\\). Si suposam que \\(N\\) i \\(K\\) no han canviat de la primera a la segona captura (cap individu no ha abandonat la població ni s’hi ha incorporat), aleshores la variable aleatòria \\(X\\) definida per “Capturam un individu i miram si està marcat” és Bernoulli \\(Be(p)\\) amb \\(p=K/N\\), on coneixem la \\(K\\) i volem estimar la \\(N\\). Sigui ara \\(x_1,\\ldots,x_n\\) la mostra capturada en segon lloc. La seva proporció mostral d’individus marcats és \\(\\widehat{p}_X=k/n\\). Com que \\(\\widehat{p}_X\\) és l’estimador màxim versemblant de \\(p\\), estimam que \\[ \\dfrac{K}{N}=\\dfrac{k}{n} \\] d’on, aïllant la \\(N\\), estimam que \\[ N=\\frac{n\\cdot K}{k}. \\] En resum, l’estimador \\[ \\widehat{N}=\\frac{n\\cdot K}{k} \\] maximitza la probabilitat d’obtenir \\(k\\) individus marcats en una mostra aleatòria de \\(n\\) individus. És l’estimador màxim versemblant de \\(N\\) a partir de \\(K\\), \\(k\\) i \\(n\\); també se li diu estimador de Lincoln-Petersen. Fixau-vos que aquest estimador no fa res més que traduir la proporció “Si he trobat \\(k\\) individus marcats en un conjunt de \\(n\\) individus, què ha de valer el nombre total \\(N\\) de individus perquè hi hagi en total \\(K\\) individus marcats?” Exemple 3.14 Suposem que hem marcat 15 peixos d’un llac, i que en una captura posterior de 10 peixos, n’hi ha 4 de marcats. Quants peixos conté el llac? Ho estimarem amb l’estimador de Lincoln-Petersen: \\[ \\widehat{N}=\\frac{15\\cdot 10}{4}=37.5 \\] Per tant, estimam que hi haurà entre 37 i 38 peixos al llac. En aquest cas podem comprovar la màxima versemblança d’aquesta estimació, calculant la probabilitat d’obtenir 4 individus marcats en una mostra aleatòria de 10 individus d’una població de \\(N\\) individus on n’hi ha 15 de marcats i trobant la \\(N\\) que maximitza aquesta probabilitat. Per fer-ho, recordem que si una població està formada per \\(K\\) subjectes marcats i \\(N-K\\) subjectes no marcats, el nombre de subjectes marcats en mostres aleatòries sense reposició de mida \\(n\\) segueix una distribució hipergeomètrica \\(H(K, N-K,n)\\). Per tant, per a cada possible \\(N\\), la probabilitat que en una mostra de 10 peixos del nostre llac n’hi hagi 4 de marcats serà dhyper(4,15,N-15,10). N=15:1000 #Rang de possibles valors de N p=dhyper(4,15,N-15,10) #Probabilitats de 4 marcats en 10 Nmax=N[which(p==max(p))] # N que maximitza la probabilitat Nmax ## [1] 37 Aquest Nmax és la \\(N\\) que fa màxima la probabilitat que en una mostra de 10 peixos del nostre llac n’hi hagi 4 de marcats. Vegem-ho amb un gràfic: plot(N[1:86],p[1:86],type=&quot;h&quot;,xaxp=c(15,100,17),xlab=&quot;N&quot;,ylab=&quot;p&quot;) points(Nmax,dhyper(4,15,Nmax-15,10),type=&quot;h&quot;,col=&quot;red&quot;,lwd=1.5) Un altre estimador per a \\(N\\) a partir de \\(K\\), \\(n\\) i \\(k\\) és l’estimador de Chapman: \\[ \\widehat{N}=\\frac{(n+1)\\cdot (K+1)}{k+1}-1 \\] La idea és que afegim a la població un individu extra i marcat, que suposam que també capturam a la segona mostra. Llavors, aplicam l’estimador anterior i finalment restam 1, per descomptar l’individu marcat extra que realment no pertany a la població que volem estimar. En la situació de l’Exemple 3.14, aquest estimador dóna \\[ \\widehat{N}=\\frac{16\\cdot 11}{5}-1=34.2 \\] i ens fa estimar una població total d’uns 34 peixos. Abans hem obtingut entre 37 i 38 peixos. Quina de les dues estimacions s’acosta més a la realitat? Ni idea, no ho podem saber. Amb una altra recaptura segurament haguéssim obtingut resultats diferents. L’estimador de Lincoln-Petersen \\[ \\widehat{N}=\\frac{n\\cdot K}{k} \\] és esbiaixat, amb biaix que tendeix a 0. L’estimador de Chapman és menys esbiaixat però no és màxim versemblant. Exemple 3.15 Fem un experiment similar al de l’Exemple 3.13. Generarem a l’atzar una mida N d’una població grandeta i en marcarem una certa quantitat K. A continuació, prendrem 50 mostres aleaòries sense reposició de la nostra població i amb cada una d’aquestes mostres estimarem la N emprant els dos estimadors que hem explicat en aquesta subsecció. Al final, calcularem les mitjanes d’aquestes estimacions i les compararem amb el valor real de N, que no descobrirem fins el final. Com a l’Exemple 3.13, fixarem la llavor d’aleatorietat a l’atzar. Llavor2=sample(10000,1) Llavor2 ## [1] 6244 set.seed(Llavor2) Ara generam la mida N de la població com un nombre a l’atzar entre 5000 i 10000. N=sample(5000:10000,1) Ara en capturam i marcam K; per fixar idees, prendrem K=200. K=200 Per simplificar, suposarem que els N individus de la nostra població estan numerats de l’1 a l’N i que els marcats són els K primers. Ara generarem 100 mostres aleatòries sense reposició d’aquesta població, i ens quedarem amb la mida i el nombre d’individus marcats (és a dir, el nombre de valors menor o iguals a K=100 en la mostra). Les mides les generarem a l’atzar entre, posem, 50 i 150: Mostra=function(a,b,P,M){ #a i b: mides màxima i mínima de la mostra; P: mida de la població; #M: nombre de marcats n=sample(a:b,1) #Mida de la mostra X=sample(P,n,rep=FALSE) # Mostra aleatòria c(n,length(which(X&lt;=M))) #Parell (mida, nombre de marcats) } Mostres=replicate(100,Mostra(50,150,N,K)) Mostres ## [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14] ## [1,] 79 94 110 116 128 127 68 59 144 135 147 86 89 51 ## [2,] 2 2 1 2 1 3 2 1 4 2 10 8 4 0 ## [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24] [,25] [,26] ## [1,] 121 95 50 54 71 67 113 141 65 129 111 97 ## [2,] 4 4 0 2 3 0 0 4 3 3 5 2 ## [,27] [,28] [,29] [,30] [,31] [,32] [,33] [,34] [,35] [,36] [,37] [,38] ## [1,] 74 102 88 82 112 92 120 138 82 65 103 114 ## [2,] 1 2 3 9 1 6 1 2 1 3 6 5 ## [,39] [,40] [,41] [,42] [,43] [,44] [,45] [,46] [,47] [,48] [,49] [,50] ## [1,] 106 72 57 54 123 68 51 52 81 75 121 90 ## [2,] 1 0 0 2 3 1 2 2 2 2 3 3 ## [,51] [,52] [,53] [,54] [,55] [,56] [,57] [,58] [,59] [,60] [,61] [,62] ## [1,] 87 123 128 73 139 115 130 50 102 80 90 92 ## [2,] 1 1 3 2 5 2 1 2 2 3 2 1 ## [,63] [,64] [,65] [,66] [,67] [,68] [,69] [,70] [,71] [,72] [,73] [,74] ## [1,] 143 125 141 132 54 102 79 100 107 137 113 118 ## [2,] 3 5 6 1 1 4 3 2 4 4 2 4 ## [,75] [,76] [,77] [,78] [,79] [,80] [,81] [,82] [,83] [,84] [,85] [,86] ## [1,] 106 101 78 56 99 82 118 131 102 108 63 136 ## [2,] 4 3 6 3 3 2 4 6 0 4 1 5 ## [,87] [,88] [,89] [,90] [,91] [,92] [,93] [,94] [,95] [,96] [,97] [,98] ## [1,] 60 73 81 107 130 70 70 54 103 77 115 133 ## [2,] 4 0 1 3 4 1 1 2 3 3 1 5 ## [,99] [,100] ## [1,] 75 100 ## [2,] 1 3 En aquesta matriu Mostres, cada columna correspon a una mostra aleatòria: la primera filera és la seva mida \\(n\\) i la segona filera el nombre d’individus marcats a la mostra. Ara, amb cada una d’aquestes mostres, podem estimar la mida N de la població per mitjà de l’estimador de Lincoln-Petersen. EstimacionsLP=Mostres[1,]*K/Mostres[2,] round(sort(EstimacionsLP),1) ## [1] 1822.2 2150.0 2600.0 2940.0 3000.0 3066.7 3433.3 3733.3 4333.3 ## [10] 4333.3 4366.7 4440.0 4450.0 4560.0 4700.0 4733.3 4750.0 5000.0 ## [19] 5000.0 5100.0 5100.0 5133.3 5200.0 5266.7 5300.0 5320.0 5333.3 ## [28] 5350.0 5400.0 5400.0 5400.0 5400.0 5440.0 5560.0 5866.7 5900.0 ## [37] 5900.0 6000.0 6050.0 6500.0 6600.0 6666.7 6733.3 6800.0 6850.0 ## [46] 6866.7 7050.0 7133.3 7200.0 7300.0 7500.0 7900.0 8066.7 8100.0 ## [55] 8200.0 8200.0 8466.7 8533.3 8600.0 9000.0 9400.0 9533.3 9700.0 ## [64] 10000.0 10200.0 10200.0 10800.0 11300.0 11500.0 11600.0 11800.0 12600.0 ## [73] 13500.0 13600.0 13800.0 14000.0 14000.0 14800.0 15000.0 16200.0 16400.0 ## [82] 17400.0 18400.0 21200.0 22000.0 22400.0 23000.0 24000.0 24600.0 25600.0 ## [91] 26000.0 26400.0 Inf Inf Inf Inf Inf Inf Inf ## [100] Inf hist(EstimacionsLP, breaks=20,col=&quot;light blue&quot;,xlab=&quot;Estimacions de N&quot;,ylab=&quot;Freqüències&quot;,main=&quot;Estimador de Lincoln-Petersen&quot;) Com veieu, obtenim estimacions que van de 1822.2 a \\(\\infty\\), que corresponen a mostres on no ens ha sortit cap individu marcat. La mitjana de les estimacions finites és round(mean(EstimacionsLP[is.finite(EstimacionsLP)]),1) ## [1] 9261.2 També podem emprar l’estimador de Chapman: EstimacionsCh=(Mostres[1,]+1)*(K+1)/(Mostres[2,]+1)-1 round(sort(EstimacionsCh),1) ## [1] 1667.3 1942.0 2267.4 2451.2 2669.4 2703.4 2863.2 2985.3 3315.5 ## [10] 3315.5 3416.0 3483.0 3550.0 3617.0 3617.0 3684.0 3684.0 3684.0 ## [19] 3751.0 3789.3 3851.5 3858.2 3918.5 4019.0 4069.2 4076.4 4139.6 ## [28] 4220.0 4300.4 4340.6 4380.8 4471.2 4488.0 4571.8 4588.5 4622.0 ## [37] 4689.0 4782.8 4782.8 4903.4 4957.0 5024.0 5074.2 5091.0 5124.5 ## [46] 5225.0 5265.2 5359.0 5426.0 5493.0 5526.5 5546.6 5560.0 5707.4 ## [55] 5828.0 6029.0 6096.0 6129.5 6230.0 6364.0 6431.0 6431.0 6481.2 ## [64] 6531.5 6565.0 6766.0 6900.0 6900.0 6933.5 7134.5 7134.5 7235.0 ## [73] 7536.5 7637.0 7637.0 7771.0 7838.0 8240.0 8340.5 8843.0 9111.0 ## [82] 9312.0 9345.5 10250.0 10451.0 10752.5 11154.5 11355.5 11657.0 11657.0 ## [91] 12159.5 12461.0 12963.5 13164.5 13365.5 13667.0 14672.0 14873.0 20702.0 ## [100] 22913.0 hist(EstimacionsCh, breaks=20,col=&quot;light blue&quot;,xlab=&quot;Estimacions de N&quot;,ylab=&quot;Freqüències&quot;,main=&quot;Estimador de Chapman&quot;) Com veieu, obtenim estimacions que van de 1667.3 a 22913; per construcció, no hi ha estimacions infinites. La mitjana d’aquestes estimacions és round(mean(EstimacionsCh),1) ## [1] 6618.6 És hora de descobrir el valor de N, per veure si ens hi hem fet a prop: N ## [1] 7134 3.8 Test de la lliçó 3 (1) Tenim una variable aleatòria \\(X\\) normal de mitjana \\(\\mu\\) i desviació típica \\(\\sigma\\). Prenem mostres aleatòries simples de mida \\(n\\), i indicam amb \\(\\widetilde{S}_X\\) la seva desviació típica mostral. Quines de les afirmacions següents són vertaderes? Marca totes les respostes vertaderes: \\(E(\\widetilde{S}_X^2)=\\sigma^2\\). \\(E(\\widetilde{S}_X)=\\sigma\\). \\(\\widetilde{S}_X^2\\) segueix una distribució \\(\\chi^2\\) amb \\(n-1\\) graus de llibertat. \\((n-1)\\widetilde{S}_X^2/\\sigma^2\\) segueix una distribució \\(\\chi^2\\) amb \\(n-1\\) graus de llibertat. Totes les altres respostes són falses. (2) Quina o quines de les afirmacions següents sobre la mitjana mostral són vertaderes? Si la distribució poblacional és normal, sempre coincideix amb la mediana de la mostra. Sempre serveix per estimar la mitjana poblacional. Sempre serveix per estimar la mediana poblacional. Si la distribució poblacional és normal, serveix per estimar la mediana poblacional. Cap de les altres respostes és correcta. (3) L’error estàndard de la mitjana mostral (marca totes les continuacions correctes): Mesura la variabilitat de les observacions que formen la mostra. És l’exactitud amb què es mesura cada observació de la mostra. Mesura la variabilitat de les mitjanes mostrals de mostres aleatòries simples. És proporcional a la mitjana mostral. És més gran que la desviació típica de la població. Sobre cada mostra val la desviació típica de la mostra. Cap de les altres respostes és correcta. (4) La proporció d’afectats per una determinada malaltia en una població és del 10%. Si estimam aquesta proporció poblacional repetidament a partir de mostres de mida 1000, aquestes estimacions segueixen una distribució que (marca totes les afirmacions correctes): És una distribució mostral. És aproximadament normal. Té mitjana 0.1. Té variància 90. És binomial. Cap de les altres respostes és correcta. (5) Si volem disminuir a la meitat l’error estàndard d’una proporció mostral (marcau una sola resposta): Hem d’augmentar en un 50% la mida de la mostra Hem de doblar la mida de la mostra. Hem de quadruplicar la mida de la mostra. Hem de dividir per 2 la mida de la mostra. Hem de dividir per 4 la mida de la mostra. Cap de les altres respostes és correcta. (6) La probabilitat que els individus d’una determinada població tenguin una determinada característica \\(C\\) és \\(p\\). Prenem mostres aleatòries simples de mida \\(n\\) d’aquesta població, i indicam amb \\(\\widehat{p}_X\\) la seva proporció mostral. Quina o quines de les afirmacions següents són vertaderes? \\(\\widehat{p}_X\\) té sempre distribució binomial \\(B(n,p)\\). \\(\\widehat{p}_X\\) té sempre distribució normal. Si \\(n\\) és gran, \\(\\widehat{p}_X\\) té distribució aproximadament binomial \\(B(n,p)\\). Si \\(n\\) és gran, \\(\\widehat{p}_X\\) té distribució aproximadament normal. L’error estàndard de \\(\\widehat{p}_X\\) és \\(\\sqrt{p(1-p)/n}\\). (7) Si prenem mostres aleatòries simples més grans (marca totes les continuacions correctes): La mitjana mostral sempre disminueix. L’error estàndard de la mitjana sempre disminueix. L’error estàndard de la mitjana sempre augmenta. La variància mostral sempre augmenta. El nombre de graus de llibertat de l’estimador \\(\\chi^2\\) associat a la variància mostral sempre augmenta. Cap de les altres respostes és correcta. (8) La longitud d’una determinada espècie d’animalons té un valor mitjà de \\(\\mu\\) cm. Si prenem mostres aleatòries simples de 20 exemplars, calculam la seva mitjana mostral \\(\\overline{X}\\) i la seva desviació típica mostral \\(\\widetilde{S}_X\\) (marca la continuació més correcta): L’estadístic \\(\\frac{\\overline{X}-\\mu}{\\widetilde{S}_X/\\sqrt{20}}\\) segueix sempre una llei normal. L’estadístic \\(\\frac{\\overline{X}-\\mu}{\\widetilde{S}_X/\\sqrt{20}}\\) segueix sempre una llei t de Student. L’estadístic \\(\\frac{\\overline{X}-\\mu}{\\widetilde{S}_X/\\sqrt{20}}\\) segueix una llei normal si la longitud segueix una llei normal. L’estadístic \\(\\frac{\\overline{X}-\\mu}{\\widetilde{S}_X/\\sqrt{20}}\\) segueix una llei t de Student si la longitud segueix una llei normal. L’estadístic \\(\\frac{\\overline{X}-\\mu}{\\widetilde{S}_X/\\sqrt{20}}\\) no segueix mai ni una llei normal ni una llei t de Student, perquè les mostres no són prou grans. (9) Sobre una mostra de 100 dones es va obtenir una concentració mitjana d’hemoglobina en sang de 10 amb una desviació típica de 2. Quin és l’error típic de la mostra? 0.02 0.04 0.2 0.4 1 Cap dels valors anteriors (10) Què significa que un estimador d’un paràmetre d’una variable aleatòria sigui no esbiaixat? Que la distribució mostral de l’estimador és normal. Que aplicat a una m.a.s. sempre dóna el valor poblacional del paràmetre. Que el seu valor esperat és igual al valor poblacional del paràmetre. Que aplicat a una m.a.s. sempre dóna el valor esperat del paràmetre. Que el seu error típic és petit. (11) La concentració en sang a les persones d’un determinat metabolit (en mg/ml) té una distribució \\(N(23,3)\\). Quina de les afirmacions següents és vertadera? Aproximadament un 90% de les mostres aleatòries de 100 individus tindran la seva mitjana entre 22.4 i 23.6 mg/ml. Aproximadament un 95% de les mostres aleatòries de 100 individus tindran la seva mitjana entre 22.4 i 23.6 mg/ml. Aproximadament un 99% de les mostres aleatòries de 100 individus tindran la seva mitjana entre 22.4 i 23.6 mg/ml. Més d’un 99% de les mostres aleatòries de 100 individus tindran mitjana igual a 23. Cap de les afirmacions anteriors és vertadera. (12) Sigui \\(X\\) una variable aleatòria \\(N(\\mu_X,2)\\) i sigui \\(\\overline{X}\\) la mitjana mostral de mida \\(10\\) de \\(X\\). Quina de les afirmacions següents és vertadera? La desviació típica de \\(\\overline{X}\\) és igual a 2. La desviació típica de \\(\\overline{X}\\) és menor que 2. La desviació típica de \\(\\overline{X}\\) és major que 2. Que la desviació típica de \\(\\overline{X}\\) sigui major, menor o igual que 2 depèn de \\(\\mu_X\\). Cap de les afirmacions anteriors és vertadera. "],
["intervals-de-confiança.html", "Tema 4 Intervals de confiança 4.1 Definicions bàsiques 4.2 Exemple: Interval de confiança del 95% per a la mitjana d’una variable aleatòria normal 4.3 Interval de confiança per a la mitjana basat en la t de Student 4.4 Intervals de confiança per a proporcions 4.5 Intervals de confiança per a la variància d’una variable normal 4.6 “Poblacions finites”", " Tema 4 Intervals de confiança L’estimació puntual ens dóna el valor d’una característica d’una població, però no ens indica l’error que es comet amb aquesta estimació. A la pràctica, el que se sol fer és complementar una estimació puntual amb un interval que mesuri la precisió de l’estimació. Aquesta precisió depèn: De la variabilitat de la variable aleatòria d’interès: \\(\\sigma_X\\) De la mida de la mostra: \\(n\\) De la variabilitat de l’estimador (que segurament depèn de les dues anteriors): \\(\\sigma_{\\overline{X}}\\), \\(\\sigma_{\\widehat{p}_X}\\)… Del nivell de confiança, o seguretat, de l’estimació: com de segurs volem estar que l’estimació és correcta 4.1 Definicions bàsiques Un interval de confiança del Q% (abreviadament, un IC Q%) d’un paràmetre poblacional és un interval obtingut aplicant a una mostra aleatòria simple de mida \\(n\\) una fórmula que satisfà la propietat següent: L’interval obtingut conté el valor del paràmetre poblacional el Q% de les vegades que l’aplicam sobre mostres aleatòries simples de mida \\(n\\) preses a l’atzar Tenir una confiança del Q% significa doncs que empram una fórmula que encerta el Q% de les vegades; o, per ser precisos, el Q% de les vegades que l’aplicam bé. Però assumim que un (100-Q)% de les vegades que l’aplicam ens equivocam, i no sabem quin és el nostre cas. Exemple 4.1 En un experiment hem mesurat el percentatge d’augment d’alcohol en sang a 40 persones després de prendre 4 canyes de cervesa. La mitjana i la desviació típica mostral d’aquests percentatges d’increment han estat \\(\\overline{x}=41.2\\) i \\(\\widetilde{s}=2.1\\). Com veurem a l’Exemple 4.3, un IC 95% per al percentatge d’augment mitjà d’alcohol en sang d’una persona després de beure 4 canyes de cervesa és [40.53, 41.87]. Això significa que estam segurs al 95% que l’augment mitjà d’alcohol en sang d’una persona després de beure 4 canyes de cervesa està entre el 40.53% i el 41.87%, perquè aquest interval l’haurem calculat amb una fórmula que el 95% de les vegades que l’aplicam (bé) sobre mostres aleatòries de 40 persones dóna un interval que conté la mitjana poblacional que volem estimar. Nosaltres som optimistes i “confiam” estar dins aquest 95% d’encerts. No confongueu: Interval de referència del Q% per a una variable aleatòria: Interval que conté el valor de la variable aleatòria en un individu amb probabilitat Q%. Interval de confiança del Q% per a un paràmetre: Interval que conté el valor poblacional del paràmetre de la variable aleatòria “amb probabilitat” Q%, en el sentit que l’hem calculat amb una fórmula que dóna un interval que conté el paràmetre el Q% de les vegades que l’aplicam a una mostra aleatòria. Interval de referència del Q% per a un estimador: Interval que conté el valor de l’estimador sobre una mostra aleatòria amb probabilitat Q%. Per exemple: Si diem que un interval de referència del 95% per a la concentració d’una proteïna en sèrum en individus sans mesurada en g/dl és [11,16], això significa significa que un 95% dels individus sans tenen una concentració d’aquesta proteïna en sèrum entre 11 i 16 g/dl, o, equivalentment, que un individu sa escollit a l’atzar té, amb un 95% de probabilitat, una concentració d’aquesta proteïna en sèrum entre 11 i 16 g/dl Si diem que un interval de confiança del 95% per a la concentració mitjana d’una proteïna en sèrum en individus sans mesurada en g/dl és [11,16], això significa que hem pres una mostra aleatòria de concentracions d’aquesta proteïna en sèrum en individus sans i a partir d’aquesta mostra hem estimat que, amb un 95% de confiança, la concentració mitjana d’aquesta proteïna en sèrum en individus sans està entre 11 i 16 g/dl (i tenim un 95% de confiança en aquest interval perquè l’hem calculat amb una fórmula que dóna un interval que conté la mitjana poblacional un 95% de les vegades que l’empram sobre mostres aleatòries de la mateixa mida que la nostra). Si diem que el 95% de les mostres de 100 concentracions d’una determinada proteïna en sèrum en individus sans tenen la mitjana mostral entre 11 i 16, això és un interval de referència del 95% per a la mitjana mostral de mostres de mida 100, no un interval de confiança per a la concentració mitjana poblacional ni un interval de referència per al valor de la concentració en un individu. Que un IC Q% per a un paràmetre \\(\\theta\\) sigui \\([a,b]\\) serveix: Per estimar \\(\\theta\\) amb aquest marge de confiança: Estam bastant segurs que el valor poblacional de \\(\\theta\\) està entre \\(a\\) i \\(b\\) (la fórmula emprada encerta sovint) Per poder comparar el valor poblacional de \\(\\theta\\) amb un valor concret amb aquest marge de confiança: Estam bastant segurs que el valor real de \\(\\theta\\) no està ni per sota de \\(a\\) ni per sobre de \\(b\\) i per tant que és diferent de tots aquests valors Per exemple: si un IC 95% per a la prevalència \\(p\\) d’una determinada característica en una població (la fracció d’individus que tenen aquesta característica) va de 0.025 a 0.047: Estam molt (“un 95%”) segurs que \\(p\\in [0.025,0.047]\\) (perquè la fórmula emprada per calcular aquest interval encerta en un 95% de les vegades) Estam molt segurs que \\(p&gt;0.02\\) (perquè tot l’interval on estam molt segurs que cau el valor real de \\(p\\) està a la dreta de 0.02) Estam molt segurs que \\(p\\neq 0.05\\) (perquè 0.05 no pertany a l’interval on estam molt segurs que cau el valor real de \\(p\\)) Però no estam molt segurs que \\(p=0.03\\), per molt que \\(0.03\\in [0.025,0.047]\\): estam molt segurs que \\(p\\) està entre 0.025 i 0.047, però no tenim cap seguretat que valgui un valor concret entre aquests límits, només que està entre aquests límits. Hi ha dos tipus de mètodes bàsics de càlcul d’intervals de confiança a partir d’una mostra aleatòria: Paramètrics: Usant alguna fórmula basada en la distribució mostral de l’estimador Es basen en teoremes Només serveixen si la variable aleatòria \\(X\\) i la mostra aleatòria satisfan (aproximadament) les hipòtesis del teorema No paramètrics: El més emprat és el bootstrap: De la mostra, es prenen a l’atzar moltes (milers) mostres aleatòries simples de la mateixa mida que la mostra, es calcula l’estimador amb cada una d’aquestes mostres i s’usa el vector de resultats per estimar un interval de confiança (per exemple, podríem prendre com a IC 95% l’interval entre els quantils 0.025 i 0.975 d’aquest vector) Es pot usar sempre (si la mostra és aleatòria) Empra un procés aleatori: en cada execució sobre les mateixes dades pot donar un interval diferent El bootstrap és una eina molt poderosa per calcular intervals de confiança i, en general, per estimar la distribució mostral d’un estadístic. Tant, que a la pràctica ja comença a substituir els mètodes paramètrics. Emperò no fa miracles: si la mostra és petita o molt poc representativa de la població, un IC calculat amb el bootstrap servei de tan poc com un de calculat amb un mètode paramètric. 4.2 Exemple: Interval de confiança del 95% per a la mitjana d’una variable aleatòria normal Una de les fórmules més conegudes per a intervals de confiança és la següent: Si \\(X\\sim N(\\mu,\\sigma)\\) i en tenim una mostra aleatòria simple de mida \\(n\\), mitjana mostral \\(\\overline{X}\\) i variància mostral \\(\\widetilde{S}^2_X\\), un IC 95% per a \\(\\mu\\) és \\[ \\Bigg[\\overline{X}-t_{n-1,0.975}\\cdot \\frac{\\widetilde{S}_X}{\\sqrt{n}},\\ \\overline{X}+t_{n-1,0.975}\\cdot\\frac{\\widetilde{S}_X}{\\sqrt{n}}\\Bigg] \\] on \\(t_{n-1,0.975}\\) indica el 0.975-quantil de la distribució \\(t_{n-1}\\). A alguns de vosaltres us hauran explicat a Batxillerat, o trobareu a llibres que consulteu, una fórmula per a l’IC 95% per a \\(\\mu\\) similar a aquesta, però canviant-hi la \\(\\widetilde{S}_X\\) per \\(\\sigma\\) i el \\(t_{n-1,0.975}\\) per \\(z_{0.975}\\). Aquesta altra fórmula només es pot fer servir si coneixeu la desviació típica poblacional \\(\\sigma\\), que a la pràctica, mai serà el cas. Per tant, per favor, oblidau-la. Anem a explicar d’on surt aquesta fórmula, ja que és un paradigma de com s’obtenen la majoria de les fórmules paramètriques per a intervals de confiança. Suposem doncs que \\(X\\sim N(\\mu,\\sigma)\\) i que en tenim una mostra aleatòria simple de mida \\(n\\), mitjana mostral \\(\\overline{X}\\) i variància mostral \\(\\widetilde{S}^2_X\\). En aquesta situació, sabem que \\[ T=\\frac{\\overline{X}-\\mu}{\\widetilde{S}_{X}/\\sqrt{n}} \\] té distribució t de Student amb \\(n-1\\) graus de llibertat, \\(t_{n-1}\\). Si podem trobar \\(A,B\\in \\mathbb{R}\\) tals que \\[ P(A\\leq T\\leq B)=0.95, \\] llavors: \\[ \\begin{array}{rl} 0.95 &amp; =P\\Bigg(A\\leq \\dfrac{\\overline{X}-\\mu}{\\widetilde{S}_{X}/\\sqrt{n}}\\leq B\\Bigg)\\\\[2ex] &amp; =P\\Bigg(A\\cdot \\dfrac{\\widetilde{S}_X}{\\sqrt{n}}\\leq \\overline{X}-\\mu \\leq B\\cdot \\dfrac{\\widetilde{S}_X}{\\sqrt{n}}\\Bigg)\\\\[2ex] &amp; =P\\Bigg(-\\overline{X}+A\\cdot \\dfrac{\\widetilde{S}_X}{\\sqrt{n}}\\leq -\\mu \\leq -\\overline{X}+B\\cdot \\dfrac{\\widetilde{S}_X}{\\sqrt{n}}\\Bigg)\\\\[2ex] &amp; =P\\Bigg(\\overline{X}-B\\cdot \\dfrac{\\widetilde{S}_X}{\\sqrt{n}}\\leq \\mu \\leq \\overline{X}-A\\cdot \\dfrac{\\widetilde{S}_X}{\\sqrt{n}}\\Bigg) \\end{array} \\] Com que \\(P(A\\leq T\\leq B)=0.95\\) significa que per al 95% de les mostres aleatòries simples de mida \\(n\\) el valor de \\(T\\) està entre \\(A\\) i \\(B\\), \\[ P\\Bigg(\\overline{X}-B\\cdot \\frac{\\widetilde{S}_X}{\\sqrt{n}}\\leq \\mu \\leq \\overline{X}-A\\cdot \\frac{\\widetilde{S}_X}{\\sqrt{n}}\\Bigg)=0.95 \\] significa que per al 95% de les mostres aleatòries simples de mida \\(n\\) la \\(\\mu\\) cau dins l’interval \\[ \\Bigg[\\overline{X}-B\\cdot \\frac{\\widetilde{S}_X}{\\sqrt{n}},\\ \\overline{X}-A\\cdot \\frac{\\widetilde{S}_X}{\\sqrt{n}}\\Bigg] \\] Per tant, això serà un IC 95% per a \\(\\mu\\). Ens falta trobar els \\(A,B\\) tals que \\(P(A\\leq T\\leq B)=0.95\\). Per trobar-los, emprarem quantils de la distribució de \\(T\\). Recordem que si indicam amb \\(t_{n-1,0.975}\\) el 0.975-quantil d’una \\(t_{n-1}\\), per definició tenim que \\[ P(T\\leq t_{n-1,0.975})=0.975 \\] i per la simetria de la \\(t\\), \\[ P(T\\leq -t_{n-1,0.975})=P(T\\geq t_{n-1,0.975})=0.025 \\] Per tant: \\[ \\begin{array}{l} P(-t_{n-1,0.975}\\leq T\\leq t_{n-1,0.975})\\\\ \\quad =P(T\\leq t_{n-1,0.975})-P(T\\leq -t_{n-1,0.975})\\\\ \\quad =0.975-0.025=0.95 \\end{array} \\] Així doncs, podem prendre \\[ A=-t_{n-1,0.975},\\quad B=t_{n-1,0.975} \\] i obtenim l’IC 95% per a \\(\\mu\\) anunciat: \\[ \\Bigg[\\overline{X}-t_{n-1,0.975}\\cdot \\frac{\\widetilde{S}_X}{\\sqrt{n}},\\ \\overline{X}+t_{n-1,0.975}\\cdot\\frac{\\widetilde{S}_X}{\\sqrt{n}}\\Bigg] \\] L’escriurem \\[ \\overline{X}\\pm t_{n-1,0.975}\\cdot \\frac{\\widetilde{S}_X}{\\sqrt{n}} \\] Exemple 4.2 Fem un experiment per veure que, efectivament, aquesta fórmula “encerta”, en el sentit que conté la \\(\\mu\\), al voltant del 95% de les vegades. Al bloc de codi següent: generam una Població de 107 “individus” que segueixen una llei normal estàndard i en calculam la mitjana mu; definim una funció IC que calcula l’IC 95% per a la mitjana \\(\\mu\\) amb la fórmula anterior; prenem 200 mostres aleatòries simples de mida 50 de la nostra població i les aplicam aquesta funció, obtenint una matriu M de 200 columnes formades pels dos extrems dels intervals (l’inferior a la primera filera i el superior a la segona filera); finalment, miram quantes vegades hem encertat, és a dir, a quantes columnes de M la mitjana poblacional mu està entre l’entrada de la primera filera i la de la segona. set.seed(42) Poblacio=rnorm(10^7) mu=mean(Poblacio) IC=function(x){ n=length(x) mean(x)+qt(0.975,n-1)*sd(x)/sqrt(n)*c(-1,1)} M=replicate(200,IC(sample(Poblacio,50,replace=TRUE))) Encerts=length(which(mu&gt;=M[1,] &amp; mu&lt;=M[2,])) Encerts ## [1] 189 Hem encertat 189 vegades, és a dir, un 94.5% de les vegades. És aproximadament el que esperàvem. Si ho provau amb altres llavors d’aleatorietat obtendreu altres resultats, de vegades millors, de vegades pitjors. Per veure millor els encerts, dibuixam els intervals en un gràfic, on apareixeran en gris els que encerten i en vermell els que no encerten. plot(1,type=&quot;n&quot;,xlim=c(-0.8,0.8),ylim=c(0,200), xlab=&quot;Valors&quot;,ylab=&quot;Repeticions&quot;, main=&quot;200 IC 95%&quot;) seg.int=function(i){color=&quot;grey&quot;; if((mu&lt;M[1,i]) | (mu&gt;M[2,i])){color=&quot;red&quot;} segments(M[1,i],i,M[2,i],i,col=color,lwd=2)} sapply(1:200,FUN=seg.int) abline(v=mu,lwd=2) Atenció! De mitjana, un IC Q% NO conté el valor real del paràmetre en un (100-Q)% de les ocasions. Per exemple, de mitjana, un 5% de les vegades que calculam un IC 95%, el paràmetre poblacional no pertany a l’interval obtingut. Per tant, si calculam \\(n\\) IC 95% sobre mostres aleatòries simples independents, el nombre de vegades que l’interval resultant no contendrà el paràmetre poblacional seguirà una distribució binomial \\(B(n,0.05)\\). El gràfic següent dóna el valor de \\(P(X\\geq 1)\\) per a una variable aleatòria \\(X\\) de tipus \\(B(n,0.05)\\), per a \\(n=0,...,100\\), i per tant la probabilitat que si calculam \\(n\\) IC 95% sobre mostres aleatòries simples independents, almenys un d’ells no contengui el paràmetre poblacional desitjat. plot(1-dbinom(0,0:100,0.05),pch=20,xlab=&quot;n&quot;,ylab=&quot;Probabilitat&quot;, main=&quot;Probabilitat d&#39;algun èxit en una B(n,0.05)&quot;) Tornant a l’IC 95% per a \\(\\mu\\) d’una variable normal donat per la fórmula \\[ \\overline{X}\\pm t_{n-1,0.975}\\cdot \\frac{\\widetilde{S}_X}{\\sqrt{n}} \\] fixau-vos que: Està centrat en \\(\\overline{X}\\), per tant en cada càlcul estarà centrat en la mitjana mostral Tal i com l’hem calculat, la probabilitat que \\(\\mu\\) caigui fora d’aquest interval es reparteix per igual als dos costats: un 2.5% de les vegades la \\(\\mu\\) poblacional estarà a l’esquerra de l’extrem inferior i un 2.5% de les vegades estarà a la dreta de l’extrem superior Exemple 4.3 En un experiment hem mesurat el percentatge d’augment d’alcohol en sang a 40 persones després de prendre 4 canyes de cervesa. La mitjana i la desviació típica mostral d’aquests percentatges d’increment han estat \\[ \\overline{x}=41.2,\\quad \\widetilde{s}=2.1 \\] Per calcular un IC 95% per al percentatge mitjà d’augment, suposarem que la variable aleatòria d’interès (de la que volem estimar la mitjana) \\(X\\): “Prenem una persona i li mesuram el percentatge d’augment d’alcohol en sang després de prendre 4 canyes de cervesa” és normal i que la mostra que hem pres d’aquesta variable és aleatòria simple. Llavors, com que \\(t_{n-1,0.975}\\)=qt(0.975,39)=2.0227, un IC 95% és \\[ 41.2\\pm 2.0227\\cdot \\frac{2.1}{\\sqrt{40}}\\Rightarrow 41.2\\pm 0.67\\Rightarrow [40.53, 41.87] \\] Per tant, estimam amb un 95% de confiança que el percentatge mitjà d’augment d’alcohol en sang després de prendre 4 canyes de cervesa està entre el 40.53% i el 41.87%. Per calcular l’interval anterior hem suposat que la variable poblacional “Percentatge d’augment d’alcohol en sang després de prendre 4 canyes de cervesa” segueix una distribució normal. I si no fos normal? En aquest cas, com que \\(n=40\\), és gran pel Teorema 4.2 de la propera secció l’interval obtingut segueix essent (aproximadament) un interval de confiança del 95% per a \\(\\mu\\) Si \\(n\\) fos petit i \\(X\\) molt diferent d’una normal, no es pot usar aquesta fórmula i cal buscar-se la vida (per exemple, emprar el mètode de bootstrap) També hem suposat que era una mostra aleatòria simple. I si no ho és? Si és aleatòria, com que el nombre de persones que poden prendre 4 canyes de cervesa és pràcticament la població mundial, molt gran, a efectes pràctics la podem considerar simple. Però segur que no és aleatòria, sinó oportunista. No hem tret per sorteig de la llista de tota la població mundial, ni tan sols de la de Mallorca, 40 persones i les hem fetes prendre 4 cerveses, sinó que hem cercat voluntaris. En aquest cas no podem fer res per salvar la fórmula, i la seva validesa depèn de si la mostra de persones presa pot passar per aleatòria o no. 4.3 Interval de confiança per a la mitjana basat en la t de Student A partir d’ara, per tal d’evitar ambigüitats, a les fórmules hi expressarem el nivell de confiança dels intervals en tant per u, no en tant per cent; és a dir, com una proporció en comptes de com un percentatge. Per tant, parlarem d’intervals de confiança de nivell de confiança \\(q\\), amb \\(q\\) entre 0 i 1, en lloc d’intervals de confiança del \\(Q\\%\\) amb \\(Q=100q\\). Amb aquestes notacions, per exemple, els intervals de confiança del 95% seran intervals de confiança de nivell de confiança 0.95. La fórmula El mateix argument que abans, canviant 0.95 per \\(q\\) dóna: Teorema 4.1 Si \\(X\\sim N(\\mu,\\sigma)\\) i en prenem una mostra aleatòria simple de mida \\(n\\), un interval de confiança de nivell de confiança \\(q\\) (en tant per u) per a \\(\\mu\\) és \\[ \\overline{X}\\pm t_{n-1,(1+q)/2}\\cdot \\frac{\\widetilde{S}_X}{\\sqrt{n}} \\] Fixau-vos que als IC 95%, \\(q=0.95\\) i per tant \\((1+q)/2=1.95/2=0.975\\). Usant el Teorema Central del Límit i algunes aproximacions, tenim el següent resultat: Teorema 4.2 Sigui \\(X\\) una variable aleatòria qualsevol de mitjana poblacional \\(\\mu\\). Suposem que prenem una mostra aleatòria simple de \\(X\\) de mida \\(n\\) gran (diguem, de 40 o més elements). Llavors, un interval de confiança de nivell de confiança \\(q\\) per a \\(\\mu\\) és aproximadament \\[ \\overline{X}\\pm t_{n-1,(1+q)/2}\\cdot \\frac{\\widetilde{S}_X}{\\sqrt{n}} \\] L’aproximació del teorema anterior és millor com més gran sigui \\(n\\) o com més propera a una normal sigui la variable poblacional \\(X\\). En resum: Podem emprar la fórmula per a l’interval de confiança de nivell de confiança \\(q\\) per a la mitjana poblacional basada en la t de Student \\[ \\overline{X}\\pm t_{n-1,(1+q)/2}\\cdot \\frac{\\widetilde{S}_X}{\\sqrt{n}} \\] quan la variable poblacional és normal o quan la mostra aleatòria simple és gran. Exemple 4.4 L’empresa RX-print ofereix una impressora de radiografies d’altíssima qualitat. En la seva publicitat afirma que els seus cartutxos imprimeixen una mitjana de 500 radiografies amb l’especificació: Dades tècniques: Mostra de mida \\(n=25\\), població suposada normal, nivell de confiança del 90% Uns radiòlegs desitgen comprovar aquestes afirmacions i prenen una mostra de cartutxos a l’atzar de mida \\(n=25\\), obtenint una mitjana de \\(\\overline{x}=518\\) radiografies i una desviació típica mostral \\(\\widetilde{s}=39.9\\). Amb aquesta mostra, la mitjana poblacional anunciada pel fabricant cau dins l’interval de confiança del 90%? La variable aleatòria d’interès és \\(X\\) és “Prenem un cartutxo d’aquesta empresa i miram el nombre de radiografies que permet imprimir”, de mitjana \\(\\mu\\) per a la qual volem calcular un IC 90%. Suposarem que la variable \\(X\\) és normal, perquè l’empresa ho suposa a les dades tècniques. Per tant podem emprar la fórmula \\[ \\overline{x}\\pm t_{n-1,(q+1)/2} \\frac{\\widetilde{s}}{\\sqrt{n}} \\] on \\(n=25\\), \\(\\overline{x}=518\\), \\(\\widetilde{s}=39.9\\), \\(q=0.9\\), \\((q+1)/2=0.95\\) i \\(t_{24,0.95}\\)=qt(0.95,24)\\(=1.71\\). Operant: \\[ 518\\pm 1.71\\times \\frac{39.9}{\\sqrt{25}}\\Rightarrow 518\\pm 13.65\\Rightarrow [504.35,531.65] \\] Tenim, doncs, un 95% de confiança que el nombre mitjà de radiografies per cartutxo està entre 504.35 i 531.65, i en particular que no és 500 (però en benefici del consumidor: estam molt segurs que és més gran que 500). Exemple 4.5 A l’exemple anterior hem suposat que la variable aleatòria era normal. Què passaria si fos molt diferent d’una normal? Com que \\(n=25\\) no és prou gran, en principi no podríem aplicar la fórmula de l’interval de confiança basada en la t de Student. Emprarem el mètode del bootstrap, per a la qual cosa necessitam tenir les dades originals, i no només els seus estadístics. Tenim aquestes dades en el vector Radios següent: Radios=c(485,511,509,509,561,529,458,532,545,546, 503,577,547,477,507,548,480,444,461,573, 513,604,542,501,488) mean(Radios) ## [1] 518 sd(Radios) ## [1] 39.8999 Prenem 5000 mostres aleatòries simples de mida 25 (la mateixa mida que el conjunt de dades original) de les dades i calculam la mitjana de cada mostra; fixam la llavor d’aleatorietat per que el càlcul sigui reproduïble: set.seed(100) Simulacions=replicate(5000,mean(sample(Radios,25,rep=TRUE))) Ara prenem com a IC 90% l’interval que tanca el 90% de valors centrals d’aquest vector de mitjanes mostrals, és a dir, l’interval que va del quantil 0.05 al quantil 0.95 d’aquest vector de mitjanes: quantile(Simulacions,c(0.05,0.95)) ## 5% 95% ## 504.96 530.92 Obtenim l’interval [504.96,530.92]: amb la fórmula basada en la t de Student, havíem obtingut l’interval [504.35,531.65]. Algunes consideracions Observau que l’estructura de l’interval de confiança de nivell de confiança \\(q\\) per a \\(\\mu\\) donat al Teorema 4.2 és \\[\\begin{align} &amp; \\text{estimador}\\nonumber\\\\ &amp; \\qquad \\pm \\frac{1+q}{2}\\text{-quantil de la distr. mostral}\\times \\text{error típic de l&#39;estimació} \\tag{4.1} \\end{align}\\] Aquesta estructura és molt típica (tot i que, com veurem, no tots els intervals de confiança paramètrics tenen aquesta forma) i satisfà que: L’interval de confiança està centrat en el valor de l’estimador La “probabilitat d’equivocar-nos” es reparteix per igual als dos costats de l’interval: una fracció \\(q/2\\) de les vegades el paràmetre estarà a l’esquerra de l’extrem inferior i una fracció \\(q/2\\) de les vegades estarà a la dreta de l’extrem superior A més, tenim que: Per a una mateixa mostra i una mateixa fórmula (paramètrica) per calcular l’interval de confiança, si el nivell de confiança creix, l’interval s’eixampla Això és general, per a tots els intervals de confiança paramètrics. La idea intuitiva és que, per estar més segurs que un interval conté un valor, l’interval ha de ser més ample. A un interval de confiança amb l’estructura (4.1), el motiu matemàtic és que si \\(q\\) creix, el quantil d’ordre (1+\\(q\\))/2 de la distribució mostral creix. Per exemple, a l’Exemple 4.3, teníem \\(n=40\\), \\(\\overline{x}=41.2\\) i \\(\\widetilde{s}=2.1\\): L’IC 95% té \\(q=0.95\\), per tant \\(t_{n-1,(1+q)/2}=t_{39,0.975}=2.02\\), i donava \\[ 41.2\\pm 2.02\\cdot \\frac{2.1}{\\sqrt{40}}\\Rightarrow 41.2\\pm 0.67 \\] L’IC 99% té \\(q=0.99\\), per tant \\(t_{n-1,(1+q)/2}=t_{39,0.995}=2.71\\), i dóna \\[ 41.2\\pm 2.71\\cdot \\frac{2.1}{\\sqrt{40}}\\Rightarrow 41.2\\pm 0.9 \\] més ample Però si canviam de mostra (o de fórmula, si n’hi ha més d’una) per calcular l’interval de confiança, pot passar qualsevol cosa. Amb R La funció t.test(X,conf.level=...)$conf.int calcula l’interval de confiança basat en la t de Student per a la \\(\\mu\\) de la variable aleatòria de la que el vector X n’és una mostra. El paràmetre conf.level permet especificar el nivell de confiança (en tant per u). El seu valor per defecte és 0.95, així que per calcular un IC 95% no cal especificar-lo. Per exemple, l’IC 90% per al nombre mitjà de radiografies per cartutxo de l’Exemple 4.4 es calcularia amb t.test(Radios,conf.level=0.9)$conf.int ## [1] 504.347 531.653 ## attr(,&quot;conf.level&quot;) ## [1] 0.9 Càlcul de la mida de la mostra per fixar l’error Recordem que l’interval de confiança de nivell de confiança \\(q\\) per a \\(\\mu\\) basat en la t de Student \\[ \\overline{X}\\pm t_{n-1,(1+q)/2}\\cdot \\frac{\\widetilde{S}_X}{\\sqrt{n}} \\] és simètric i centrat en \\(\\overline{X}\\). La seva amplada és la diferència entre els seus extrems \\[ 2t_{n-1,(1+q)/2}\\times \\frac{\\widetilde{S}_X}{\\sqrt{n}} \\] El marge d’error (error, precisió) \\(M\\) en l’estimació de \\(\\mu\\) per mitjà d’aquest interval de confiança és el que sumam i restam a \\(\\overline{X}\\) per obtenir l’interval, és a dir, la meitat de la seva amplada: \\[ M=t_{n-1,(1+q)/2}\\times \\frac{\\widetilde{S}_X}{\\sqrt{n}} \\] Fixau-vos que si estimam que el valor de \\(\\mu\\) és \\(\\overline{X}\\), l’error que cometem és \\(|\\overline{X}-\\mu|\\). Aleshores, si el nostre interval de confiança per a \\(\\mu\\) és \\(\\overline{X}\\pm M\\) i l’encertam (és a dir, aquest interval conté el valor real de \\(\\mu\\)), aleshores l’error que cometem quan diem que el valor de \\(\\mu\\) és \\(\\overline{X}\\) és com a màxim \\(M\\), perquè si \\(\\mu\\in [\\overline{X}-M,\\overline{X}+M]\\), aleshores \\(|\\overline{X}-\\mu|\\leq M\\). Una pregunta típica a l’hora de planejar un experiment és quina ha de ser la mida de la mostra que hem de prendre per que el marge d’error en estimar \\(\\mu\\) amb un nivell de confiança donat sigui com a màxim un cert valor desitjat \\(M_{max}\\). És a dir, volem trobar la \\(n\\) més petita tal que \\[ t_{n-1,(1+q)/2}\\times \\frac{\\widetilde{S}_X}{\\sqrt{n}}\\leq M_{max}. \\] Però fixau-vos que en aquesta desigualtat la \\(n\\) hi apareix al quantil i a l’error típic, i a més la \\(\\widetilde{S}_X\\) depèn de la mostra. El que farem per respondre la pregunta serà fer algunes trampes: Aproximarem la t de Student per una normal estàndard (ja que segurament la \\(n\\) haurà de ser gran): \\[ t_{n-1,(1+q)/2}\\rightsquigarrow z_{(1+q)/2} \\] Estimarem el valor de \\(\\widetilde{S}_X\\) mitjançant la desviació típica mostral \\(\\widetilde{S}_0\\) d’una prova pilot (un experiment anterior, realitzat per nosaltres o publicat per qualcú altre a qualque lloc de confiança) D’aquesta manera, aproximam l’error \\(M\\) per mitjà de \\[ M\\approx z_{(1+q)/2}\\times \\frac{\\widetilde{S}_0}{\\sqrt{n}} \\] I ara si imposam que \\(M\\leq M_{max}\\), ja podem aïllar la \\(n\\): \\[ z_{(1+q)/2}\\times \\frac{\\widetilde{S}_0}{\\sqrt{n}}\\leq M_{max}\\Longrightarrow n\\geq \\left(\\frac{ z_{(1+q)/2}\\cdot \\widetilde{S}_0}{M_{max}} \\right)^2 \\] En resum: Teorema 4.3 Per estimar la \\(\\mu\\) amb nivell de confiança \\(q\\) amb un marge d’error com a màxim \\(M_{max}\\) mitjançant la fórmula basada en la t de Student, prendrem una mostra de mida \\[ n\\geq \\left(\\frac{ z_{(1+q)/2}\\cdot \\widetilde{S}_0}{M_{max}} \\right)^2, \\] on \\(\\widetilde{S}_0\\) és la desviació típica mostral obtinguda en una estimació anterior de \\(\\mu\\) (en una prova pilot). Naturalment, quan després prenguem una mostra de mida \\(n\\) que satisfaci aquesta condició, pot passar qualsevol cosa, ja que hem emprat els resultats d’una mostra per estimar la desviació típica d’una altra mostra i a més hem aproximat els quantils de la t de Student per els d’una normal estàndard, que són més petits. Però almenys haurem fet tot el que haurem pogut per fitar l’error dins el marge desitjat. Exemple 4.6 A l’Exemple 4.3, hem emprat una mostra de \\(n=40\\) persones, amb \\(\\overline{x}=41.2\\) i \\(\\widetilde{s}=2.1\\), i l’error ha estat \\[ t_{0.975,39}\\cdot \\frac{2.1}{\\sqrt{40}}=0.67 \\] Quin és el nombre mínim de persones que hauríem hagut d’emprar per estimar la mitjana amb un nivell de confiança del 95% i un error de (com a màxim) 0.5? És a dir, quin el nombre mínim de persones que hauríem hagut d’emprar per obtenir un IC 95% d’amplada (com a màxim) 1? Empram l’exemple com a prova pilot: \\[ n\\geq \\left(\\frac{ z_{(1+q)/2}\\cdot \\widetilde{s}}{M_{max}} \\right)^2= \\left(\\frac{1.96\\cdot 2.1}{0.5} \\right)^2=67.77 \\] El valor de \\(n\\) més petit que satisfà aquesta condició és 68, per tant aquest és el nombre mínim de persones que hauríem hagut d’emprar per esperar obtenir un IC 95% d’amplada (com a màxim) 1. 4.4 Intervals de confiança per a proporcions Suposem que tenim una variable Bernoulli \\(X\\) amb probabilitat d’èxit \\(p_X\\) desconeguda. Volem calcular un interval de confiança per a \\(p_X\\). Per fer-ho, prenem una mostra aleatòria simple de \\(X\\) de mida \\(n\\), amb nombre d’èxits \\(S\\) i per tant proporció mostral d’èxits \\(\\widehat{p}_{X}=S/n\\) Explicarem tres mètodes per calcular aquest interval de confiança: El mètode exacte de Clopper-Pearson, que es pot aplicar sempre però sol donar intervals de confiança més amples del necessari. El mètode aproximat de Wilson, que es pot emprar quan la mostra és gran, posem de mida 40 o més, i es basa en el fet que, pel Teorema Central del Límit, la proporció mostral de mostres aleatòries simples segueix una distribució aproximadament normal. El mètode aproximat de Laplace, que és una simplificació del mètode de Wilson, però només es pot emprar quan la mostra és bastant més gran, posem de mida 100 o més, i la proporció mostral \\(\\widehat{p}_{X}\\) no és molt propera a 0 o a 1. És el mètode més clàssic i conegut. Mètode “exacte” de Clopper-Pearson Aquest mètode es basa en el fet que el nombre d’èxits \\(S\\) en mostres aleatòries simples de mida \\(n\\) de \\(X\\) segueix una distribució binomial \\(B(n,p_X)\\). Raonant de manera similar a com obteníem l’interval per a \\(\\mu\\) basat en la t de Student (us estalviarem els detalls) arribam a la fórmula següent: Teorema 4.4 Un interval de confiança de nivell de confiança \\(q\\) per a \\(p_X\\) és \\([p_0,p_1]\\), on (recordau que \\(n\\) indica la mida de la mostra i \\(S\\) el nombre d’èxits) \\(p_0\\) és la solució de l’equació \\[ \\sum_{k=S}^n\\binom{n}{k}p_0^k(1-p_0)^{n-k}= \\frac{1-q}{2} \\] \\(p_1\\) és la solució de l’equació \\[ \\sum_{k=0}^S\\binom{n}{k}p_1^k(1-p_1)^{n-k}= \\frac{1-q}{2} \\] Calcular a mà aquest interval és intractable, i en general dóna més ample del necessari (degut a la natura discreta de la distribució binomial, que només pren valors nombres naturals), però es pot emprar amb mostres aleatòries simples de qualsevol mida ja que empra que el nombre d’èxits \\(S\\) en mostres aleatòries simples de mida \\(n\\) de \\(X\\) segueix una distribució binomial i això sempre és veritat. Per calcular-lo amb R, podeu emprar la funció del paquet epitools binom.exact(S,n,conf.level=...) on Sés el nombre d’èxits, n la mida de la mostra, i conf.level el nivell de confiança en tant per u, que per defecte val 0.95. Exemple 4.7 De 10 pacients tractats amb un medicament, 2 s’han curat. Quin seria un IC 95% per a la proporció p de pacients que aquest medicament cura? Emprarem el mètode de Clopper-Pearson: library(epitools) round(binom.exact(2,10),3) ## x n proportion lower upper conf.level ## 1 2 10 0.2 0.025 0.556 0.95 Dóna l’interval [0.025,0.556]. Estimam per tant amb una confiança del 95% que aquest medicament cura entre el 2.5% i el 55.6% dels pacients. Sí, aquest interval és molt ample. La culpa no és del mètode de Clopper-Pearson, és de la mida petita de la mostra. L’interval de Clopper-Pearson té l’inconvenient que, en general, no està centrat en \\(\\widehat{p}_{X}\\). Per exemple, el centre de l’interval anterior és \\((0.025+0.556)/2= 0.29\\), diferent de \\(\\widehat{p}_X=0.2\\) Mètode de Wilson Suposem ara que prenem una mostra aleatòria simple de \\(X\\) de mida \\(n\\) gran (posem, de 40 o més subjectes) i proporció mostral d’èxits \\(\\widehat{p}_{X}\\). En aquestes condicions, pel Teorema Central del Límit, \\[ Z=\\dfrac{\\widehat{p}_{X}-p_X} {\\sqrt{\\frac{p_X(1-p_X)}{n}}}\\approx N(0,1) \\] Per tant \\[ P\\Big(-z_{(1+q)/2}\\leq \\dfrac{\\widehat{p}_{X}-p_X} {\\sqrt{\\frac{p_X(1-p_X)}{n}}}\\leq z_{(1+q)/2}\\Big)=q \\] Aïllant \\(p_X\\) obtenim: Teorema 4.5 Si la mida \\(n\\) de la mostra és gran, un interval de confiança de nivell de confiança \\(q\\) per a \\(p_X\\) és (aproximadament): \\[ \\frac{\\widehat{p}_{X}+\\frac{z_{(1+q)/{2}}^2}{2n}\\pm z_{(1+q)/{2}}\\sqrt{\\frac{\\widehat{p}_{X}(1-\\widehat{p}_{X})}{n}+\\frac{z_{(1+q)/{2}}^2}{4n^2}}}{1+\\frac{z_{(1+q)/{2}}^2}{n}} \\] Amb R es calcula amb la funció binom.wilson(x,n,conf.level=...) del paquet epitools, amb la mateixa sintaxi que binom.exact. Aquest interval també té l’inconvenient que, si us hi fixau, no està centrat en \\(\\widehat{p}_{X}\\): el seu centre és \\[ \\frac{\\widehat{p}_{X}+\\frac{z_{(1+q)/{2}}^2}{2n}}{1+\\frac{z_{(1+q)/{2}}^2}{n}} \\] Mètode de Laplace Suposem finalment que prenem una mostra aleatòria simple de \\(X\\) de mida \\(n\\) encara més gran i \\(\\widehat{p}_{X}\\) enfora de 0 i 1. Per fixar idees, suposem que \\[ n\\geq 100,\\ n\\widehat{p}_{X}\\geq 10,\\ n(1-\\widehat{p}_{X})\\geq 10 \\] En aquest cas, a la fórmula de l’interval de Wilson podem suposar que els termes \\(z_{(1+q)/{2}}^2/n\\) són (aproximadament) 0 i obtenim la fórmula següent: Teorema 4.6 En les condicions explicades, un interval de confiança de nivell de confiança \\(q\\) per a \\(p_X\\) és (aproximadament): \\[ \\widehat{p}_{X}\\pm z_{(q+1)/2}\\sqrt{\\frac{\\widehat{p}_{X} (1-\\widehat{p}_{X})}{n}} \\] Amb R es calcula amb la funció binom.approx(x,n,conf.level=...) del paquet epitools, amb la mateixa sintaxi que binom.exact. Aquesta fórmula és la més popular, amb més de 200 anys de rodatge. Us heu de saber la fórmula de Laplace, no cal saber les fórmules dels altres dos intervals. Més exemples Exemple 4.8 En una mostra aleatòria de 500 famílies amb nins en edat escolar es va trobar que 340 introduïen fruita diàriament en la dieta dels seus fills. A partir d’aquestes dades, volem calcular un interval de confiança del 95% per a la proporció real de famílies d’aquesta ciutat amb nins en edat escolar que incorporen fruita fresca cada dia en la dieta dels seus fills. Diguem \\(X\\) a la variable aleatòria “Prenem una família amb nins en edat escolar i miram si inclou diàriament fruita a la dieta dels fills”. És Bernoulli, diguem \\(p_X\\) a la seva probabilitat d’èxit: la probabilitat que una família amb nins en edat escolar inclogui diàriament fruita a la dieta dels fills. Cercam un interval de confiança del 95% per a \\(p_X\\). Com que \\(n=500\\geq 100\\), \\(n\\widehat{p}_X=340\\geq 10\\) i \\(n(1-\\widehat{p}_X)=160\\geq 10\\), podem emprar la fórmula de Laplace \\[ \\widehat{p}_{X}\\pm z_{(q+1)/2}\\sqrt{\\frac{\\widehat{p}_{X} (1-\\widehat{p}_{X})}{n}} \\] amb \\(n=500\\), \\(\\widehat{p}_{X}=340/500=0.68\\) i \\(z_{(q+1)/2}=z_{0.975}=1.96\\). Dóna \\[ 0.68\\pm 1.96\\sqrt{\\frac{0.68(1-0.68)}{500}}\\Rightarrow [0.639,0.721] \\] Amb R: round(binom.approx(340,500), 3) ## x n proportion lower upper conf.level ## 1 340 500 0.68 0.639 0.721 0.95 Amb els altres mètodes, que també podríem aplicar en aquest cas, obtenim els intervals: round(binom.exact(340,500),3) ## x n proportion lower upper conf.level ## 1 340 500 0.68 0.637 0.721 0.95 round(binom.wilson(340,500),3) ## x n proportion lower upper conf.level ## 1 340 500 0.68 0.638 0.719 0.95 En resum, estimam que entre aproximadament un 64% i un 72% de les famílies d’aquesta ciutat amb nins en edat escolar inclouen diàriament fruita fresca en la dieta dels seus fills. Quan podem calcular més d’un interval per a \\(p_X\\), quin calculam? D’entrada cal dir que si podem calcular més d’un interval, segurament donaran molt parescuts, com heu pogut comprovar a l’exemple anterior. A més, recordau que les tres fórmules només ens donen “un nivell de confiança q” si s’apliquen a mostres aleatòries simples, i les nostres mostres gairebé sempre seran oportunistes, cas en el qual, si ens posam perepunyetes, no en podem aplicar cap. Però en tot cas, si no filam molt prim i podem triar, hem de tenir en compte que: L’interval de Clopper-Pearson és exacte, no empra cap aproximació, però: Tendeix a donar un interval més ample del necessari No està centrat en la proporció mostral Només és un interval “exacte” si la mostra és aleatòria simple, cosa que gairebé sempre serà fals (com a molt, serà “aproximadament” aleatòria simple) Com que no es pot calcular “a mà”, no és molt popular L’interval de Wilson és aproximat, fa servir l’aproximació a la normal donada pel Teorema Central del Límit. Això no és un gran emperò, pequè tanmateix segurament la mostra serà com a molt “aproximadament” aleatòria simple. Ara bé, tampoc no està centrat en la proporció mostral, i ens agrada poder donar els intervals en la forma “tal més menys qual” perquè d’aquesta manera donam l’estimació puntual i el marge d’error. L’interval de Laplace és molt aproximat, però: Forma part de la cultura general del científic, tothom el coneix És l’únic centrat en la proporció mostral Exemple 4.9 En un assaig d’un nou tractament de quimioteràpia, en una mostra de \\(n\\) malalts tractats, cap desenvolupà càncer testicular com a efecte secundari. Quin seria un interval de confiança al 95% per a la proporció de malalts tractats amb aquesta quimio que desenvolupen càncer testicular? Per calcular-lo podem emprar el mètode de Clopper-Pearson i, si \\(n\\) és gran, el de Wilson. No podem emprar la fórmula de Laplace, perquè \\(\\widehat{p}_X=0\\). Pel que fa a Clopper-Pearson, aquest és un dels pocs casos que admeten solució analítica senzilla: dóna l’interval \\[ \\Big[0,1-\\Big(\\frac{1-q}{2}\\Big)^{1/n}\\Big] \\] que, si \\(q=0.95\\), queda \\[ [0,1-0.025^{1/n}]. \\] Per exemple, si \\(n=40\\) binom.exact(0,40) ## x n proportion lower upper conf.level ## 1 0 40 0 0 0.0880973 0.95 1-0.025^(1/40) ## [1] 0.0880973 Si podem emprar el mètode de Wilson, la fórmula \\[ \\frac{\\widehat{p}_{X}+\\frac{z_{(q+1)/2}^2}{2n}\\pm z_{(q+1)/2}\\sqrt{\\frac{\\widehat{p}_{X}(1-\\widehat{p}_{X})}{n}+\\frac{z_{(q+1)/2}^2}{4n^2}}}{1+\\frac{z_{(q+1)/2}^2}{n}} \\] amb \\(\\widehat{p}_{X}=0\\) i \\(z_{(1+q)/2}=1.96\\) dóna \\[ \\frac{\\frac{1.96^2}{2n}\\pm 1.96\\sqrt{\\frac{1.96^2}{4n^2}}}{1+\\frac{1.96^2}{n}}\\Longrightarrow \\Big[0,\\frac{1.96^2}{n+1.96^2}\\Big] \\] Per exemple, un altre cop amb \\(n=40\\) binom.wilson(0,40) ## x n proportion lower upper conf.level ## 1 0 40 0 6.3309e-18 0.0876216 0.95 qnorm(0.975)^2/(40+qnorm(0.975)^2) ## [1] 0.0876216 Quan s’ha de calcular “a ull” un interval de confiança del 95% per a una probabilitat \\(p_X\\) a partir d’una mostra aleatòria simple on no hi ha hagut cap èxit, sovint es fa servir la regla següent: Regla del 3: Quan en una mostra aleatòria simple de mida \\(n\\) d’una variable aleatòria de Bernoulli de paràmetre \\(p_X\\) no hi trobam cap èxit, un IC 95% per a \\(p_X\\) va, aproximadament, de 0 a \\(3/n\\). Amb aquesta regla, en el nostre exemple amb \\(n=40\\) obtendríem l’interval [0,3/40]=[0,0.075], no molt enfora del [0,0.088] que hem obtingut amb els altres dos mètodes. Per veure com la regla del 3 aproxima l’interval de Clopper-Pearson, el gràfic següent mostra els valors \\(3/n\\) i l’extrem superior de l’IC 95% de Clopper-Pearson a partir d’una mostra de mida \\(n\\) amb 0 èxits: f=function(n){binom.exact(0,n)$upper} plot(1:100,sapply(1:100,f),pch=20,cex=0.7,xlab=&quot;n&quot;,ylab=&quot;Extrem superior&quot;, main=&quot;Extrem superior d&#39;un IC 95% en cas de 0 èxits&quot;) curve(3/x,col=&quot;red&quot;,lwd=2,add=TRUE) legend(&quot;topright&quot;,lty=c(NA,1),pch=c(20,NA), legend=c(&quot;Clopper-Pearson&quot;,&quot;Regla del 3&quot;),col=c(&quot;black&quot;,&quot;red&quot;),cex=0.7) El gràfic següent mostra els valors \\(3/n\\) i els extrems superiors dels IC 95% de Clopper-Pearson i de Wilson a partir d’una mostra de mida \\(n\\) (\\(n\\geq 40\\) per als intervals de confiança de Wilson) amb 0 èxits: f=function(n){binom.exact(0,n)$upper} plot(1:100,sapply(1:100,f),pch=20,cex=0.5,xlab=&quot;n&quot;,ylab=&quot;Extrem superior&quot;, main=&quot;Extrem superior d&#39;un IC 95% en cas de 0 èxits&quot;) curve(3/x,col=&quot;red&quot;,lwd=1.5,add=TRUE) points(40:100,3.84/(40:100+3.84),pch=20,cex=0.5,col=&quot;blue&quot;) legend(&quot;topright&quot;,lty=c(NA,NA,1),pch=c(20,20,NA), legend=c(&quot;Clopper-Pearson&quot;,&quot;Wilson&quot;,&quot;Regla del 3&quot;),col=c(&quot;black&quot;,&quot;blue&quot;,&quot;red&quot;),cex=0.7) Els extrems superiors dels intervals de Clopper-Pearson i Wilson se superposen en aquest darrer gràfic. Exemple 4.10 En un assaig d’un tractament de quimioteràpia, en una mostra de 100 pacients tractats, 25 desenvoluparen càncer testicular secundari. Volem calcular un IC 95% per a la proporció de pacients tractats amb aquesta quimioteràpia que desenvolupen càncer testicular. En aquest cas podem emprar els tres mètodes: round(binom.exact(25,100),4) ## x n proportion lower upper conf.level ## 1 25 100 0.25 0.1688 0.3466 0.95 round(binom.wilson(25,100),4) ## x n proportion lower upper conf.level ## 1 25 100 0.25 0.1755 0.343 0.95 round(binom.approx(25,100),4) ## x n proportion lower upper conf.level ## 1 25 100 0.25 0.1651 0.3349 0.95 Concloem, amb un nivell de confiança del 95%, que entre aproximadament un 17% i un 34% dels pacients tractats amb aquesta quimioteràpia desenvolupen càncer testicular. Càlcul de la mida de la mostra per a fixar l’error L’error de l’interval de confiança de Laplace és \\[ M= z_{(q+1)/2} \\sqrt{\\frac{\\widehat{p}_{X} (1-\\widehat{p}_{X})}{n}} \\] perquè l’interval de confiança de Laplace és \\(\\widehat{p}_X\\pm M\\) i per tant, si conté el valor real de \\(p_X\\), l’error \\(|\\widehat{p}_X-p_X|\\) que cometem quan diem que el valor de \\(p_X\\) és \\(\\widehat{p}_X\\) és com a màxim \\(M\\). No podem determinar la mida de la mostra a fi que l’interval de confiança tingui un error màxim sense conèixer \\(\\widehat{p}_{X}\\), que no coneixem sense una mostra. Però en el cas de l’interval de Laplace per a una proporció, podem donar un \\(n\\) que garanteixi una amplada màxima donada valgui el que valgui \\(\\widehat{p}_{X}\\in [0,1]\\). Fixau-vos que la funció \\(y=p (1-p)\\), amb \\(p\\in [0,1]\\), és una paràbola còncava amb vèrtex al punt \\(p=0.5\\) curve(x*(1-x),xlim=c(0,1),xlab=&quot;p&quot;,ylab=&quot;&quot;) abline(v=0.5,lty=&quot;dashed&quot;) Per tant, el seu màxim s’assoleix a \\(p=0.5\\). Així, doncs \\[ \\widehat{p}_{X} (1-\\widehat{p}_{X})\\leq 0.5(1-0.5)=0.5^2\\text{ per a tot $\\widehat{p}_X\\in[0,1]$} \\] i per tant \\[ \\begin{array}{l} \\displaystyle M=z_{(q+1)/2} \\sqrt{\\frac{\\widehat{p}_{X} (1-\\widehat{p}_{X})}{n}}\\\\ \\qquad\\displaystyle \\leq z_{(q+1)/2}\\sqrt{\\frac{0.5^2}{n}}=\\frac{0.5z_{(q+1)/2}}{\\sqrt{n}}=\\frac{z_{(q+1)/2}}{2\\sqrt{n}} \\end{array} \\] D’aquesta manera, si prenem \\(n\\) tal que \\[ \\frac{z_{(q+1)/2}}{2\\sqrt{n}}\\leq M_{max} \\] aleshores segur que \\(M\\leq M_{max}\\), valgui el que valgui \\(\\widehat{p}_{X}\\). Per tant, el que farem serà calcular la \\(n\\) per obtenir un error com a màxim \\(M_{max}\\) en el cas més desfavorable: quan l’interval és el més ample possible, és a dir, suposant que \\(\\widehat{p}_{X}=0.5\\): \\[ M_{max}\\geq \\frac{z_{(q+1)/2}}{2\\sqrt{n}} \\Rightarrow n\\geq \\left(\\frac{z_{(q+1)/2}}{2\\cdot M_{max}}\\right)^2 \\] En resum: Teorema 4.7 Si \\[ n\\geq \\left(\\frac{z_{(q+1)/2}}{2\\cdot M_{max}}\\right)^2, \\] l’error de l’interval de Laplace calculat amb una mostra de mida \\(n\\) sempre serà com a molt \\(M_{max}\\). Exemple 4.11 Quina és la mida més petita d’una mostra que ens garanteix un error de com a màxim 0.05 en estimar una proporció \\(p_X\\) emprant un interval de confiança de Laplace del 95%? Pel teorema anterior, per garantir un error de 0.05 en calcular un IC 95% per una proporció \\(p_X\\) emprant la fórmula de Laplace, hem d’emprar una mostra de mida \\(n\\) tal que \\[ n\\geq \\Bigg(\\frac{z_{(1+q)/2}}{2M_{max}}\\Bigg)^2=\\Bigg(\\frac{1.96}{0.1}\\Bigg)^2=384.16 \\] La mida més petita que satisfà aquesta condició és \\(n=385\\). La resposta correcta no és 384, per molt que 384.16 s’arrodoneixi a 384. Fixau-vos que 384 no és més gran que 384.16. Observau tres coses: El valor de \\(n\\) només depèn de la precisió i del nivell de confiança, no de la natura de l’estudi ni de proves pilot Tal i com hem trobat la \\(n\\), estam segurs que si prenem una mostra com a mínim d’aquesta mida, el marge d’error de l’interval de confiança de Laplace serà com a màxim \\(M_{max}\\) (la seva amplada serà com a màxim \\(2M_{max}\\)), sigui quina sigui la mostra. És de les poques vegades que podem estar segurs de qualque cosa en estadística. El teorema anterior és per l’amplada de l’interval de Laplace, però la \\(n\\) segurament us sortirà molt gran i en aquest cas l’interval de Laplace aproxima molt bé els altres dos intervals. 4.5 Intervals de confiança per a la variància d’una variable normal Suposem que tenim una variable normal \\(X\\sim N(\\mu,\\sigma)\\). Volem trobar un IC 95% per a la seva variància \\(\\sigma^2\\) (o la seva desviació típica \\(\\sigma\\)). Per calcular-lo, prenem una mostra aleatòria simple de mida \\(n\\), de variància mostral \\(\\widetilde{S}^2_X\\). Recordau que, en aquestes condicions, \\[ \\frac{(n-1) \\widetilde{S}_{X}^2}{\\sigma^2} \\] té distribució \\(\\chi^2_{n-1}\\) Podem aprofitar aquest fet per obtenir intervals de confiança per a \\(\\sigma^2\\): Teorema 4.8 Si la variable \\(X\\) és normal, un interval de confiança de nivell de confiança \\(q\\) per a \\(\\sigma^2\\) és \\[ \\left[ \\frac{(n-1)\\widetilde{S}_{X}^2}{\\chi_{n-1,(1+q)/2}^2}, \\frac{(n-1)\\widetilde{S}_{X}^2}{\\chi_{n-1,(1-q)/2}^2} \\right], \\] on \\(\\chi_{n-1,r}^2\\) és el \\(r\\)-quantil de la distribució \\(\\chi_{n-1}^2\\) La justificació d’aquesta fórmula és la usual: com que \\[ \\begin{array}{l} \\displaystyle P(\\chi_{n-1}^2\\leq \\chi_{n-1,(1-q)/2}^2)=\\frac{1-q}{2}\\\\ \\displaystyle P(\\chi_{n-1}^2\\geq \\chi_{n-1,(1+q)/2}^2)=1-\\frac{1+q}{2}=\\frac{1-q}{2}, \\end{array} \\] tenim que \\[ \\begin{array}{l} q=P\\left(\\chi_{n-1,(1-q)/2}^2\\leq \\chi_{n-1}^2\\leq \\chi_{n-1,(1+q)/2}^2\\right)\\\\[2ex] \\quad\\displaystyle =P\\left(\\chi_{n-1,(1-q)/2}^2\\leq \\frac{(n-1) \\widetilde{S}_{X}^2}{\\sigma^2}\\leq \\chi_{n-1,(1+q)/2}^2 \\right)\\\\[2ex] \\quad\\displaystyle = P\\left(\\frac{(n-1) \\widetilde{S}_{X}^2}{\\chi_{n-1,(1+q)/2}^2}\\leq\\sigma^2\\leq\\frac{ (n-1)\\widetilde{S}_{X}^2}{\\chi_{n-1,(1-q)/2}^2} \\right) \\end{array} \\] Fixau-vos que aquest interval de confiança per \\(\\sigma^2\\) no està centrat en \\(\\widetilde{S}_{X}^2\\) ni en \\({S}_{X}^2\\). A més, com que \\(\\chi_{n-1}^2\\) no és simètrica, s’han de calcular els dos quantils \\(\\chi_{n-1,(1-q)/2}^2\\) i \\(\\chi_{n-1,(1+q)/2}^2\\), perquè no hi ha cap relació entre ells que doni el valor d’un d’ells a partir del de l’altre. Exemple 4.12 Un índex de qualitat d’un reactiu químic és la variabilitat en el temps que triga a actuar: es demana que aquest temps sigui aproximadament constant, és a dir, que tengui una desviació típica petita. Hem realitzat 30 proves en les quals hem mesurat el temps d’actuació d’un determinat reactiu, i a partir dels resultats volem calcular un IC 95% per a la desviació típica del seu temps d’actuació. Tenim els resultats guardats en el vector següent: Temps=c(12,13,13,14,14,14,15,15,16,17,17,18,18,19,19, 25,25,26,27,30,33,34,35,40,40,51,51,58,59,83) Per ara suposarem que la distribució del temps d’actuació d’aquest reactiu és (aproximadament) normal. Més endavant estudiarem tècniques per determinar (amb un cert nivell de confiança) si podem acceptar que una mostra prové d’una variable normal. Continuem. Com que la variable que ens dóna el temps és (aproximadament) normal, podem emprar la fórmula per a l’IC 95% per a \\(\\sigma^2\\) anterior: \\[ \\left[ \\frac{(n-1)\\widetilde{S}_{X}^2}{\\chi_{n-1,(1+q)/2}^2}, \\frac{(n-1)\\widetilde{S}_{X}^2}{\\chi_{n-1,(1-q)/2}^2} \\right] \\] on: \\(n=\\)length(Temps)\\(=30\\) \\(\\widetilde{S}_X^2=\\)var(Temps)\\(=301.55\\) \\(q=0.95\\), per tant \\(\\chi_{n-1,(1+q)/2}^2=\\)qchisq(0.975,29)\\(=45.72\\) i \\(\\chi_{n-1,(1-q)/2}^2=\\)qchisq(0.025,29)\\(=16.05\\) Obtenim l’interval: \\[ \\left[ \\frac{29\\cdot 301.55}{45.72}, \\frac{29\\cdot 301.55}{16.05}\\right]= [191.26, 544.96] \\] Aquest interval és per a la variància! Per obtenir un interval de confiança per a la desviació típica, prenem arrels quadrades dels extrems: \\[ [\\sqrt{191.26}, \\sqrt{544.96}]=[13.83,23.34] \\] Per tant la variabilitat dels temps d’actuació d’aquest reactiu és molt gran. Comparau aquest interval amb l’IC 95% per al seu temps mitjà d’actuació: round(t.test(Temps)$conf.int,2) ## [1] 21.88 34.85 ## attr(,&quot;conf.level&quot;) ## [1] 0.95 L’extrem superior de l’IC 95% per a la desviació típica és més gran que l’extrem inferior d’aquest IC 95% per a la mitjana. Amb R, aquest interval de confiança amb nivell de confiança \\(q\\) per a la variància es pot calcular amb la funció varTest(X,conf.level=...)$conf.int del paquete EnvStats, on X és el vector que conté la mostra i conf.level indica el nivell de confiança en tant per u, que per defecte és igual a 0.95. Així, l’interval de confiança que ens demanàvem a l’exemple anterior es calcularia amb library(EnvStats) varTest(Temps)$conf.int ## LCL UCL ## 191.263 544.957 ## attr(,&quot;conf.level&quot;) ## [1] 0.95 Que no, que aquest és el de la variància! L’IC 95% per a la desviació típica és: sqrt(varTest(Temps)$conf.int) ## LCL UCL ## 13.8298 23.3443 ## attr(,&quot;conf.level&quot;) ## [1] 0.95 L’interval per a la variància basat en la distribució \\(\\chi^2\\) només és vàlid si la variable poblacional és (aproximadament) normal. En cas que no poguem acceptar que ho és, el millor és emprar un mètode no paramètric, com per exemple el bootstrap. Exemple 4.13 Anem a calcular un IC 95% per a la desviació típica del temps de reacció de l’Exemple anterior amb el mètode del bootstrap. Prenem 5000 mostres aleatòries simples de mida 30 del vector Temps i calculam la desviació típica mostral de cada mostra: Simulacions.sd=replicate(5000,sd(sample(Temps,30,rep=TRUE))) Ara prenem com a IC 95% l’interval que va del quantil 0.025 al quantil 0.975 d’aquest vector de desviacions típiques: quantile(Simulacions.sd,c(0.025,0.975)) ## 2.5% 97.5% ## 11.0093 22.6961 No ha sortit molt diferent de l’obtingut amb la fórmula basada en la distribució \\(\\chi^2\\). 4.6 “Poblacions finites” Fins ara hem emprat mostres aleatòries simples. Què passa si prenem mostres aleatòries sense reposició? Si la mida \\(N\\) de la població és molt més gran que la mida \\(n\\) de la mostra (posem \\(N\\geq 1000n\\)), les fórmules donades fins ara funcionen (aproximadament) bé. Quan la mida \\(N\\) de la població no és molt més gran que la mida \\(n\\) de la mostra, el que es fa és, a les fórmules que hem donat per als intervals de confiança per a \\(\\mu\\) o \\(p_X\\), multiplicar-hi l’error estàndard pel factor de població finita \\[ \\sqrt{\\frac{N-n}{N-1}} \\] Així: Si \\(X\\) és una població de mida \\(N\\) amb mitjana poblacional \\(\\mu\\) i prenem una mostra aleatòria sense reposició de \\(X\\), amb mitjana \\(\\overline{X}\\) i desviació típica mostral \\(\\widetilde{S}_X\\), i si \\(X\\) normal o si \\(n\\) és gran, es recomana prendre com a interval de confiança de nivell de confiança \\(q\\) per a \\(\\mu\\) \\[ \\overline{X}\\pm t_{n,(q+1)/2}\\frac{\\widetilde{S}_X}{\\sqrt{n}}\\sqrt{\\frac{\\vphantom{(}N-n}{N-1}} \\] Si \\(X\\) una població de mida \\(N\\) que segueix una distribució Bernoulli amb probabilitat d’èxit \\(p_X\\) i prenem una mostra aleatòria sense reposició de \\(X\\), amb \\(n\\) molt gran i nombres d’èxits i fracassos com a mínim 10, es recomana prendre com a interval de confiança de nivell de confiança \\(q\\) per a \\(p_X\\) \\[ \\widehat{p}_{X}\\pm z_{(q+1)/2}\\sqrt{\\frac{\\widehat{p}_{X} (1-\\widehat{p}_{X})}{n}}\\sqrt{\\frac{\\vphantom{(}N-n}{N-1}} \\] En les condicions del punt anterior, per obtenir un interval de confiança de nivell de confiança \\(q\\) per a \\(p_X\\) amb un marge d’error \\(M_{max}\\) en el cas més desfavorable (\\(\\widehat{p}_X=0.5\\)) caldrà prendre una mostra de mida \\[ n\\geq \\frac{Nz_{(q+1)/2}^2}{4M_{max}^2(N-1)+z_{(q+1)/2}^2} \\] Exemple 4.14 En una mostra aleatòria de 727 estudiants (diferents) de la UIB (\\(N=12000\\)), 557 afirmàrem haver comès plagi en algun treball durant els seus estudis. Quin seria un interval de confiança del 95% per a la proporció \\(p_X\\) d’estudiants de la UIB que han comès plagi en algun treball? Una mostra de 727 estudiants diferents és molt gran respecte del total d’estudiants de la UIB, per la qual cosa convé emprar la fórmula de Laplace amb el factor de població finita \\[ \\widehat{p}_{X}\\pm z_{(q+1)/2}\\sqrt{\\frac{\\widehat{p}_{X} (1-\\widehat{p}_{X})}{n}}\\sqrt{\\frac{\\vphantom{(}N-n}{N-1}} \\] on \\(\\widehat{p}_{X}=557/727=0.766\\), \\(z_{(q+1)/2}=1.96\\), \\(n=727\\) i \\(N=12000\\): dóna \\[ 0.766\\pm \\sqrt{\\frac{0.766(1-0.766)}{727}}\\sqrt{\\frac{\\vphantom{(}12000-727}{12000-1}}\\Rightarrow [0.751,0.781] \\] Estimam amb un nivell de confiança del 95% que entre un 75.1 i un 78.1 dels estudiants de la UIB han comès plagi en algun treball. Exemple 4.15 De quina mida hem de prendre una mostra aleatòria sense reposició d’estudiants de la UIB per estimar una proporció amb nivell de confiança del 95% i un marge d’error màxim de 0.05? Per la fórmula anterior (prenent \\(N=12000\\) i \\(z_{(1+q)/2}=1.96\\)), per garantir un marge d’error màxim de 0.05 cal prendre una mostra de mida \\[ n\\geq \\frac{12000\\cdot 1.96^2}{4\\cdot 0.05^2(12000-1)+1.96^2}=372.3 \\] Per tant, ens calen 373 estudiants. "]
]
